(this.webpackJsonpmetro=this.webpackJsonpmetro||[]).push([[0],{105:function(e,t,a){e.exports=a(178)},110:function(e,t,a){},111:function(e,t,a){},178:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(16),i=a.n(s),o=(a(110),a(8)),l=a(11),c=a(9),u=a(7),p=a(10),m=(a(111),a(35)),h=a(21),d=a.n(h),f=a(191),v=a(192),b=a(193),y=a(189),k=a(179),g=a(180),S=a(187),E=a(188),w=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(k.a,{className:"pane "+this.props.className},r.a.createElement(g.a,{className:"pane-title"},this.props.title),r.a.createElement(g.a,{className:"pane-body"},this.props.children))}}]),t}(n.Component),C=w;w.defaultProps={title:"title",children:[],className:""};var I=a(57),O=["C3","C#3","D3","D#3","E3","F3","F#3"],T={};Object.keys(O).map((function(e,t){return T["accent_"+t]=t,!0}));var M={0:"#ff6355",1:"#ff7155",2:"#ff8055",3:"#ff8e55",4:"#ff9955",5:"#ff9c55",6:"#ffaa55"},B=function(e){function t(e,a){var n;if(Object(o.a)(this,t),e.samples.length>O.length)throw new Error("Limited to "+O.length+" samples per instrument");var r={};return e.samples.map((function(e,t){return r[O[t]]=e.file,!0})),(n=Object(c.a)(this,Object(u.a)(t).call(this,r,{baseUrl:e.baseUrl||"./audio/"+e.key+"/",onload:function(){return a(Object(I.a)(n))}}))).key=e.key,n.label=e.label,n.samples=e.samples,n}return Object(p.a)(t,e),t}(h.Sampler),x=B;B.defaultProps={onReady:function(){}};var P="by_bar",j="by_time",R="set_time",N="constant",D="stop",A="repeat",z="continue",_={TABLA:{key:"tabla",label:"Tabla",samples:[{file:"dha-slide.wav",label:"Dha",idx:0},{file:"dhin-slide.wav",label:"Dhin",idx:1},{file:"tin.wav",label:"Tin",idx:2}]},ELECTRO_KIT:{key:"electrokit",label:"Electronic Kit",samples:[{file:"Kick.wav",label:"Kick",idx:0},{file:"HiHat.wav",label:"Hi Hat",idx:1},{file:"Snare.wav",label:"Snare",idx:2}]},METRONOME:{key:"metronome",label:"Metronome",samples:[{file:"tap.wav",label:"Tap",idx:0},{file:"down.wav",label:"Down",idx:1},{file:"up.wav",label:"Up",idx:2}]},BASIC_DRUM_KIT:{key:"basicdrumkit",label:"Basic Drum Kit",samples:[{file:"Kick.wav",label:"Kick",idx:0},{file:"Snare.wav",label:"Snare",idx:1},{file:"ClosedHat.wav",label:"Closed Hat",idx:2},{file:"OpenHat.wav",label:"Open Hat",idx:3}]},YAMAHA_RX5:{key:"yamaha_rx5",label:"Yamaha RX 5",samples:[{file:"Kick.wav",label:"Kick",idx:0},{file:"Rim.wav",label:"Rim",idx:1},{file:"Ride.wav",label:"Ride",idx:2},{file:"Cowbell.wav",label:"Cowbell",idx:3},{file:"Shaker.wav",label:"Shaker",idx:4}]}},K={};Object.keys(_).map((function(e,t){return K[_[e].key]=_[e],!0}));var F,L=Object.keys(_).map((function(e){return _[e]})),U=[{title:"Metronome 4/4",instrumentKey:_.METRONOME.key,beatsPerStep:4,playMode:j,byTimeInterval:60,bpmStep:20,bpmRange:[100,200],track:[[0,1],[0],[0],[0]]},{title:"Levee Break",instrumentKey:"electrokit",bpmRange:[300,400],track:[[0,1],[0],[1],[],[1,2],[],[1],[0],[1],[],[0,1],[0],[1,2],[],[1],[]],playMode:P,playbackMode:D,byTimeInterval:5,byBarInterval:2,stepsNum:10,bpmStep:50,isHidden:!0},{bpmStep:50,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:2,constantBpmSlider:300,track:[[0,1],[],[0,1],[],[2,1],[],[0,1],[],[1,0],[],[1,0],[],[1,2],[],[1,0],[]],instrumentKey:"electrokit",title:"Basic Rock"},{bpmStep:50,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:2,constantBpmSlider:300,track:[[0,1],[],[1],[],[2,1],[],[1],[0,1],[1,0],[],[0,1],[],[1,2],[],[1,0],[]],instrumentKey:"electrokit",title:"Impeach the President"},{bpmStep:50,bpmRange:[350,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:60,byBarInterval:10,constantBpmSlider:300,track:[[0,2],[2],[0,2],[2],[2,1],[2],[0,2],[3,1],[2],[2,1],[0,2],[2,1],[2,1],[0,3],[2],[2,1]],instrumentKey:"basicdrumkit",title:"Funky Drummer"},{bpmStep:50,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:2,constantBpmSlider:300,track:[[0,1],[],[1],[],[1,2],[],[1],[0],[1,0],[],[0,1],[],[1,2],[],[1],[]],instrumentKey:"electrokit",title:"Walk This Way"},{bpmStep:50,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:2,constantBpmSlider:300,track:[[0,1],[],[1,0],[],[1,2],[],[1],[],[1],[],[0,1],[0],[1,2],[],[1],[0]],instrumentKey:"electrokit",title:"It's a New Day"},{bpmStep:50,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:2,constantBpmSlider:300,track:[[0],[],[],[0],[1,2],[],[0],[],[0],[],[],[],[1,2],[],[],[]],instrumentKey:"electrokit",title:"The Big Beat"},{bpmStep:20,bpmRange:[300,500],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:50,constantBpmSlider:300,interval:120,track:[[0,2],[],[0,2],[],[1,2],[],[0,2],[],[0,2],[],[0,2],[],[1,2],[],[0,2],[]],instrumentKey:"basicdrumkit",title:"Rock"},{bpmStep:20,bpmRange:[528,600],currentBpm:300,playbackMode:"stop",playMode:"constant",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:50,constantBpmSlider:600,interval:120,track:[[0],[],[3],[],[1,0],[],[3],[],[0],[2],[3],[],[1,0],[],[0,3],[]],instrumentKey:"basicdrumkit",title:"Techno"},{bpmStep:20,bpmRange:[528,600],currentBpm:300,playbackMode:"stop",playMode:"constant",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:50,constantBpmSlider:400,interval:120,track:[[0,2],[],[2],[],[1,2],[],[2],[0],[2],[],[0,2],[],[1,2],[0],[2],[0]],instrumentKey:"basicdrumkit",title:"Hip Hop"},{bpmStep:50,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,interval:120,track:[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[1,2],[0,2],[0,2],[2],[1,2],[0,2],[1,2,0],[2],[2],[0,2]],instrumentKey:"yamaha_rx5",title:"Son Clave"},{bpmStep:50,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[2],[0,2,1],[0,2],[2],[2,1],[0,2],[2,0,1],[2],[2],[0,2]],instrumentKey:"yamaha_rx5",title:"Rumba"},{bpmStep:50,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[2,1],[0,2],[0,2],[2],[2,1],[0,2],[2,0],[2,1],[2],[0,2]],instrumentKey:"yamaha_rx5",title:"Bossa Nova"},{bpmStep:50,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,1,3],[],[],[1,3],[0],[],[1,3],[],[0,1],[3],[3],[1],[0],[],[0,1],[]],instrumentKey:"yamaha_rx5",title:"Soukous"},{bpmStep:50,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,3],[],[1],[1,3],[0],[],[1,3],[1],[0],[],[3,1],[1],[0],[],[0,1,3],[1]],instrumentKey:"yamaha_rx5",title:"Gahu"},{bpmStep:50,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,3],[],[1],[1],[0,3],[],[1,3,0],[1],[0],[],[3,1],[1],[0,3],[],[0,1],[1]],instrumentKey:"yamaha_rx5",title:"Shiko"},{title:"Balkan 1",bpmRange:[241,400],beatsPerStep:7,accents:[0,1,2,0,1,2,1],instrument:_.ELECTRO_KIT,playMode:"by_bar",interval:20,bpmStep:30},{title:"Balkan 2",bpmRange:[293,400],beatsPerStep:7,accents:[0,1,2,0,1,2,1],instrument:_.TABLA,playMode:"by_bar",interval:300,bpmStep:50},{title:"Groove 1",bpmRange:[222,262],beatsPerStep:8,accents:[0,2,1,2,1,0,1,1],instrument:_.ELECTRO_KIT,playMode:"by_time",interval:600,bpmStep:50},{title:"Groove 2",bpmRange:[222,400],beatsPerStep:8,accents:[0,2,0,2,2,2,0,1],instrument:_.ELECTRO_KIT,playMode:"by_bar",interval:20,bpmStep:50}],V={title:"Initialization setting",instrumentKey:_.BASIC_DRUM_KIT.key,bpmRange:[300,400],track:[[0,1],[0],[1],[],[1,2],[],[1],[0],[1],[],[0,1],[0],[1,2],[],[1],[]],playMode:R,playbackMode:D,byTimeInterval:5,byBarInterval:2,stepsNum:10,exerciseTime:600,bpmStep:20,isHidden:!0},H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.lib={},a.currentInstrumentKey=void 0,a.fft=void 0,a.setInstrument(V.instrumentKey),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"loadInstrument",value:function(e){var t=this;if(void 0===K[e])throw new Error("Invalid instrumentKey: "+e);new x(K[e],(function(e){return t.onInstrumentReady(e)}))}},{key:"onInstrumentReady",value:function(e){this.lib[e.key]=e,this.currentInstrumentKey=e.key,e.toMaster(),this.props.onInstrumentReady(e)}},{key:"hasInstrument",value:function(e){return void 0!==this.lib[e]}},{key:"setInstrument",value:function(e){if(void 0!==this.lib[e])return this.currentInstrumentKey=e,this.getInstrument();this.loadInstrument(e)}},{key:"getInstrument",value:function(e){if(void 0===this.lib[e])throw new Error("Instrument not loaded "+e);return this.lib[e]}}]),t}(n.Component),W=a(98),Z={"arrow up/down":"strza\u0142ki g\xf3ra/d\xf3\u0142","higher/lower BPM":"zwi\u0119ksz/zmniejsz BPM","arrow left/right":"strza\u0142ki lewa/prawa","previous/next step according to plan":"poprzedni/nast\u0119pny krok wg planu","start/stop":"zacznij/zatrzymaj",stop:"zatrzymaj",Control:"Kontrola","Start / Stop":"Zacznij / Zatrzymaj",Instrument:"Instrument",Mode:"Tryb","Increase speed":"Zwi\u0119kszaj pr\u0119dko\u015b\u0107","BPM range":"Zakres BPM","By bar":"Co kilka takt\xf3w",bar:"takt","By time":"Co jaki\u015b czas","Set time":"W ustalonym czasie \u0107wicze\u0144",Stable:"Nie zwi\u0119kszaj","Increase speed every":"Zwi\u0119ksz pr\u0119dko\u015b\u0107 co","Number of steps":"Ilo\u015b\u0107 krok\xf3w","Up and Down":"Szybciej i wolniej",Shuffle:"Losowo","Exercise Time":"Czas \u0107wiczenia","Total time:":"Ca\u0142kowity czas:",Stop:"Zatrzymaj",Continue:"Kontynuuj",Repeat:"Od pocz\u0105tku","After plan":"Po zako\u0144czeniu","Step order":"Kolejno\u015b\u0107","Plan progress":"Post\u0119p planu","Step progress":"Post\u0119p kroku",Title:"Nazwa","Save current settings":"Zapisz bie\u017c\u0105ce ustawienia",Edit:"Edytuj","User presets":"Zapisane ustawienia",Presets:"Presety",Delete:"Usu\u0144","Save Preset":"Zapisz Ustawienia",Cancel:"Anuluj","Are you sure?":"Czy aby na pewno?","Are you sure to delete current preset?":"Czy jeste\u015b pewien, \u017ce chcesz usun\u0105\u0107 to ustawienie?",Save:"Zapisz",Sequencer:"Sekwencer","Keyboard controls":"Skr\xf3ty klawiszowe",bars:{1:"takt",2:"takty",3:"takty",4:"takty",5:"takt\xf3w"},hours:{1:"godzina",2:"godziny",3:"godziny",4:"godziny",5:"godzin"},minutes:{1:"minuta",2:"minuty",3:"minuty",4:"minuty",5:"minut"},seconds:{1:"sekunda",2:"sekundy",3:"sekundy",4:"sekundy",5:"sekund"},hr:"godz.",hrs:"godz."};function J(){return navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en"}switch(J()){case"pl":case"pl-PL":case"pl-pl":F=Z;break;default:F={}}var X=function(e){return F[e]?F[e]:e};function q(e,t){if(F[t]){if(F[t][e])return F[t][e];var a=F[t];return a[Object.keys(a)[Object.keys(a).length-1]]}return t}var G=a(181),Q=a(182),Y=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(k.a,{className:"SimpleProgress"},r.a.createElement("div",{className:"bar",style:{width:this.props.value+"%",display:"block"}}))}}]),t}(n.Component),$={toLocaleDateTime:function(e){return e?new Date(e).toLocaleString(J(),{dateStyle:"long",timeStyle:"short"}):""},padTime:function(e){return e<10?"0"+e:e},formatTime:function(e){if(e)return $.formatTimeFull(e,"h","m","s",!0)},formatTimeLong:function(e){if(e)return $.formatTimeFull(e,"hours","minutes","seconds",!1)},formatTimeFull:function(e,t,a,n,r){var s=new Date(0,0,0,0,0,0,0);s.setSeconds(e);var i=s.getHours(),o=s.getMinutes(),l=s.getSeconds(),c="";return 0!==i&&(c+=i+" "+q(i,t)+" "),0!==o||0!==i?(0!==i&&0!==o?c+=(r?$.padTime(o):o)+" "+q(o,a)+" ":0!==o&&(c+=(r?$.padTime(o):o)+" "+q(o,a)+" "),0!==l&&(c+=(r?$.padTime(l):l)+" "+q(l,n))):c+=s.getSeconds()+" "+q(l,n),c.trim()},storageAvailable:function(e){var t;try{t=window[e];var a="__storage_test__";return t.setItem(a,a),t.removeItem(a),!0}catch(n){return n instanceof DOMException&&(22===n.code||1014===n.code||"QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)&&t&&0!==t.length}}},ee=$,te=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={playbackMode:a.props.playbackMode,playMode:a.props.playMode,steps:[],currentStepIdx:a.props.currentStepIdx,stepProgress:0,planProgress:0,isUpDown:!1,isPaused:!1},a.barRender=function(e){var t=a.state.currentStepIdx===e.stepIdx?"current-step":"";return r.a.createElement("div",{onClick:function(){return a.startStep(e.stepIdx)},className:"step clickable "+t,key:"key_"+e.stepIdx},e.duration!==1/0?r.a.createElement(r.a.Fragment,null,e.durationFormatted," (",e.durationBars," ",q(Math.floor(e.durationBars),"bars"),") "):"","@ ",e.bpm.toFixed(0)," bpm")},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"makePlan",value:function(e){var t=[],a=e.bpmRange[1],n=e.bpmRange[0];if(e.playMode===P)for(;n<=a;){var r={bpm:n,duration:e.byBarInterval};t.push(r),n+=e.bpmStep}else if(e.playMode===j)for(;n<=a;){var s={duration:e.byTimeInterval,bpm:n};t.push(s),n+=e.bpmStep}else if(e.playMode===N){var i={duration:1/0,bpm:e.constantBpmSlider};t.push(i)}else if(e.playMode===R)for(var o=e.exerciseTime/e.stepsNum,l=e.bpmRange[0],c=(e.bpmRange[1]-e.bpmRange[0])/(e.stepsNum-1);l<=a;){var u={duration:o,bpm:l};t.push(u),l+=c}if(this.state.isUpDown){var p=t.slice().reverse();p.shift(),t=t.concat(p)}return this.state.isRandom&&(t=this.shuffle(t.slice())),t}},{key:"shuffle",value:function(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[a],e[a]=t;return e}},{key:"onPlanStep",value:function(e){this.setState({currentStepIdx:e},this.stepChanged)}},{key:"updateProgress",value:function(){var e=this.getStep(this.state.currentStepIdx),t=(this.props.transport.ticks-e.startTimeTicks)/d.a.Time(e.duration).toTicks(),a=this.props.transport.ticks/this.endTime;this.setState({stepProgress:this.clamp(t),planProgress:this.clamp(a)})}},{key:"clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),a)}},{key:"setPlan",value:function(e){var t=this,a=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.makePlan(e));this.baseBpm=this.props.transport.bpm.value;var n=e.track.length,r=0;this.events=[];for(var s=[],i=0,o=function(o){var l=a[o],c=60/l.bpm;t.props.transport.schedule((function(e){return t.onPlanStep(o)}),r);var u=e.playMode===P?c*n*l.duration:l.duration,p=e.playMode===P?l.duration:l.duration/(c*n),m={bpm:l.bpm,duration:u,durationBars:p.toFixed(1),durationFormatted:ee.formatTime(u),stepIdx:o,track:e.track,playMode:l.playMode,startTimeTicks:d.a.Time(r).toTicks()};switch(e.playMode){case j:case R:r+=t.calcTimeForBpm(l.duration,l.bpm);break;case P:r=l.duration*(o+1)+"m";break;case N:r=1/0;break;default:throw new Error("Invalid playMode: "+e.playMode)}i+=u,s.push(m)},l=0;l<a.length;l++)o(l);this.props.transport.schedule((function(e){return t.onPlanEnd(e)}),r),this.endTime=d.a.Time(r).toTicks(),this.setState((function(t){return{totalPlanTime:i,currentStepIdx:0,steps:s,playMode:e.playMode}}),this.stepChanged)}},{key:"calcTimeForBpm",value:function(e,t){return d.a.Time(e*t/this.baseBpm)}},{key:"startStep",value:function(e){if(this.state.currentStepIdx!==e){var t=this.getStep(e);this.props.transport.ticks=t.startTimeTicks,this.setState({currentStepIdx:e},this.stepChanged)}}},{key:"getStep",value:function(e){return this.state.steps[e]}},{key:"stepForward",value:function(){this.state.currentStepIdx+1<this.state.steps.length&&this.startStep(this.state.currentStepIdx+1)}},{key:"stepBackward",value:function(){this.state.currentStepIdx-1>=0&&this.startStep(this.state.currentStepIdx-1)}},{key:"onPlanEnd",value:function(e){this.state.playbackMode===D?this.props.onPlanEnd():this.state.playbackMode===A&&this.startStep(0)}},{key:"stepChanged",value:function(){var e=this.getCurrentStep().bpm;this.props.onPlanStep(e)}},{key:"getCurrentStep",value:function(){if(this.state.currentStepIdx>=this.state.steps.length)throw new Error("Trying to get step that doesn't exists");return this.state.steps[this.state.currentStepIdx]}},{key:"onPlaybackChange",value:function(e){this.setState({playbackMode:e},this.props.onChange)}},{key:"onUpDownBtn",value:function(){this.setState({isUpDown:!this.state.isUpDown,isRandom:!1},this.props.onChange)}},{key:"onRandomBtn",value:function(){this.setState({isRandom:!this.state.isRandom,isUpDown:!1},this.props.onChange)}},{key:"render",value:function(){var e=this;return this.state.playMode===N?r.a.createElement("div",null):r.a.createElement(C,{title:"Plan"},r.a.createElement("div",{className:"Planner"},r.a.createElement("div",null,X("Step progress")," ",r.a.createElement(Y,{value:100*this.state.stepProgress})),r.a.createElement("div",null,X("Plan progress")," ",r.a.createElement(Y,{value:100*this.state.planProgress})),r.a.createElement("div",{style:{height:"200px",overflow:"auto"}},this.state.steps.map((function(t){return e.barRender(t)}))),r.a.createElement("div",null,X("Total time:")," ",ee.formatTime(this.state.totalPlanTime))),r.a.createElement(G.a,{isOpen:this.state.playMode!==N},r.a.createElement("div",null,X("After plan")),r.a.createElement(Q.a,{size:"sm"},r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onPlaybackChange(D)},active:this.state.playbackMode===D},X("Stop")),r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onPlaybackChange(z)},active:this.state.playbackMode===z},X("Continue")),r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onPlaybackChange(A)},active:this.state.playbackMode===A},X("Repeat"))),r.a.createElement("div",null,X("Step order")),r.a.createElement(Q.a,null,r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(t){return e.onUpDownBtn(t)},active:this.state.isUpDown},X("Up and Down")),r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onRandomBtn()},active:this.state.isRandom},X("Shuffle")))))}}]),t}(n.Component),ae=te;te.defaultProps={playbackMode:V.playbackMode,playMode:V.playMode,onChange:function(){},onPlanStep:function(){},onPlanEnd:function(){},currentStepIdx:NaN};var ne=a(190),re=a(183),se=a(184),ie=a(185),oe=a(186),le=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={modal:!1,nestedModal:!1,preset:null,presetId:null,showDelete:!1},a.toggle=function(){a.setState((function(e){return{modal:!e.modal,nestedModal:!1}}))},a.toggleNested=function(){a.setState({nestedModal:!a.state.nestedModal})},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"handleSave",value:function(){var e=this.state.preset,t=this.state.preset.title;t&&t.length>0&&(this.props.onSave(t,e),this.toggle())}},{key:"edit",value:function(e,t,a){t&&a&&(e.presetId=t,e.title=a),this.setState({preset:e,showDelete:!!t},this.toggle)}},{key:"titleChanged",value:function(e){var t=e.target.value,a=Object(m.a)({},this.state.preset);a.title=t,this.setState({preset:a})}},{key:"handleDelete",value:function(){this.props.onDeleteBtn(this.state.preset),this.toggle()}},{key:"renderDelete",value:function(){if(!0===this.state.showDelete)return r.a.createElement(W.a,{color:"warning",onClick:this.toggleNested},X("Delete"))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{style:{marginTop:"0.5em"},outline:!0,size:"sm",color:"light",onClick:this.props.onSaveBtn},X("Save current settings")),r.a.createElement(ne.a,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},r.a.createElement(re.a,{toggle:this.toggle},X("Save Preset")),r.a.createElement(se.a,null,r.a.createElement(ie.a,{onChange:function(t){return e.titleChanged(t)},placeholder:X("Title"),defaultValue:this.state.preset&&this.state.preset.title||""}),r.a.createElement("div",{className:"code"},JSON.stringify(this.state.preset)),r.a.createElement(ne.a,{isOpen:this.state.nestedModal,toggle:this.toggleNested},r.a.createElement(re.a,{toggle:this.toggleNested},X("Are you sure?")),r.a.createElement(se.a,null,X("Are you sure to delete current preset?")),r.a.createElement(oe.a,null,r.a.createElement(W.a,{color:"warning",onClick:function(){return e.handleDelete()}},X("Delete")),r.a.createElement(W.a,{onClick:this.toggleNested},X("Cancel"))))),r.a.createElement(oe.a,null,r.a.createElement(W.a,{color:"primary",onClick:function(){return e.handleSave()}},X("Save"))," ",r.a.createElement(W.a,{color:"secondary",onClick:this.toggle},X("Cancel")),this.renderDelete())))}}]),t}(n.Component),ce=le;le.defaultProps={onDeleteBtn:function(e){},onSave:function(e,t){},onSaveBtn:function(e,t){}};var ue=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showDelete:[],showEdit:[],userPresets:[]};var n=localStorage.getItem("userPresets");return a.state.userPresets=n?JSON.parse(n):[],a.state.showDelete=a.state.userPresets?Array(a.state.userPresets.length).fill(!1):[],a.state.showEdit=a.state.userPresets?Array(a.state.userPresets.length).fill(!1):[],a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"validatePreset",value:function(e){if(e.byBarInterval=e.byBarInterval||e.interval||V.byBarInterval,e.byTimeInterval=e.byTimeInterval||e.interval||V.byTimeInterval,e.instrumentKey=e.instrumentKey||e.instrument.key,!e.track){var t=[];e.accents.map((function(e){return t.push([e]),!0})),e.track=t}return e}},{key:"onPresetClick",value:function(e){this.props.onSelect(this.validatePreset(e))}},{key:"onSavePreset",value:function(e,t){var a=Object(m.a)({title:e},t);if(void 0===a.presetId){var n=1;this.state.userPresets.length>0&&(n=Math.max.apply(Math,this.state.userPresets.map((function(e){return e.presetId}))),n++),a.presetId=n}a.savedDtm=new Date;var r=this.state.userPresets,s=this.state.userPresets.findIndex((function(e){return e.presetId===a.presetId}));s<0?r.push(a):r[s]=a,this.saveInLocalStorage(r)}},{key:"saveInLocalStorage",value:function(e){localStorage.setItem("userPresets",JSON.stringify(e)),this.setState({userPresets:e})}},{key:"showDeleteBtn",value:function(e,t){var a=Object(m.a)({},this.state);a[t]=!0,this.setState({showDelete:a})}},{key:"showEditBtn",value:function(e,t,a){var n=Object(m.a)({},this.state);n[t]=!0,this.setState({showEdit:n})}},{key:"hideEditBtn",value:function(e){this.setState({showEdit:!1})}},{key:"onPresetDelete",value:function(e){var t=this.state.userPresets.findIndex((function(t){return t.presetId===e.presetId})),a=this.state.userPresets.slice();if(t<0)throw new Error("Selected preset "+e.title+" has not been found in the store");a.splice(t,1),this.saveInLocalStorage(a)}},{key:"onPresetEdit",value:function(e,t){var a=this.props.getPreset();void 0!==t?this.refs.presetEditor.edit(a,this.state.userPresets[t].presetId,this.state.userPresets[t].title):this.refs.presetEditor.edit(a)}},{key:"renderUserPresets",value:function(e){var t=this;if(0!==e.length)return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,null,X("User presets"),":"),e.map((function(e,a){return r.a.createElement(g.a,{className:"presetItem clickable",onClick:function(){return t.onPresetClick(e)},key:"preset_"+a},r.a.createElement(S.a,{style:{textAlign:"left"}},e.title),r.a.createElement(S.a,{xs:"auto",className:"userPresetSavedDtm"},ee.toLocaleDateTime(e.savedDtm)),r.a.createElement(S.a,null,r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(e){return t.onPresetEdit(e,a)}},X("Edit"))))})))}},{key:"render",value:function(){var e=this,t=localStorage.getItem("userPresets"),a=t?JSON.parse(t):[];return r.a.createElement(C,{className:"PresetsManager",title:X("Presets")},r.a.createElement(k.a,null,U.map((function(t,a){return r.a.createElement(g.a,{onClick:function(){return e.onPresetClick(t)},className:"presetItem clickable",key:"preset_"+a},t.title)})),this.renderUserPresets(a),r.a.createElement(g.a,{style:{justifyContent:"center"}},r.a.createElement(ce,{ref:"presetEditor",onDeleteBtn:function(t){return e.onPresetDelete(t)},onSaveBtn:function(t,a){return e.onPresetEdit(t,a)},onSave:function(t,a){return e.onSavePreset(t,a)}}))))}}]),t}(n.Component),pe=ue;ue.defaultProps={onSelect:function(e){}};var me=a(61),he=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={track:a.props.track},a.colorEmpty="#333",a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setProgress",value:function(e){this.line.style.transform="rotate("+360*e+"deg)"}},{key:"setAccents",value:function(e){this.setState({track:e})}},{key:"getCoordinatesForPercent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=t*Math.cos(2*Math.PI*e),n=t*Math.sin(2*Math.PI*e);return[a,n]}},{key:"drawSvg",value:function(e,t){var a=this,n=1/this.props.track.length,s=[];this.props.track.forEach((function(e){var r=e.indexOf(t);s.push({percent:n,color:r>=0?M[t]:a.colorEmpty})}));var i=0,o=[];return s.forEach((function(t,n){var s=a.getCoordinatesForPercent(i,e),l=Object(me.a)(s,2),c=l[0],u=l[1];i+=t.percent;var p=a.getCoordinatesForPercent(i,e),m=Object(me.a)(p,2),h=m[0],d=m[1],f=t.percent>.5?1:0,v=["M ".concat(c," ").concat(u),"A ".concat(e," ").concat(e," 0 ").concat(f," 1 ").concat(h," ").concat(d),"L 0 0"].join(" ");o.push(r.a.createElement("path",{key:"pie_"+n,stroke:"#444",strokeWidth:"0.5%",d:v,fill:t.color}))})),o}},{key:"drawText",value:function(){var e=this,t=[],a=1/this.props.track.length,n=0;return this.props.track.forEach((function(s,i){var o=e.getCoordinatesForPercent(n,.9),l=Object(me.a)(o,2),c=l[0],u=l[1];c-=.06,t.push(r.a.createElement("text",{x:c,y:u,key:"label_"+i,textAnchor:"middle",transform:"rotate(90, "+c+", "+u+")",className:"svgText"},i+1)),n+=a})),r.a.createElement("g",null,t)}},{key:"render",value:function(){var e=this;if(!this.props.instrument)return r.a.createElement("div",null,"Instrument not loaded");for(var t=.5/this.props.instrument.samples.length,a=[],n=0;n<this.props.instrument.samples.length;n++)a.push(this.drawSvg(.8-t*n,n));return r.a.createElement("div",{ref:function(t){return e.container=t},className:"visClockContainer"},r.a.createElement("svg",{viewBox:"-1 -1 2 2",ref:function(t){return e.svg=t}},r.a.createElement("g",{style:{transform:"rotate(-90deg)"}},a,this.drawText(),r.a.createElement("line",{ref:function(t){return e.line=t},strokeLinecap:"round",x1:"0",y1:"0",x2:".7",y2:"0",stroke:"rgba(255,255,255,0.5)",strokeWidth:"0.1"}))))}}]),t}(n.Component),de=he;he.defaultProps={track:V.track};var fe=a(34),ve=a(102),be=a.n(ve),ye=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={value:a.props.defaultValue,regression:void 0};var n=[[0,a.props.min],[100,a.props.max]];return a.state.regression=be.a.exponential(n,{precision:10}),a.prepareMarks(),a.state.value=a.props.defaultValue,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"prepareMarks",value:function(){this.marks={};for(var e=0;e<this.props.marksAt.length;e++)this.marks[this.findX(this.props.marksAt[e])]=this.props.marksAt[e]}},{key:"onChange",value:function(e){var t=Math.floor(this.state.regression.predict(e)[1]);this.setState({value:t}),this.props.onChange(t)}},{key:"findX",value:function(e){return Math.log(e)/this.state.regression.equation[1]}},{key:"setValue",value:function(e){this.setState({value:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(E.a,{color:"light",onClick:this.onBadgeClick,className:"d-i"},this.props.badgeFormatter(this.state.value))),r.a.createElement(fe.b,{ref:"slider",included:!1,value:this.findX(this.state.value),style:{height:"45px"},onChange:function(t){return e.onChange(t)},min:0,max:100,step:.5,marks:this.marks}))}}]),t}(n.Component),ke=ye;ye.defaultProps={marksNum:6,marksStyle:{color:"#ccc"},desc:"",badgeFormatter:function(e){return e},markFormatter:function(e){return e},marksAt:[]};var ge=a(59),Se=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(E.a,{color:"light",className:"d-i"},this.state.bounds[0]," - ",this.state.bounds[1])),r.a.createElement("div",{style:{height:"30px"}},Object(ge.a)(Object(u.a)(t.prototype),"render",this).call(this)))}}]),t}(fe.a),Ee=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(E.a,{color:"light",className:"d-i"},this.state.value)),r.a.createElement("div",{style:{height:"30px"}},r.a.createElement("div",null,Object(ge.a)(Object(u.a)(t.prototype),"render",this).call(this))))}},{key:"onBadgeClick",value:function(){}}]),t}(fe.b),we=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={value:void 0},a.onSliderChange=function(e){a.setState({innerValue:e,value:a.props.marks[e].value}),a.props.onChange(a.props.marks[e].value)},a.state.value=a.props.marks.find((function(e){return e.value===a.props.defaultValue})).value,a.state.innerValue=a.props.marks.findIndex((function(e){return e.value===a.props.defaultValue})),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setValue",value:function(e){var t=this.props.marks.findIndex((function(t){return t.value===e})),a=this.props.marks.find((function(t){return t.value===e})).value;this.setState({value:a,innerValue:t})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(E.a,{color:"light",className:"d-i"},this.props.badgeFormatter(this.state.value))),r.a.createElement("div",{style:{height:"3.5em",width:"95%",margin:"auto",whiteSpace:"nowrap"}},r.a.createElement(fe.b,{ref:"slider",included:!1,value:this.state.innerValue,style:{height:"3.5em"},onChange:this.onSliderChange,min:0,max:this.props.marks.length-1,step:1,marks:this.props.marks})))}}]),t}(n.Component),Ce=we;we.defaultProps={badgeFormatter:function(e){return e},markFormatter:function(e){return e},defaultValue:0};var Ie=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={bpmStep:a.props.bpmStep,bpmRange:a.props.bpmRange,currentBpm:a.props.bpmRange[0],playbackMode:a.props.playbackMode,playMode:a.props.playMode,stepsNum:a.props.stepsNum,exerciseTime:a.props.exerciseTime,bpmStepDropdownOpen:!1,byTimeInterval:a.props.byTimeInterval,byBarInterval:a.props.byBarInterval,constantBpmSlider:300},a.onBpmSliderChange=function(e){a.setState({constantBpmSlider:e},a.onAfterChange)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"onAfterChange",value:function(e){this.props.onChange()}},{key:"onModeChange",value:function(e){this.setState({playMode:e},this.onAfterChange)}},{key:"onBpmRangeChange",value:function(e){this.setState({bpmRange:e},this.onAfterChange)}},{key:"onBpmStepChange",value:function(){this.setState((function(e){return{bpmStepDropdownOpen:!e.bpmStepDropdownOpen}}))}},{key:"onBpmStepSelect",value:function(e){this.setState({bpmStep:e},this.onAfterChange)}},{key:"setValue",value:function(e){this.refs.byBarSlider.setValue(e.byBarInterval||V.byBarInterval),this.refs.byTimeSlider.setValue(e.byTimeInterval||V.byTimeInterval),this.refs.exerciseTimeSlider.setValue(e.exerciseTime||V.exerciseTime),this.refs.bpmRange.setState({bounds:e.bpmRange}),this.setState({playMode:e.playMode,playbackMode:e.playbackMode||this.state.playbackMode,bpmStep:e.bpmStep,exerciseTime:e.exerciseTime||this.state.exerciseTime,stepsNum:e.stepsNum||this.state.stepsNum,byBarInterval:e.byBarInterval,byTimeInterval:e.byTimeInterval,bpmRange:e.bpmRange,constantBpmSlider:e.constantBpmSlider||this.state.constantBpmSlider},this.onAfterChange)}},{key:"onTimeIntervalChange",value:function(e){this.setState({byTimeInterval:e,interval:e},this.onAfterChange)}},{key:"onBarIntervalChange",value:function(e){this.setState({byBarInterval:e,interval:e},this.onAfterChange)}},{key:"byBarFormatter",value:function(e){return e+" "+q(e,"bars")}},{key:"renderIncreaseBpmDropdown",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{style:{margin:"0px 5px"},isOpen:this.state.bpmStepDropdownOpen,toggle:function(){return e.onBpmStepChange()}},r.a.createElement(v.a,{caret:!0,size:"sm",outline:!0,color:"light"},this.state.bpmStep),r.a.createElement(b.a,null,[1,2,3,5,10,15,20,30,50,100].map((function(t){return r.a.createElement(y.a,{key:"bpm_"+t,onClick:function(){e.onBpmStepSelect(t)}},t)})))),"bpm")}},{key:"onStepsSliderChange",value:function(e){this.setState({stepsNum:e},this.onAfterChange)}},{key:"onExerciseTimeSliderChange",value:function(e){this.setState({exerciseTime:e},this.onAfterChange)}},{key:"renderTimeSlider",value:function(){var e=this;return r.a.createElement("div",null,X("Exercise Time"),r.a.createElement(Ce,{ref:"exerciseTimeSlider",badgeFormatter:ee.formatTimeLong,markFormatter:ee.formatTime,marks:[300,600,900,1200,1800,3600,7200,10800].map((function(e){return{value:e,label:ee.formatTime(e)}})),defaultValue:this.state.exerciseTime,onChange:function(t){return e.onExerciseTimeSliderChange(t)}}))}},{key:"renderStepsSlider",value:function(){var e=this;return r.a.createElement("div",null,X("Number of steps"),r.a.createElement(Ee,{ref:"stepsSlider",min:2,included:!1,max:100,marks:{1:"1",5:"5",10:"10",15:"15",20:"20",30:"30",40:"40",50:"50",60:"60",70:"70",80:"80",90:"90",100:"100"},defaultValue:10,onChange:function(t){return e.onStepsSliderChange(t)}}))}},{key:"renderSpeedRange",value:function(){var e=this;return r.a.createElement("div",null,X("BPM range"),r.a.createElement(Se,{ref:"bpmRange",min:30,max:1200,defaultValue:[this.state.bpmRange[0],this.state.bpmRange[1]],pushable:!0,onAfterChange:function(t){return e.onBpmRangeChange(t)}}))}},{key:"render",value:function(){var e=this;return r.a.createElement(C,{className:"ModePanel",title:"Mode",width:"300px"},r.a.createElement("h6",null,X("Increase speed")),r.a.createElement(Q.a,{size:"sm"},r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(R)},active:this.state.playMode===R},X("Set time")),r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(P)},active:this.state.playMode===P},X("By bar")),r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(j)},active:this.state.playMode===j},X("By time")),r.a.createElement(W.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(N)},active:this.state.playMode===N},X("Stable"))),r.a.createElement(G.a,{isOpen:this.state.playMode!==N},this.renderSpeedRange()),r.a.createElement(G.a,{isOpen:this.state.playMode===R},this.renderTimeSlider(),this.renderStepsSlider()),r.a.createElement(G.a,{isOpen:this.state.playMode===P},r.a.createElement("div",null,X("Increase speed every"),r.a.createElement(ke,{ref:"byBarSlider",defaultValue:this.state.byBarInterval,badgeFormatter:this.byBarFormatter,onChange:function(t){return e.onBarIntervalChange(t)},min:1,max:301,marksAt:[1,2,5,10,20,50,100,300]}))),r.a.createElement(G.a,{isOpen:this.state.playMode===j},r.a.createElement("div",null,X("Increase speed every"),r.a.createElement(ke,{ref:"byTimeSlider",defaultValue:this.state.byTimeInterval,badgeFormatter:ee.formatTimeLong,markFormatter:ee.formatTime,onChange:function(t){return e.onTimeIntervalChange(t)},min:1,max:1200,marksAt:[1,2,5,10,30,60,120,240,600,1200]}))),r.a.createElement(G.a,{isOpen:this.state.playMode!==N&&this.state.playMode!==R},this.renderIncreaseBpmDropdown()),r.a.createElement(G.a,{isOpen:this.state.playMode===N},r.a.createElement("div",null,"Choose bpm",r.a.createElement(Ee,{ref:"constantBpmSlider",included:!1,min:10,max:1200,marks:{30:"30",100:"100",200:"200",300:"300",400:"400",500:"500",600:"600",700:"700",800:"800",900:"900",1e3:"1000",1100:"1100",1200:"1200"},value:this.state.constantBpmSlider,onChange:this.onBpmSliderChange}))))}}]),t}(n.Component),Oe=Ie;Ie.defaultProps={playMode:V.playMode,playbackMode:V.playbackMode,interval:V.interval,bpmStep:V.bpmStep,bpmRange:V.bpmRange,byTimeInterval:V.byTimeInterval,byBarInterval:V.byBarInterval,stepsNum:V.stepsNum,exerciseTime:V.exerciseTime,currentBpm:V.bpmRange[0],onAfterChange:null};var Te=a(50),Me=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={activeIdx:null},a.activeColor="rgb(255, 121, 121)",a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setActive",value:function(e){this.setState({activeIdx:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"trackRow"},r.a.createElement("div",{className:"label"},r.a.createElement("span",null,this.props.sample.label)),this.props.trackRow.map((function(t,a){var n={};return e.props.trackRow[a]&&(n.backgroundColor=M[e.props.sample.idx]),e.state.activeIdx===a&&(n.borderColor=e.activeColor),r.a.createElement("div",{key:"cell_"+a,className:"clickable cell",style:n,onClick:function(){return e.props.onClick(e.props.sample.idx,a)}})})))}}]),t}(n.Component),Be=Me;Me.defaultProps={};var xe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={track:a.props.track},a.rowRefs=[],a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"handleColumnClick",value:function(e,t){var a=Object(Te.a)(this.props.track),n=Object(Te.a)(this.props.track[t]),r=this.props.track[t].indexOf(e);r<0?n.push(e):n.splice(r,1),a[t]=n,this.props.onChange(a)}},{key:"setActiveColumn",value:function(e){this.rowRefs.map((function(t){return t.current&&t.current.setActive(e),!0}))}},{key:"addBeat",value:function(){if(this.props.track.length<24){var e=Object(Te.a)(this.props.track);e.push([]),this.props.onChange(e,!0)}}},{key:"removeBeat",value:function(){if(this.props.track.length>1){var e=Object(Te.a)(this.props.track);e.splice(e.length-1,1),this.props.onChange(e,!0)}}},{key:"filterTrack",value:function(e){return this.props.track.map((function(t){return t.indexOf(e)>=0}))}},{key:"render",value:function(){var e=this;return void 0===this.props.instrument?r.a.createElement("div",null,"No instrument loaded"):(this.props.instrument.samples.map((function(t){return e.rowRefs.push(r.a.createRef()),!0})),r.a.createElement(C,{style:{padding:"15px"},title:X("Sequencer")},r.a.createElement("div",{className:"trackview"},r.a.createElement("div",{className:"trackContainer"},this.props.instrument.samples.map((function(t){return r.a.createElement(Be,{ref:e.rowRefs[t.idx],key:"trackRow_"+t.idx,sample:t,trackRow:e.filterTrack(t.idx),onClick:function(t,a){return e.handleColumnClick(t,a)}})}))),r.a.createElement("div",{className:"btnContainer"},r.a.createElement(Q.a,{size:"sm",vertical:!0},r.a.createElement(W.a,{onClick:function(){return e.addBeat()}},"+"),r.a.createElement(W.a,{onClick:function(){return e.removeBeat()}},"-"),r.a.createElement("h3",null,r.a.createElement(E.a,{color:"dark"},this.props.track.length)))))))}}]),t}(n.Component),Pe=xe;xe.defaultProps={track:V.track};var je=a(104),Re=a.n(je),Ne=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).progressFps=30,a.instrumentLib=new H({onInstrumentReady:function(e){return a.onInstrumentReady(e)}}),a.state={initialized:!1,config:V,track:a.props.track},a.transport=d.a.Transport,a.tone=d.a,a.repeat=function(e,t){for(var n=0;n<t.length;n++)a.state.instrument.triggerAttack(t[n],e);a.refs.trackView.setActiveColumn(Math.floor(a.loop.progress*a.transport.timeSignature))},a.setBpm=function(e){if(isNaN(e)||e<=0||e>1200)throw new Error("Invalid BPM value: "+e);e!==a.transport.bpm.value&&(d.a.Transport.bpm.value=e,a.setState({bpm:e}),document.title=e+" | "+a.documentTitle)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"onBufferError",value:function(e){throw new Error(e)}},{key:"onInstrumentReady",value:function(e){this.onInstrumentSelect(e.key),!1===this.state.initialized&&(this.setState({initialized:!0}),this.props.onReady())}},{key:"componentDidMount",value:function(){var e=this;(new d.a.Synth).toMaster().triggerAttackRelease("A2"),d.a.Buffer.on("error",this.onBufferError),d.a.Transport.lookAhead=10,this.loop=new d.a.Part((function(t,a){return e.repeat(t,a)}),[]),this.loop.loop=!0,this.loop.start(0);var t=this.getConfig();this.setPlan(t),this.initProgressUpdate(),this.documentTitle=document.title}},{key:"getConfig",value:function(){return Object(m.a)({},this.refs.modePanel.state,{},{track:this.state.track},{},{instrumentKey:this.state.instrument?this.state.instrument.key:V.instrumentKey})}},{key:"initProgressUpdate",value:function(){var e=this;setInterval((function(){return e.onProgress()}),1e3/this.progressFps)}},{key:"setPlan",value:function(e){this.transport.cancel(),this.transport.position=0,this.setTrack(e.track.slice()),this.refs.planner.setPlan(e)}},{key:"setTrack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1!==t||this.state.track!==e){this.setTimeSignature(e.length);var a=e.map((function(e){if(!Array.isArray(e))throw new Error("Invalid track item");return e.map((function(e){return[O[e]]}))}));if(this.loop.removeAll(),a.length>this.loop.length)for(var n=this.loop.length;n<a.length;n++)this.loop.add("0:"+n,a[n]);else if(a.length<this.loop.length)for(var r=this.loop.length-a.length,s=0;s<r;s++){var i=a.length+s;this.loop.remove("0:"+i)}this.loop.loopEnd="1m",this.loop.start(0),this.setState({track:e})}}},{key:"onProgress",value:function(){"stopped"!==this.transport.state&&(this.refs.debug&&(this.refs.debug.innerHTML=this.transport.seconds.toFixed(1)),this.refs.planner&&this.refs.planner.updateProgress(),this.refs.svgClock&&this.refs.svgClock.setProgress(this.loop.progress))}},{key:"calcTimeForBpm",value:function(e,t){return d.a.Time(e*t/this.baseBpm)}},{key:"getCurrentInstrumentLabel",value:function(){return this.instrumentLib.getInstrument().label}},{key:"setTimeSignature",value:function(e){e!==this.transport.timeSignature&&(this.transport.timeSignature=e)}},{key:"toggle",value:function(){"started"===d.a.Transport.state?this.stop():this.start()}},{key:"onPlanStep",value:function(e){this.setBpm(e)}},{key:"onControlChange",value:function(){var e=this.getConfig();this.setPlan(e)}},{key:"onInstrumentChange",value:function(){this.setState((function(e){return{instrumentDropdownOpen:!e.instrumentDropdownOpen}}))}},{key:"onInstrumentSelect",value:function(e){var t=this,a=!1;if(this.instrumentLib.hasInstrument(e)){var n=this.state.instrument?this.state.instrument.samples.length:0,r=this.instrumentLib.getInstrument(e),s=[];n>r.samples.length?(this.state.track.forEach((function(e){var t=[];e.forEach((function(e,a){e<r.samples.length&&t.push(e)})),s.push(t)})),a=!0):s=this.state.track,this.setState({instrument:r,instrumentDropdownLabel:r.label},a?function(){return t.setTrack(s)}:null)}else this.instrumentLib.loadInstrument(e)}},{key:"onPresetSelect",value:function(e){this.setState({track:e.track},(function(){this.refs.modePanel.setValue(e),this.onInstrumentSelect(e.instrumentKey)}))}},{key:"renderInstrumentsDropDown",value:function(){var e=this;return r.a.createElement(f.a,{isOpen:this.state.instrumentDropdownOpen,toggle:function(){return e.onInstrumentChange()}},r.a.createElement(v.a,{caret:!0,size:"sm",outline:!0,color:"light"},this.state.instrumentDropdownLabel),r.a.createElement(b.a,null,L.map((function(t){return r.a.createElement(y.a,{key:t.key,onClick:function(){return e.onInstrumentSelect(t.key)}},t.label)}))))}},{key:"onTrackChange",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.state.track.length!==e.length){var t=this.getConfig();t.track=e,this.setPlan(t)}else this.setTrack(e)}},{key:"handleKey",value:function(e,t){switch(e){case"s":this.toggle();break;case"esc":this.stop();break;case"left":this.refs.planner.stepBackward();break;case"right":this.refs.planner.stepForward();break;case"up":this.state.bpm<600&&this.setBpm(this.state.bpm+10);break;case"down":this.state.bpm>10&&this.setBpm(this.state.bpm-10)}}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re.a,{handleKeys:["s","esc","left","right","up","down"],onKeyEvent:function(t,a){return e.handleKey(t,a)}}),r.a.createElement(k.a,null,r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(C,{title:X("Control")},r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(W.a,{onClick:function(){return e.toggle()},color:this.state.isPlaying?"secondary":"light",block:!0},X("Start / Stop")))),r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(k.a,null,r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(S.a,{xs:"3"},X("Instrument"))),r.a.createElement(S.a,null,this.renderInstrumentsDropDown()))))),r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement("h2",null,r.a.createElement(E.a,{color:"dark"},"BPM: ",d.a.Transport.bpm.value.toFixed(0))))),r.a.createElement(g.a,null))),r.a.createElement(S.a,null,r.a.createElement(Oe,{ref:"modePanel",onChange:function(){return e.onControlChange()}}))),r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(Pe,{ref:"trackView",track:this.state.track,instrument:this.state.instrument,onChange:function(t,a){return e.onTrackChange(t,a)}}))),r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(ae,{transport:this.transport,progress:this.state.progress,onChange:function(){return e.onControlChange()},onPlanStep:function(t){return e.onPlanStep(t)},onPlanEnd:function(){return e.stop()},ref:"planner"})),r.a.createElement(S.a,null,r.a.createElement(pe,{ref:"presetsManager",getPreset:function(){return e.getConfig()},onSelect:function(t){return e.onPresetSelect(t)}}))),r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(de,{ref:"svgClock",instrument:this.state.instrument,track:this.state.track})))))}},{key:"stop",value:function(){this.transport.stop(),this.transport.position=0,this.setState({isPlaying:!1})}},{key:"start",value:function(){this.transport.start("+.1"),this.loop.start(),this.setState({isPlaying:!0})}}]),t}(n.Component),De=Ne;Ne.defaultProps={instrument:V.instrument,track:V.track,onReady:function(){}};a(176),a(177);var Ae=a(79),ze=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showMask:!0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){Ae.a.initialize({trackingId:"UA-151010848-1",debug:!0,gaOptions:{cookieDomain:"none"}}),Ae.a.pageview(window.location.pathname+window.location.search)}},{key:"removeLoadMask",value:function(){this.setState({showMask:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(k.a,{className:"app-container "},r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(De,{ref:"sm",onReady:function(){return e.removeLoadMask()}}))),r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement(C,{title:X("Keyboard controls"),className:"about"},r.a.createElement("div",null,r.a.createElement("code",null,X("arrow up/down"))," - ",X("higher/lower BPM")),r.a.createElement("div",null,r.a.createElement("code",null,X("arrow left/right"))," - ",X("previous/next step according to plan")),r.a.createElement("div",null,r.a.createElement("code",null,"s")," - ",X("start/stop")),r.a.createElement("div",null,r.a.createElement("code",null,"esc")," - ",X("stop"))))),r.a.createElement(g.a,null,r.a.createElement(S.a,null,r.a.createElement("div",{className:"footer"},r.a.createElement("div",null,"Join discord using ",r.a.createElement(E.a,{href:"https://discord.gg/fAwnmVh",target:"blank"},"this link")," for feedback and improvement suggestions."),r.a.createElement("div",null,"By using this site you agree to the use of cookies to store user defined presets and analytics."),r.a.createElement("div",null,"Created using ",r.a.createElement(E.a,{href:"https://reactjs.org/",target:"blank"},"React")," and ",r.a.createElement(E.a,{href:"https://tonejs.github.io/",target:"blank"},"Tone.js"),". Source code available ",r.a.createElement(E.a,{href:"https://github.com/indiebubbler/metro"},"here"),"."),r.a.createElement("div",null,"Supported languages are english and polish. If you want to help translating this page into your language please contact me:",r.a.createElement(E.a,{href:"mailto:indiebubbler@gmail.com?subject=Feedback"},"indiebubbler@gmail.com"),"."),r.a.createElement("div",null,"\xa9 IndieBubbler 2019-2020. Version 2.0 beta"))))),r.a.createElement("div",{ref:"loadMask",className:!0===this.state.showMask?"loadmask ":"loadmask fadeOut"}))}}]),t}(n.Component),_e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ke(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(ze,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/metro",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/metro","/service-worker.js");_e?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ke(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):Ke(t,e)}))}}()}},[[105,1,2]]]);
//# sourceMappingURL=main.acc1e1f8.chunk.js.map