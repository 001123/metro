{"version":3,"sources":["components/AccentTypes.jsx","components/SoundMachineInstrument.jsx","components/InstrumentLib.jsx","components/PlayModes.jsx","components/SoundMachine.jsx","components/SimpleProgress.jsx","components/Utils.jsx","components/Planner.jsx","components/AdvancedSlider.jsx","components/Accent.jsx","components/BarManager.jsx","components/EditPresetModal.jsx","components/PresetsManager.jsx","components/SimplePanel.jsx","components/PlaybackModes.jsx","components/GeometricSlider.jsx","components/AdvancedRange.jsx","components/ModePanel.jsx","components/PresetsLib.jsx","components/Vis.jsx","App.jsx","serviceWorker.js","index.js"],"names":["accentTypes","ACCENT_1","ACCENT_2","ACCENT_3","accentTypesArr","SoundMachineInstrument","props","_this","Object","classCallCheck","this","o","C3","samples","C#3","D3","possibleConstructorReturn","getPrototypeOf","call","baseUrl","key","label","Sampler","instruments","TABLA","ELECTRO_KIT","METRONOME","InstrumentLib","defaultInstrument","state","lib","currentInstrument","undefined","fft","tabla","electro","metronome","setInstrument","Tone","FFT","fan","toMaster","Error","Component","playModes","BY_BAR","BY_TIME","STABLE","SoundMachine","accentNotes","instrumentLib","currentBeat","beatsPerStep","progressRefreshRate","score","isPlaying","accents","executeStep","step","lastStep","currentStep","getBpm","bpm","setBpm","newLE","playMode","duration","Transport","setLoopPoints","lastLoopDuration","start","repeat","time","idx","note","getInstrument","triggerAttack","Draw","schedule","onBeat","isNaN","value","loopEnd","setBeatsPerStep","newBps","length","pop","push","timeSignature","loop","setState","handleStartStop","stop","instrument","onToggle","clearInterval","stepProgressUpdateTimer","_this2","setInterval","updateProgress","_this3","Synth","triggerAttackRelease","Buffer","on","onBufferError","onStop","onStart","onLoopEnd","context","latencyHint","Loop","onProgress","progress","vis","drawFFT","getValue","instrumentKey","i","_this4","react_default","a","createElement","Button","outline","color","onClick","block","active","defaultProps","SimpleProgress","Container","className","style","width","display","Utils","padTime","t","formatTime","timeInSeconds","Date","setSeconds","getMinutes","getSeconds","Planner","bars","stepProgress","isPaused","timer","ref","startTime","stepsCounter","barRender","b","cls","setStep","segmentDuration","toFixed","end","s","segments","min","bpmRange","max","segment","interval","bpmStep","Infinity","stableBpmSlider","uiStateObject","plan","makePlan","totalPlanTime","bar","timeEnd","startTimeFormatted","endTimeFormatted","prevState","stepChanged","pause","resetStep","stepIdx","getCurrentStep","onStep","date","Badge","currentBpm","components_SimpleProgress","lockBpm","opacity","map","AdvancedSlider","Fragment","height","get","prototype","Slider","Accent","isCurrent","type","BarManager","defaultValue","onAfterChange","selected","newBars","toConsumableArray","lastActiveAccent","toggleCurrent","el","refs","components_Accent","handleCellClick","EditPresetModal","modal","preset","showDelete","toggle","bind","assertThisInitialized","title","onSave","e","newTitle","target","objectSpread","onDeleteBtn","marginTop","size","onSaveBtn","Modal","isOpen","ModalHeader","ModalBody","Input","onChange","titleChanged","JSON","stringify","ModalFooter","handleSave","renderDelete","PresetsManager","showEdit","userPresets","cookies","Array","fill","onSelect","toLowerCase","saveInCookie","presets","set","path","indexOf","splice","stopPropagation","presetEditor","edit","p","getPreset","parse","Row","item","Col","hidden","isHidden","onPresetClick","onMouseEnter","showEditBtn","onMouseLeave","hideEditBtn","visibility","onPresetEdit","components_EditPresetModal","onPresetDelete","onSavePreset","SimplePanel","children","playbackModes","STOP","CYCLE","REPEAT","CONTINUE","GeometricSlider","regression","d","exponential","precision","prepareMarks","marks","marksAt","findX","markFormatter","Math","floor","marksStyle","v","predict","y","log","equation","onBadgeClick","badgeFormatter","es","included","marksNum","desc","AdvancedRange","bounds","Range","ModePanel","playbackMode","bpmStepDropdownOpen","byTimeInterval","byBarInterval","onBpmSliderChange","newMode","playBackMode","byBarSlider","byTimeSlider","setValue","barsNum","newPlaybackMode","ButtonDropdown","margin","onBpmStepChange","DropdownToggle","caret","DropdownMenu","DropdownItem","onBpmStepSelect","components_AdvancedRange","pushable","onBpmRangeChange","components_SimplePanel","ButtonGroup","onModeChange","Collapse","renderSpeedRange","components_GeometricSlider","byBarFormatter","onBarIntervalChange","byTimeFormatter","onTimeIntervalChange","renderIncreaseBpmDropdown","components_AdvancedSlider","30","100","200","300","400","500","600","onPlaybackChange","PresetsLib","InitPreset","Vis","values","redraw","ctx","canvas","getContext","clearRect","rect","barWidth","lineWidth","lineCap","len","x","h","strokeStyle","beginPath","moveTo","lineTo","stroke","window","addEventListener","updateDimensions","clientWidth","container","App","instrumentDropdownOpen","instrumentDropdownLabel","cycleDropdownOpen","playbackDirection","onBeatsPerStepChange","getUiState","sm","barManager","getAccents","setAccents","newBpm","document","handleKeyDown","planner","setPlan","setVis","keyCode","stepForward","preventDefault","stepBackward","newInstrument","getCurrentInstrumentLabel","onInstrumentChange","onInstrumentSelect","xs","renderInstrumentsDropDown","components_BarManager","onAccentsChange","renderPresetsPane","href","rel","setProgress","_this5","components_SoundMachine","beat","components_ModePanel","onModePanelChanged","renderPlaybackPane","_this6","components_PresetsManager","onPresetSelect","modePanel","_this7","components_Planner","onPlanStep","components_Vis","isLastStep","isFirstStep","currentMode","setActive","renderLeftPane","renderRightPane","renderBottomPane","s1","s2","uiState","withCookies","Boolean","location","hostname","match","ReactDOM","render","es6","src_App_0","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.d7287556.chunk.js","sourcesContent":["export const accentTypes = {\r\n\tACCENT_1: 0,\r\n\tACCENT_2: 1,\r\n\tACCENT_3: 2\r\n};\r\n\r\nexport const accentTypesArr = [\r\n\taccentTypes.ACCENT_1, accentTypes.ACCENT_2, accentTypes.ACCENT_3\r\n];","import {Sampler} from 'tone'\r\n\r\n\r\nclass SoundMachineInstrument extends Sampler {\r\n\r\n    constructor(props) {\r\n        // console.log('<SoundMachineInstrument>constructor', props.key)\r\n        var o = {\r\n            \"C3\" : props.samples[0],\r\n            \"C#3\" : props.samples[1],\r\n            \"D3\" : props.samples[2],\r\n        };\r\n        super(o,{\r\n            baseUrl: props.baseUrl || './audio/' + props.key + '/'\r\n        });\r\n        this.key = props.key;\r\n        this.label = props.label;\r\n    }\r\n}\r\n\r\nexport default SoundMachineInstrument;\r\n\r\n ","import { Component } from \"react\";\r\nimport SoundMachineInstrument from \"./SoundMachineInstrument\"\r\nimport Tone from 'tone'\r\nexport const instruments = {\r\n\tTABLA: \"tabla\",\r\n    ELECTRO_KIT: \"electrokit\",\r\n    METRONOME: \"metronome\"\t// ACOUSTIC_KIT: \"acoustic_kit\"\r\n};\r\n\r\nclass InstrumentLib extends Component {\r\n\tstate = {};\r\n    lib = {};\r\n    currentInstrument = undefined\r\n    fft = undefined\r\n\r\n\r\n    constructor(defaultInstrument) {\r\n        super();\r\n    \r\n        //Tone.Buffer.on(\"load\", () => this.onBufferLoaded());\r\n\t\tvar tabla = new SoundMachineInstrument({\r\n            key: instruments.TABLA,\r\n            label: \"Tabla\",\r\n\t\t\tsamples: [\"dha-slide.wav\", \"dhin-slide.wav\", \"tin.wav\"]\r\n        });\r\n        this.lib[ tabla.key ] = tabla;\r\n    \r\n        var electro = new SoundMachineInstrument({\r\n            key: instruments.ELECTRO_KIT,\r\n            label: 'Electronic Kit',\r\n\t\t\tsamples: [\"Kick.wav\", \"HiHat.wav\", \"Snare.wav\"]\r\n        });\r\n        this.lib[ electro.key ] = electro;\r\n\r\n        var metronome = new SoundMachineInstrument({\r\n            key: instruments.METRONOME,\r\n            label: \"Metronome\",\r\n            samples: [\"tap.wav\", \"down.wav\",\"up.wav\"]\r\n        })\r\n\r\n        this.lib[ metronome.key ] = metronome;\r\n        \r\n\r\n        this.setInstrument(defaultInstrument)\r\n        \r\n        // console.log('<InstrumentLib>done constructor')\r\n\r\n        this.fft = new Tone.FFT(128);\r\n        \r\n        // connect instruments to FFT analyzer\r\n        electro.fan(this.fft).toMaster();\r\n        tabla.fan(this.fft).toMaster();\r\n        metronome.fan(this.fft).toMaster();\r\n    }\r\n\r\n    setInstrument(key) {\r\n        if (this.lib[key] === undefined) {\r\n            throw new Error(\"InstrumentLib has no such instrument with given key: \" + key)\r\n        }\r\n        this.currentInstrument = key;\r\n    }\r\n \r\n    getInstrument() {\r\n        if (this.lib[this.currentInstrument] === undefined) {\r\n            throw new Error(\"There is no such instrument in InstrumentLib: \" + this.currentInstrument)\r\n        }\r\n        return this.lib[this.currentInstrument];\r\n    }\r\n\r\n\t// render() {\r\n\t// \treturn <div />;\r\n\t// }\r\n}\r\nexport default InstrumentLib;\r\n","export const playModes = {\r\n\tBY_BAR: \"by_bar\",\r\n\tBY_TIME: \"by_time\",\r\n\tSTABLE: \"stable\"\r\n};","import React, { Component } from \"react\";\r\nimport Tone from \"tone\";\r\nimport { accentTypes } from \"./AccentTypes\";\r\nimport InstrumentLib from \"./InstrumentLib\";\r\nimport { Button } from 'reactstrap'\r\nimport { playModes } from \"./PlayModes\";\r\n\r\nclass SoundMachine extends Component {\r\n\r\n\taccentNotes = [\"C3\", \"C#3\", \"D3\"]; // this stay in sync with AccentTypes\r\n\r\n\tinstrumentLib = undefined;\r\n\r\n\tcurrentBeat = 0;\r\n\tbeatsPerStep = 4;\r\n\r\n\tprogressRefreshRate = 1000 / 60; // fps\r\n\r\n\tscore = [\"C3\", \"C#3\", \"C#3\", \"C#3\"];\r\n\r\n\tstate = {\r\n\t\tisPlaying: false\r\n\t};\r\n\r\n\taccents = [accentTypes.ACCENT_1]; // default with accent on first beat\r\n\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\t// init instruments library\r\n\t\tthis.instrumentLib = new InstrumentLib(this.props.instrument)\r\n\t}\r\n\r\n\tonBufferError() {\r\n\t\tthrow new Error(\"Some buffers weren't found\")\r\n\t}\r\n\r\n\tonStop() {\r\n\t\t// console.log('onStop')\r\n\t\tthis.props.onToggle(this.state.isPlaying)\r\n\r\n\t\tclearInterval(this.stepProgressUpdateTimer);\r\n\t}\r\n\r\n\tonStart() {\r\n\t\tthis.props.onToggle(this.state.isPlaying)\r\n\r\n\t\tthis.stepProgressUpdateTimer = setInterval(\r\n\t\t\t() => this.updateProgress(),\r\n\t\t\tthis.progressRefreshRate\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t// reload/debug bell\r\n\t\tvar synth = new Tone.Synth().toMaster();\r\n\t\tsynth.triggerAttackRelease(\"A2\");\r\n\r\n\t\tTone.Buffer.on(\"error\", () => this.onBufferError());\r\n\r\n\t\tTone.Transport.on('stop', () => this.onStop());\r\n\t\tTone.Transport.on('start', () => this.onStart());\r\n\t\t// Tone.Transport.on('pause', () => console.log('TRANSPORT.pause'));\r\n\t\t// Tone.Transport.on('start', () => console.log('TRANSPORT.start'));\r\n\t\tTone.Transport.on('loop', (time) => this.props.onLoopEnd(time));\r\n\r\n\t\tTone.context.latencyHint = \"playback\";\r\n\r\n\t\tTone.Transport.timeSignature = 4;// [this.beatsPerStep, 4];\r\n\r\n\t\tTone.Transport.loop = true;\r\n\t\tTone.Transport.loopEnd = \"1m\"\r\n\r\n\t\tthis.loop = new Tone.Loop((time) => this.repeat(time), \"4n\");\r\n\t\tthis.loop.start()\r\n\t\t// console.log('Transport loopEnd set to', Tone.Transport.loopEnd)\r\n\r\n\t\t//Tone.Transport.scheduleRepeat((time) => this.repeat(time), \"4n\");\r\n\r\n\r\n\t}\r\n\r\n\tupdateProgress() {\r\n\t\tthis.props.onProgress(Tone.Transport.progress);\r\n\r\n\t\tif (this.vis) {\r\n\t\t\tthis.vis.drawFFT(this.instrumentLib.fft.getValue())\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsetStep(step) {\r\n\t\t// console.log(\"<SM>store step:\", step)\r\n\r\n\t\tif (step === this.currentStep) {\r\n\t\t\t// console.log('step didnt changed so continue only')\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.currentStep = step;\r\n\r\n\t\tif (this.state.isPlaying === true) {\r\n\t\t\t// console.log(\"<SM>execute step:\", step)\r\n\t\t\tthis.executeStep(step)\r\n\t\t}\r\n\t\treturn this.currentStep.bpm\r\n\t}\r\n\r\n\texecuteStep = (step) => {\r\n\t\t// console.log('executeStep ', step)\r\n\r\n\t\t\r\n\t\tif (this.lastStep !== step) {\r\n\t\t\tthis.lastStep = step;\r\n\t\t\tthis.currentStep = step;\r\n\r\n\t\t\tif (this.getBpm() !== step.bpm) {\r\n\t\t\t\tthis.setBpm(step.bpm)\r\n\t\t\t}\r\n\r\n\t\t\tconst newLE =  this.currentStep.playMode === playModes.BY_TIME ?  step.duration : step.duration + 'm';\r\n\t\t\t// console.log('new Loop End', newLE)\r\n\t\t\tTone.Transport.setLoopPoints(0,  newLE);\r\n\t\t\tTone.Transport.lastLoopDuration = this.currentStep.duration;\r\n\t\t}\r\n\r\n\r\n\t\tif (Tone.Transport.state === 'stopped') {\r\n\t\t\tTone.Transport.start(\"+0.01\")\r\n\t\t}\r\n\r\n\t}\r\n\r\n\trepeat = (time) => {\r\n\t\tconst idx = this.currentBeat++ % this.beatsPerStep;\r\n\r\n\t\tconst note = this.score[idx];\r\n\r\n\t\t// make sound\r\n\t\tthis.instrumentLib.getInstrument().triggerAttack(note, time);\r\n\r\n\r\n\r\n\r\n\t\t// draw stuff\r\n\t\tTone.Draw.schedule(() => this.onBeat(idx), time)\r\n\t}\r\n\r\n\tsetInstrument(instrumentKey) {\r\n\t\tthis.instrumentLib.setInstrument(instrumentKey);\r\n\t}\r\n\r\n\tgetCurrentInstrumentLabel() {\r\n\t\treturn this.instrumentLib.getInstrument().label;\r\n\t}\r\n\r\n\tsetBpm = bpm => {\r\n\r\n\t\tif (isNaN(bpm) || bpm <= 0 || bpm > 1000) {\r\n\t\t\tthrow new Error(\"Invalid BPM value: \" + bpm)\r\n\t\t}\r\n\r\n\t\tif (bpm !== Tone.Transport.bpm.value) {\r\n\t\t\tTone.Transport.bpm.value = bpm;\r\n\t\t\tTone.Transport.loopEnd = \"1m\"\r\n\t\t\t// console.log('bpm changed to', bpm)\r\n\t\t}\r\n\t};\r\n\r\n\tsetBeatsPerStep = newBps => {\r\n\t\t// console.log(\"<SoundMachine>setBeatsPerStep\", newBps)\r\n\r\n\r\n\t\tthis.beatsPerStep = newBps;\r\n\r\n\t\t// remove if needed\r\n\t\twhile (this.score.length > newBps) {\r\n\t\t\tthis.score.pop();\r\n\t\t}\r\n\r\n\t\t// add if needed\r\n\t\twhile (this.score.length < newBps) {\r\n\t\t\tthis.score.push(accentTypes.ACCENT_1)\r\n\t\t}\r\n\r\n\t\tTone.Transport.timeSignature = newBps;//[newBps, 4];\r\n\t\tTone.Transport.loop = true;\r\n\r\n\t\t// this will refresh visualisation\r\n\t\tthis.setState({ beatsPerStep: newBps })\r\n\t};\r\n\r\n\tonBeat = (currentBeat) => {\r\n\t\tthis.props.onBeat(currentBeat);\r\n\r\n\t\t// this.fft.connect(Tone.Master);\r\n\r\n\t\t// console.log('beat', this.fft.getValue())\r\n\t}\r\n\r\n\tsetAccents(accentTypesArr) {\r\n\t\tthis.accents = accentTypesArr;\r\n\r\n\t\tfor (let i = 0; i < this.score.length; i++) {\r\n\t\t\t// by default 2 will be the tick note\r\n\t\t\tlet note = this.accentNotes[accentTypes.ACCENT_2];\r\n\r\n\t\t\t// if accent for this step is specified set it here\r\n\t\t\tif (\r\n\t\t\t\taccentTypesArr[i] !== undefined &&\r\n\t\t\t\taccentTypesArr[i] === accentTypes.ACCENT_1\r\n\t\t\t) {\r\n\t\t\t\tnote = this.accentNotes[accentTypes.ACCENT_1];\r\n\t\t\t} else if (\r\n\t\t\t\taccentTypesArr[i] !== undefined &&\r\n\t\t\t\taccentTypesArr[i] === accentTypes.ACCENT_3\r\n\t\t\t) {\r\n\t\t\t\tnote = this.accentNotes[accentTypes.ACCENT_3];\r\n\t\t\t}\r\n\t\t\tthis.score[i] = note;\r\n\t\t}\r\n\t}\r\n\r\n\thandleStartStop = () => {\r\n\t\t// console.log(\"<SM>HandleStartStop, state:\", Tone.Transport.state)\r\n\r\n\t\tif (Tone.Transport.state === 'started') {\r\n\t\t\tthis.stop();\r\n\r\n\t\t} else {\r\n\t\t\tthis.start(this.currentStep);\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\r\n\t\t\t<Button\r\n\t\t\t\toutline\r\n\t\t\t\tcolor=\"light\"\r\n\t\t\t\tonClick={() => this.handleStartStop()}\r\n\t\t\t\tblock\r\n\t\t\t\tactive={this.state.isPlaying}\r\n\t\t\t>\r\n\t\t\t\tStart / Stop\r\n\t\t\t</Button>\r\n\r\n\t\t\t// <div style={{width: '100%'}}>\r\n\t\t\t// \t{/* <div>Sound is {this.state.isPlaying === true ? \"playing\" : \"stopped\"}</div> */}\r\n\t\t\t// \t{/* <SimpleVis ref=\"vis\" beats={this.state.beatsPerStep}/> */}\r\n\t\t\t// </div>\r\n\t\t);\r\n\t}\r\n\r\n\tsetVis(vis) {\r\n\t\tthis.vis = vis;\r\n\t}\r\n\tstop() {\r\n\t\t// console.log('<SM>stop')\r\n\t\tthis.setState({ isPlaying: false });\r\n\t\tthis.currentBeat = 0;\r\n\t\tTone.Transport.stop();\r\n\t}\r\n\r\n\tstart(step) {\r\n\t\t// console.log('<SM>Start')\r\n\t\tthis.setState({ isPlaying: true }, this.executeStep(step));\r\n\r\n\t}\r\n\r\n\tgetBpm = () => {\r\n\t\treturn Tone.Transport.bpm.value;\r\n\t};\r\n}\r\n\r\nexport default SoundMachine;\r\n\r\n\r\nSoundMachine.defaultProps = {\r\n\tbeatsPerStep: 4,\r\n\tonLoopEnd: function (time) { },\r\n\tonToggle: function (state) { },\r\n\tonProgress: function (progress) { }\r\n};","import React, { Component } from 'react';\r\nimport {Container} from 'reactstrap';\r\n\r\nclass SimpleProgress extends Component {\r\n    state = {  }\r\n    render() { \r\n        return ( <Container className=\"SimpleProgress\">\r\n            <div className=\"bar\" style={{width: this.props.value  + \"%\", display: 'block'}} />\r\n        </Container> );\r\n    }\r\n}\r\n \r\nexport default SimpleProgress;","const Utils = {\r\n    padTime: function(t) {\r\n\t\treturn t < 10 ? \"0\" + t : t;\r\n\t},\r\n\tformatTime: function(timeInSeconds) {\r\n\t\t//{this.leadingZeroCheck(now.getMinutes())}:{now.getSeconds()} --\r\n\t\tlet t = new Date(0, 0, 0, 0, 0, 0, 0);\r\n\t\tt.setSeconds(timeInSeconds);\r\n\t\tlet m = t.getMinutes();\r\n\t\tlet o = \"\";\r\n\t\tif (m !== 0) {\r\n\t\t\to += t.getMinutes(); //this.padTime(t.getMinutes());\r\n            o += \":\";\r\n            o += \"\" + Utils.padTime(t.getSeconds());\r\n        }\r\n        else {\r\n            o += t.getSeconds();\r\n        }\r\n\t\treturn o;\r\n    }\r\n}\r\n\r\nexport default Utils;","import React, { Component } from \"react\";\r\nimport { Badge } from \"reactstrap\";\r\nimport { playModes } from \"./PlayModes\";\r\nimport SimpleProgress from \"./SimpleProgress\";\r\nimport Utils from \"./Utils\";\r\n\r\nclass Planner extends Component {\r\n\tstate = {\r\n\t\tbars: [],\r\n\t\tstepProgress: 0,\r\n\t\tisPaused: false\r\n\t};\r\n\r\n\ttimer = {\r\n\t\tref: null,\r\n\t\tstartTime: null\r\n\t};\r\n\tstepsCounter = 0;\r\n\t// stepProgressUpdateInterval = 1000 / 30; // 30 fps\r\n\r\n\tmakePlan(s) {\r\n\t\tlet segments = [];\r\n\r\n\t\tif (s.playMode === playModes.BY_BAR) {\r\n\t\t\tconst min = s.bpmRange[0];\r\n\t\t\tconst max = s.bpmRange[1];\r\n\t\t\tlet bpm = min;\r\n\t\t\twhile (bpm <= max) {\r\n\t\t\t\tlet segment = {\r\n\t\t\t\t\tbpm: bpm,\r\n\t\t\t\t\tduration: s.interval,\r\n\t\t\t\t\tend: s.interval \t// TODO <--- remove this \r\n\t\t\t\t};\r\n\t\t\t\tsegments.push(segment);\r\n\t\t\t\tbpm += s.bpmStep;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (s.playMode === playModes.BY_TIME) {\r\n\t\t\tconst min = s.bpmRange[0];\r\n\t\t\tconst max = s.bpmRange[1];\r\n\t\t\tlet bpm = min;\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\twhile (bpm <= max) {\r\n\t\t\t\tlet segment = {\r\n\t\t\t\t\ttime: i * s.interval,\r\n\t\t\t\t\tstart: i * s.interval,\r\n\t\t\t\t\tend: i * s.interval + s.interval,\r\n\t\t\t\t\tduration: s.interval,\r\n\t\t\t\t\tbpm: bpm\r\n\t\t\t\t};\r\n\t\t\t\tsegments.push(segment);\r\n\t\t\t\tbpm += s.bpmStep;\r\n\t\t\t}\r\n\t\t} else if (s.playMode === playModes.STABLE) {\r\n\t\t\tlet segment = {\r\n\t\t\t\ttime: Infinity, // TODO <--remove\r\n\t\t\t\tduration: Infinity,\r\n\t\t\t\tbpm: s.stableBpmSlider\r\n\t\t\t};\r\n\t\t\tsegments.push(segment);\r\n\t\t}\r\n\t\treturn segments;\r\n\t}\r\n\r\n\t// TODO: this is ugly\r\n\tsetPlan(uiStateObject) {\r\n\t\t// debugger\r\n\t\tconst plan = this.makePlan(uiStateObject);\r\n\r\n\t\t// console.log(\"<Planner>setPlan\", plan);\r\n\t\tvar bars = [];\r\n\r\n\t\tlet totalPlanTime = 0;\r\n\t\tconst playMode = uiStateObject.playMode;\r\n\t\tlet i = 0;\r\n\r\n\t\tswitch (uiStateObject.playMode) {\r\n\t\t\tcase playModes.BY_BAR:\r\n\t\t\t\tfor (i = 0; i < plan.length; i++) {\r\n\t\t\t\t\tconst bar = {\r\n\t\t\t\t\t\tbpm: plan[i].bpm,\r\n\t\t\t\t\t\tduration: plan[i].end,\r\n\t\t\t\t\t\tend: plan[i].end,\r\n\t\t\t\t\t\tstep: this.stepsCounter++,\r\n\t\t\t\t\t\tplayMode: playModes.BY_BAR\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\ttotalPlanTime +=\r\n\t\t\t\t\t\t(60 / plan[i].bpm) *\r\n\t\t\t\t\t\tuiStateObject.beatsPerStep *\r\n\t\t\t\t\t\tplan[i].end;\r\n\t\t\t\t\tbars.push(bar);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase playModes.BY_TIME:\r\n\t\t\t\tfor (i = 0; i < plan.length; i++) {\r\n\t\t\t\t\tconst bar = {\r\n\t\t\t\t\t\ttime: plan[i].time,\r\n\t\t\t\t\t\tduration: plan[i].end - plan[i].time,\t// TODO: remove other unnecesary parameters\r\n\t\t\t\t\t\ttimeEnd: plan[i].end,\r\n\t\t\t\t\t\tsegmentDuration: plan[i].end - plan[i].time,\r\n\t\t\t\t\t\tstartTimeFormatted: Utils.formatTime(plan[i].start),\r\n\t\t\t\t\t\tendTimeFormatted: Utils.formatTime(plan[i].end),\r\n\t\t\t\t\t\tbpm: plan[i].bpm,\r\n\t\t\t\t\t\tplayMode: playModes.BY_TIME,\r\n\t\t\t\t\t\tstep: this.stepsCounter++\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\ttotalPlanTime += plan[i].end;\r\n\r\n\t\t\t\t\tbars.push(bar);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase playModes.STABLE:\r\n\t\t\t\ttotalPlanTime = Infinity;\r\n\t\t\t\tbars.push({\r\n\t\t\t\t\tbpm: plan[0].bpm,\r\n\t\t\t\t\tduration: Infinity,\r\n\t\t\t\t\tplayMode: playModes.STABLE,\r\n\t\t\t\t\ttime: Infinity,\r\n\t\t\t\t\tstep: 0\r\n\t\t\t\t});\r\n\t\t\t\t// console.log(\"plan set to play at {0} bpm\", plan[0].bpm);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t// update to new state\r\n\t\tthis.stepsCounter = 0;\r\n\r\n\t\tthis.setState(\r\n\t\t\tprevState => ({\r\n\t\t\t\ttotalPlanTime: totalPlanTime,\r\n\t\t\t\tcurrentStep: 0,\r\n\t\t\t\tbars: bars,\r\n\t\t\t\tplayMode: playMode\r\n\t\t\t}),\r\n\t\t\t() => this.stepChanged()\r\n\t\t);\r\n\t}\r\n\r\n\tstop() {\r\n\t\t// console.log(\"lockBpm\", this.props.lockBpm);\r\n\t\tthis.pause();\r\n\t\tthis.resetStep();\r\n\t}\r\n\r\n\tsetStep(stepIdx) {\r\n\t\t// console.log('this.state.currentStep !== stepIdx',this.state.currentStep , stepIdx)\r\n\r\n\t\tif (this.state.currentStep !== stepIdx) {\r\n\t\t\tthis.setState({currentStep: stepIdx}, this.stepChanged)\r\n\t\t}\r\n\t}\r\n\r\n\tisLastStep() {\r\n\t\treturn this.state.currentStep === this.state.bars.length -1;\r\n\t}\r\n\t\r\n\tisFirstStep() {\r\n\t\treturn this.state.currentStep === 0;\r\n\t}\r\n\r\n\r\n\tstepForward() {\r\n\t\t// console.log(\"<Planner>stepForward()\")\r\n\t\t// check if we're not at the end of plan\r\n\t\tif (this.state.currentStep + 1 < this.state.bars.length) {\r\n\t\t\tthis.setStep(this.state.currentStep + 1)\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// console.log('no more steps')\r\n\t\t}\r\n\t}\r\n\r\n\tstepBackward() {\r\n\t\t// console.log(\"<Planner>stepBackward()\")\r\n\r\n\r\n\t\tif (this.state.currentStep - 1 >= 0) {\r\n\t\t\tthis.setStep(this.state.currentStep - 1)\r\n\t\t}\r\n\t}\r\n\r\n\t// onInterval() {\r\n\t// \tthis.stepForward();\r\n\t// \t// if (this.timer) {\r\n\t// \t// \t// set time when we changed step to be able to render progress easily\r\n\t// \t// \tthis.timer.startTime = new Date();\r\n\t// \t// }\r\n\t// }\r\n\r\n\tstart() {\r\n\t\t\r\n\t}\r\n\r\n\tsetProgress(progress) {\r\n\t\tthis.setState({stepProgress: progress});\r\n\t}\r\n\t\r\n\tstepChanged() {\r\n\t\t// console.log(\"<Planner>stepChanged\")\r\n\t\tconst step = this.getCurrentStep();\r\n\t\tthis.props.onStep(step);\r\n\t}\r\n\r\n\tresetStep() {\r\n\t\t// console.log('<Planner> resetStep()')\r\n\t\tthis.setStep(0)\r\n\t}\r\n\r\n\tgetCurrentStep() {\r\n\t\tif (this.state.currentStep >= this.state.bars.length) {\r\n\t\t\tthrow new Error(\"Trying to get step that doesn't exists\");\r\n\t\t}\r\n\t\treturn this.state.bars[this.state.currentStep];\r\n\t}\r\n\r\n\tbarRender = b => {\r\n\t\tconst cls = this.state.currentStep === b.step ? \"current-step\" : \"\";\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tonClick={() => this.setStep(b.step)}\r\n\t\t\t\tclassName={\"step \" + cls}\r\n\t\t\t\tkey={\"key_\" + b.bpm}\r\n\t\t\t>\r\n\t\t\t\t{b.segmentDuration !== undefined\r\n\t\t\t\t\t? Utils.formatTime(b.segmentDuration.toFixed(0)) + \" \"\r\n\t\t\t\t\t: b.end + \" bars \"}\r\n\t\t\t\tat {b.bpm.toFixed(0)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tformatTime(date) {\r\n\t\treturn date.getMinutes() + \":\" + date.getSeconds();\r\n\t}\r\n \r\n\trender() {\r\n\t\tif (this.state.bars.length === 0) {\r\n\t\t\treturn <div>No plan</div>;\r\n\t\t}\r\n\t\telse if (this.state.bars[0].time === Infinity) {\r\n\t\t\treturn (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{/* Playing at constant speed {this.state.bars[0].bpm} bpm */}\r\n\t\t\t\t\t<h2><Badge color=\"dark\">BPM: {this.props.currentBpm}</Badge></h2>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"Planner\">\r\n\t\t\t\t<h2><Badge color=\"dark\">BPM: {this.props.currentBpm}</Badge></h2>\r\n\t\t\t\t{/* <div>Next step in {this.state.stepProgress.toFixed(1)} seconds</div> */}\r\n\t\t\t\t<SimpleProgress value={this.state.stepProgress * 100} />\r\n\r\n\t\t\t\t{/* <Button onClick={() => this.togglePause()}>\r\n\t\t\t\t\tisPaused:\r\n\t\t\t\t\t{this.state.isPaused === true ? \"paused\" : \"normal\"}\r\n\t\t\t\t</Button> */}\r\n\r\n\t\t\t\t<div style={this.props.lockBpm ? { opacity: 0.5 } : {}}>\r\n\t\t\t\t\t{this.state.bars.map(bar => this.barRender(bar))}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\tTotal time: {Utils.formatTime(this.state.totalPlanTime)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Planner;\r\n\r\nPlanner.defaultProps = {\r\n\tplayMode: playModes.BY_BAR,\r\n\tcurrentStep: 0,\r\n\tonStep: function(step) {}\r\n};\r\n","import React from \"react\";\r\nimport Slider from \"rc-slider\";\r\nimport { Badge  } from \"reactstrap\";\r\n// import {Container, Row, Col} from 'reactstrap'\r\n\r\nclass AdvancedSlider extends Slider {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Badge\r\n\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\t// onClick={this.onBadgeClick}\r\n\t\t\t\t\t\tclassName=\"d-i\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{this.state.value}\r\n\t\t\t\t\t</Badge>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ height: \"30px\" }}>\r\n\t\t\t\t\t<div>{super.render()}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tonBadgeClick() {\r\n\t\t// TODO attach editorInPlace\r\n\t}\r\n}\r\n\r\nexport default AdvancedSlider;\r\n\r\n","import React, { Component } from \"react\";\r\n\r\nclass Accent extends Component {\r\n\tstate = {\r\n\t\tisCurrent: false\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className={\"Accent \" + (this.state.isCurrent === true ? \"active\" : \"\")}  onClick={this.props.onClick}>\r\n\t\t\t\t<div className={\"type\" + this.props.type}></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\ttoggleCurrent() {\r\n\t\tthis.setState({isCurrent: !this.state.isCurrent})\r\n\t}\r\n}\r\n\r\nexport default Accent;\r\n","import React, { Component } from \"react\";\r\nimport { accentTypesArr } from \"./AccentTypes\";\r\nimport Accent from \"./Accent\";\r\n\r\nclass BarManager extends Component {\r\n\tstate = {\r\n\t\tbars: []\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state.bars = props.defaultValue;\r\n\t}\r\n\r\n\tsetAccents(accents, beatsPerStep) {\r\n\t\tthis.setState({ bars: accents }, this.props.onAfterChange);\r\n\t}\r\n\r\n\thandleCellClick(selected) {\r\n\t\tlet newBars = [...this.state.bars];\r\n\t\t\r\n\t\tconst type = newBars[selected];\r\n\t\t// set new type\r\n\t\tnewBars[selected] = accentTypesArr[(type + 1) % 3];;\r\n\t\t\r\n\t\tthis.setState({bars: newBars}, this.props.onAfterChange)\r\n\t}\r\n\r\n\tgetAccents() {\r\n\t\treturn this.state.bars;\r\n\t}\r\n\r\n\tsetActive(idx) {\r\n\t\t// unselect previous element\r\n\t\tif (this.lastActiveAccent) {\r\n\t\t\tthis.lastActiveAccent.toggleCurrent();\r\n\t\t\tthis.lastActiveAccent = undefined\r\n\t\t}\r\n\t\t// select new \r\n\t\tconst el = this.refs[\"accent\" + idx];\r\n\r\n\t\t// make sure it exits though\r\n\t\tif (el) {\r\n\t\t\tel.toggleCurrent();\r\n\t\t\tthis.lastActiveAccent = el;\r\n\t\t}\r\n\t}\r\n \r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t{this.state.bars.map((bar, idx) => (\r\n\t\t\t\t\t<Accent ref={\"accent\" + idx}\r\n\t\t\t\t\t\tkey={\"accent\" + idx}\r\n\t\t\t\t\t\ttype={bar}\r\n\t\t\t\t\t\tonClick={() => this.handleCellClick(idx)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t))}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default BarManager;\r\n","import React, { Component } from \"react\";\r\nimport {\r\n\tInput,\r\n\tButton,\r\n\tModal,\r\n\tModalHeader,\r\n\tModalBody,\r\n\tModalFooter\r\n} from \"reactstrap\";\r\n\r\nclass EditPresetModal extends Component {\r\n\tstate = {\r\n\t\tmodal: false,\r\n\t\tpreset: null,\r\n\t\tshowDelete: false\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tmodal: false\r\n\t\t};\r\n\t\tthis.toggle = this.toggle.bind(this);\r\n\t}\r\n\r\n\ttoggle() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tmodal: !prevState.modal\r\n\t\t}));\r\n\t}\r\n\r\n\thandleSave() {\r\n\t\tconst preset = this.state.preset;\r\n\t\tconst title = this.state.preset.title;\r\n\t\tif (title && title.length > 0) {\r\n\t\t\tthis.props.onSave(title, preset);\r\n\t\t\tthis.toggle();\r\n\t\t}\r\n\t}\r\n\r\n\tedit(preset, showDelete) {\r\n\t\tthis.setState(\r\n\t\t\t{\r\n\t\t\t\tpreset: preset,\r\n\t\t\t\tshowDelete: showDelete\r\n\t\t\t},\r\n\t\t\tthis.toggle\r\n\t\t);\r\n\t}\r\n\r\n\ttitleChanged(e) {\r\n\t\tconst newTitle = e.target.value;\r\n\t\tlet preset = { ...this.state.preset };\r\n\t\tpreset.title = newTitle;\r\n\t\tthis.setState({ preset });\r\n\t\t// this.setState()\r\n\t\t// this.setState({title: e.target.value}\r\n\t}\r\n\r\n\tonDeleteBtn() {\r\n\t\tthis.props.onDeleteBtn(this.state.preset);\r\n\t\tthis.toggle();\r\n\t}\r\n\r\n\trenderDelete() {\r\n\t\t \r\n\t\tif (this.state.showDelete === true) {\r\n\t\t\treturn(<Button color=\"warning\" onClick={() => this.onDeleteBtn()}>\r\n\t\t\t\tDelete\r\n\t\t\t\t</Button>\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tstyle={{marginTop: '0.5em'}}\r\n\t\t\t\t\toutline\r\n\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\tonClick={this.props.onSaveBtn}\r\n\t\t\t\t>\r\n\t\t\t\t\tSave current settings\r\n\t\t\t\t</Button>\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tisOpen={this.state.modal}\r\n\t\t\t\t\ttoggle={this.toggle}\r\n\t\t\t\t\tclassName={this.props.className}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ModalHeader toggle={this.toggle}>Save Preset</ModalHeader>\r\n\t\t\t\t\t<ModalBody>\r\n\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\tonChange={e => this.titleChanged(e)}\r\n\t\t\t\t\t\t\tdefaultValue={\r\n\t\t\t\t\t\t\t\t(this.state.preset &&\r\n\t\t\t\t\t\t\t\t\tthis.state.preset.title) ||\r\n\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<div className=\"code\">\r\n\t\t\t\t\t\t\t{JSON.stringify(this.state.preset)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</ModalBody>\r\n\t\t\t\t\t<ModalFooter>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\tonClick={() => this.handleSave()}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tSave\r\n\t\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t\t<Button color=\"secondary\" onClick={this.toggle}>\r\n\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t{this.renderDelete()}\r\n\t\t\t\t\t</ModalFooter>\r\n\t\t\t\t</Modal>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default EditPresetModal;\r\n\r\n\r\nEditPresetModal.defaultProps = {\r\n\tonDeleteBtn: function(preset) {},\r\n\tonSave: function(title, preset) {},\r\n\tonSaveBtn: function(e, idx) {}\r\n };\r\n","import React, { Component } from \"react\";\r\nimport {Container, Row, Col } from \"reactstrap\";\r\nimport EditPresetModal from \"./EditPresetModal\"\r\n\r\nclass PresetsManager extends Component {\r\n\tstate = {\r\n\t\tshowDelete: [],\r\n\t\tshowEdit: []\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.userPresets = this.props.cookies.get('userPresets');\r\n\t\t\r\n\t\tthis.state.showDelete = this.userPresets ? Array(this.userPresets.length).fill(false) : []\r\n\t\tthis.state.showEdit = this.userPresets ? Array(this.userPresets.length).fill(false) : []\r\n\t}\r\n\t\r\n\tonPresetClick(preset) {\r\n\t\tthis.props.onSelect(preset);\r\n\t}\r\n\r\n\tonSavePreset(title, o) {\r\n\t\tconst preset = {title: title, ...o}\r\n\t\t\r\n\t\tlet userPresets = this.props.cookies.get('userPresets');\r\n\r\n\t\tif (!userPresets) {\r\n\t\t\tuserPresets = [];\r\n\t\t}\r\n\t\t\r\n\t\t// overwrite by title \r\n\t\tlet idx = -1;\r\n\r\n\t\tfor (let i = 0 ; i < userPresets.length; i++) {\r\n\t\t\tif (userPresets[i].title.toLowerCase() === title.toLowerCase()) {\r\n\t\t\t\tidx = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (idx < 0) {\r\n\t\t\tuserPresets.push(preset)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tuserPresets[idx] = preset;\r\n\t\t}\r\n\r\n\t\tthis.saveInCookie(userPresets);\r\n\t}\r\n\r\n\tsaveInCookie(presets) {\r\n\t\tthis.props.cookies.set('userPresets', JSON.stringify(presets),{ path: '/' });\r\n\t\tthis.userPresets = presets;\r\n\t}\r\n\r\n\tshowDeleteBtn(e, idx) {\r\n\t\tlet showDelete = {...this.state};\r\n\t\tshowDelete[idx] = true;\r\n\t\tthis.setState({showDelete});\r\n\t}\r\n\r\n\tshowEditBtn(e, idx) {\r\n\t\tlet showEdit = {...this.state};\r\n\t\tshowEdit[idx] = true;\r\n\t\tthis.setState({showEdit});\r\n\t}\r\n\thideEditBtn(e) {\r\n\t\tthis.setState({showEdit: false})\r\n\t}\r\n\r\n\tonPresetDelete(preset) {\r\n\t\tlet idx = this.userPresets.indexOf(preset) \r\n\t\tif (idx < 0) {\r\n\t\t\tthrow new Error(\"Selected preset \" +  preset.title + \" has not been found in the store\" )\r\n\t\t}\r\n\t\tthis.userPresets.splice(idx,1);\r\n\t\tthis.saveInCookie(this.userPresets);\r\n\t}\r\n\r\n\tonPresetEdit(e, idx) {\r\n\t\t// console.log('preset EDIT',e,idx);\r\n\t\t/// prevent from triggerring onClick \r\n\t\te.stopPropagation()\r\n\t\t\r\n\r\n\t\tif (idx !== undefined) {\r\n\t\t\tthis.refs.presetEditor.edit(this.userPresets[idx], true)\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// new preset\r\n\t\t\tvar p = this.props.getPreset();\r\n\t\t\tthis.refs.presetEditor.edit(p)\r\n\t\t}\r\n\t}\r\n\r\n\tsetPreset(preset) {\r\n\t\t\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst userPresets = this.props.cookies.cookies.userPresets ?  JSON.parse(  this.props.cookies.cookies.userPresets ) : [];\r\n\t\t// // console.log('<PresetsManager>userPresets', userPresets)\r\n\t\treturn (\r\n\t\t\t<Container className=\"PresetsManager\">\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t{this.props.presets.map((item, idx) => (\t\t\t\t\t\t\r\n\t\t\t\t\t\t<Col className=\"preset\" hidden={item.isHidden}\r\n\t\t\t\t\t\t\tonClick={() => this.onPresetClick(item)}\r\n\t\t\t\t\t\t\tkey={\"preset_\" + idx}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{item.title}\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Row>\r\n\t\t\t\t<Row>\r\n\t\t\t\t\tSaved presets:\r\n\t\t\t\t</Row>\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t{userPresets.map((item, idx) => (\r\n\t\t\t\t\t\t<Col className=\"preset\"\r\n\t\t\t\t\t\t\tonMouseEnter={(e) => this.showEditBtn(e, idx)}\r\n\t\t\t\t\t\t\tonMouseLeave={(e) => this.hideEditBtn(e, idx)}\r\n\t\t\t\t\t\t\tonClick={() => this.onPresetClick(item)}\r\n\t\t\t\t\t\t\tkey={\"preset_\" + idx}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{item.title}\r\n\t\t\t\t\t\t\t<div className='x' style={{visibility: this.state.showEdit[idx] ? '' : 'hidden'}} onClick={(e) => this.onPresetEdit(e,idx)}>Edit</div>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Row>\r\n\t\t\t\t<Row>\t\t\t\t\t\r\n\t\t\t\t\t<EditPresetModal ref='presetEditor' onDeleteBtn={(preset) => this.onPresetDelete(preset)} onSaveBtn={(e,idx) => this.onPresetEdit(e,idx)} onSave={(title, preset) => this.onSavePreset(title, preset)}/>\r\n\t\t\t\t</Row>\r\n\t\t\t</Container>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default PresetsManager;\r\n\r\nPresetsManager.defaultProps = {\r\n\tonSelect: function(preset) {}\r\n };","import React, { Component } from 'react';\r\nimport {Container, Row} from 'reactstrap'\r\n\r\nclass SimplePanel extends Component {\r\n    render() { \r\n        return (\r\n            <Container className={\"pane \" + this.props.className}>\r\n\t\t\t\t<Row className=\"pane-title\">{this.props.title}</Row>\r\n\t\t\t\t<Row className=\"pane-body\">{this.props.children}</Row>\r\n            </Container>\r\n            );\r\n    }\r\n}\r\n \r\nexport default SimplePanel;\r\n\r\n\r\nSimplePanel.defaultProps = {\r\n    title: 'title',\r\n    children: [],\r\n    className: ''\r\n };","export const playbackModes = {\r\n\tSTOP: \"stop\",\r\n\tCYCLE: \"cycle\",\r\n\tREPEAT: \"repeat\",\r\n\tCONTINUE: \"continue\"\r\n};","import React, { Component } from 'react';\r\nimport Slider from 'rc-slider'\r\nimport regression from 'regression';\r\nimport {Badge} from 'reactstrap'\r\n\r\n\r\nclass GeometricSlider extends Component {\r\n\tstate = {\r\n        value: undefined,\r\n        regression: undefined\r\n\t};\r\n\r\n    constructor(props) {\r\n        // TOneverDo \r\n        // currently it works only for min=1 only\r\n        super(props);\r\n        \r\n        const d = [[0,this.props.min],  [100, this.props.max]];\r\n        \r\n        this.state.regression = regression.exponential(d, {precision : 10 })\r\n        // console.log('slider func', this.state.regression.string)\r\n\r\n        this.prepareMarks();\r\n\r\n        this.state.value = this.props.defaultValue;\r\n        \r\n    }\r\n\r\n    prepareMarks() {\r\n        this.marks = {};\r\n        \r\n        for (let i = 0; i < this.props.marksAt.length; i++) {\r\n            this.marks[  this.findX(this.props.marksAt[i]) ]  = this.props.marksAt[i];\r\n        }\r\n    }\r\n\r\n    makeMark(value) {\r\n        return {\r\n            label: this.props.markFormatter(\r\n                Math.floor(value)\r\n            ),\r\n            style: this.props.marksStyle\r\n        };\r\n    }\r\n\r\n    onChange(v) {\r\n        // console.log('onChange', v)\r\n        const value =  Math.floor(this.state.regression.predict(v)[1]);\r\n        this.setState({value: value})\r\n        this.props.onChange(value)\r\n    }\r\n \r\n    findX(y) {\r\n        // y = e^bx ==> x = ln(y) / b\r\n        return Math.log(y)/this.state.regression.equation[1];\r\n    }\r\n    \r\n    setValue(v) {\r\n        this.setState({value: v})\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <>\r\n            \t<div>\r\n\t\t\t\t\t<Badge  color=\"light\" onClick={this.onBadgeClick} className=\"d-i\">\r\n                        {this.props.badgeFormatter(this.state.value)}\r\n\t\t\t\t\t</Badge>\r\n\t\t\t\t</div>\r\n                <Slider ref=\"slider\" included={false} value={this.findX(this.state.value)} style={{height: '45px'}} onChange={(v) => this.onChange(v)} min={0} max={100} step={0.5} marks={this.marks}/>\r\n            </>\r\n        )\r\n\r\n    }\r\n    \r\n}\r\n \r\nexport default GeometricSlider;\r\n\r\nGeometricSlider.defaultProps = {\r\n    marksNum: 6,\r\n    marksStyle: {\r\n        color: '#ccc'\r\n    },\r\n    desc: '',\r\n    badgeFormatter: function(v) {return v;},\r\n    markFormatter: function(v) {return v;},\r\n    defaultValue: 50,\r\n    marksAt: []\r\n}","import React from \"react\";\r\nimport { Range } from \"rc-slider\";\r\nimport { Badge } from \"reactstrap\";\r\n\r\nclass AdvancedRange extends Range {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Badge\r\n\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\t// onClick={this.onBadgeClick}\r\n\t\t\t\t\t\tclassName=\"d-i\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{this.state.bounds[0]} - {this.state.bounds[1]}\r\n\t\t\t\t\t</Badge>\r\n\t\t\t\t</div>\r\n                <div style={{ height: \"30px\" }}>\r\n                {super.render()}\r\n                </div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default AdvancedRange;\r\n","import React, { Component } from \"react\";\r\nimport SimplePanel from \"./SimplePanel\";\r\nimport {\r\n\tButtonGroup,\r\n\tButton,\r\n\tCollapse,\r\n\tButtonDropdown,\r\n\tDropdownToggle,\r\n\tDropdownItem,\r\n\tDropdownMenu\r\n} from \"reactstrap\";\r\nimport { playModes } from \"./PlayModes\";\r\nimport { playbackModes } from \"./PlaybackModes\";\r\nimport GeometricSlider from \"./GeometricSlider\";\r\nimport AdvancedRange from \"./AdvancedRange\"\r\nimport AdvancedSlider from \"./AdvancedSlider\"\r\nimport Utils from \"./Utils\";\r\n\r\nclass ModePanel extends Component {\r\n\tstate = {\r\n\t\tplaybackMode: playbackModes.STOP,\r\n\t\tplayMode: playModes.BY_TIME,\r\n\t\tbpmStep: 10,\r\n\t\tbpmStepDropdownOpen: false,\r\n\t\tbyTimeInterval: 5,\r\n\t\tbyBarInterval: 2,\r\n\t\tstableBpmSlider: 300,\r\n\t\tbpmRange: [100, 250]\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state.playMode = props.playMode;\r\n\t\tif (props.playMode === playModes.BY_BAR) {\r\n\t\t\tthis.state.byBarInterval = props.interval;\r\n\t\t} else {\r\n\t\t\tthis.state.byTimeInterval = props.interval;\r\n\t\t}\r\n\t\tthis.state.bpmStep = props.bpmStep;\r\n\t\tthis.state.bpmRange = props.bpmRange;\r\n\t\t// console.log('<ModePanel> constructor')\r\n\t}\r\n\r\n\tonModeChange(newMode) {\r\n\t\tthis.setState({ playMode: newMode }, this.props.onAfterChange);\r\n\t}\r\n\r\n\r\n\tonBpmRangeChange(bpmRange) {\r\n\t\t// console.log('<ModePanel>onBpmRangeChange(' + bpmRange[0] + ')')\r\n\t\tthis.setState({ bpmRange: bpmRange }, this.props.onAfterChange);\r\n\t}\r\n\r\n\tonBpmSliderChange = (value) => {\r\n\t\t// console.log('onBpmSliderChange', value)\r\n\t\tthis.setState({ stableBpmSlider: value }, this.props.onAfterChange);\r\n\t}\r\n\r\n\tonBpmStepChange() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tbpmStepDropdownOpen: !prevState.bpmStepDropdownOpen\r\n\t\t}));\r\n\t}\r\n\r\n\tonBpmStepSelect(value) {\r\n\t\tthis.setState({ bpmStep: value }, this.props.onAfterChange);\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\t// console.log('getValue', this.state.playbackMode)\r\n\r\n\t\tconst o = {\r\n\t\t\tplayMode: this.state.playMode,\r\n\t\t\tplaybackMode: this.state.playbackMode,\r\n\t\t\tinterval:\r\n\t\t\t\tthis.state.playMode === playModes.BY_BAR\r\n\t\t\t\t\t? this.state.byBarInterval\r\n\t\t\t\t\t: this.state.byTimeInterval,\r\n\t\t\tbpmStep: this.state.bpmStep,\r\n\t\t\tbpmRange: this.state.playMode !== playModes.STABLE ? this.state.bpmRange : this.props.bpmRange,//this.refs.bpmRange.getValue() : null,\r\n\t\t\tstableBpmSlider: this.state.stableBpmSlider\r\n\t\t};\r\n\t\t// debugger\r\n\t\treturn o;\r\n\t}\r\n\r\n\tsetValue(o) {\r\n\t\t// console.log(\"<ModePanel>setValue\", o)\r\n\t\tthis.setState(\r\n\t\t\t{\r\n\t\t\t\tplayMode: o.playMode,\r\n\t\t\t\tplayBackMode: o.playBackMode || this.state.playBackMode,\r\n\t\t\t\tbpmStep: o.bpmStep,\r\n\t\t\t\tbyBarInterval:\r\n\t\t\t\t\to.playMode === playModes.BY_BAR\r\n\t\t\t\t\t\t? o.interval\r\n\t\t\t\t\t\t: this.state.byBarInterval,\r\n\t\t\t\tbyTimeInterval:\r\n\t\t\t\t\to.playMode === playModes.BY_TIME\r\n\t\t\t\t\t\t? o.interval\r\n\t\t\t\t\t\t: this.state.byTimeInterval,\r\n\t\t\t\tbpmRange: o.bpmRange,\r\n\t\t\t\tstableBpmSlider: o.stableBpmSlider || this.state.stableBpmSlider\r\n\t\t\t},\r\n\t\t\tthis.props.onAfterChange\r\n\t\t);\r\n\r\n\r\n\t\tconst slider =\r\n\t\t\to.playMode === playModes.BY_BAR\r\n\t\t\t\t? this.refs.byBarSlider\r\n\t\t\t\t: this.refs.byTimeSlider;\r\n\t\tslider.setValue(o.interval);\r\n\r\n\t\tthis.refs.bpmRange.setState({ bounds: o.bpmRange })\r\n\t}\r\n\r\n\tonTimeIntervalChange(v) {\r\n\t\tthis.setState({ byTimeInterval: v }, this.props.onAfterChange);\r\n\t}\r\n\r\n\tonBarIntervalChange(v) {\r\n\t\tthis.setState({ byBarInterval: v }, this.props.onAfterChange);\r\n\t}\r\n\r\n\tbyBarFormatter(barsNum) {\r\n\t\tlet s = barsNum + \" \";\r\n\t\tif (barsNum === 1) {\r\n\t\t\ts += \"bar\";\r\n\t\t} else {\r\n\t\t\ts += \"bars\";\r\n\t\t}\r\n\t\treturn s;\r\n\t}\r\n\r\n\tbyTimeFormatter(time) {\r\n\t\tlet s = Utils.formatTime(time) + \" \";\r\n\r\n\t\tif (time === 1) {\r\n\t\t\ts += \"second\";\r\n\t\t} else if (time < 60) {\r\n\t\t\ts += \"seconds\";\r\n\t\t} else if (time < 120) {\r\n\t\t\ts += \"minute\";\r\n\t\t} else {\r\n\t\t\ts += \"minutes\";\r\n\t\t}\r\n\t\treturn s;\r\n\t}\r\n\r\n\tonPlaybackChange(newPlaybackMode) {\r\n\t\tthis.setState({ playbackMode: newPlaybackMode });\r\n\t}\r\n\r\n\trenderIncreaseBpmDropdown() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\tincrease speed by\r\n\t\t\t\t<ButtonDropdown\r\n\t\t\t\t\tstyle={{ margin: \"0px 5px\" }}\r\n\t\t\t\t\tisOpen={this.state.bpmStepDropdownOpen}\r\n\t\t\t\t\ttoggle={() => this.onBpmStepChange()}\r\n\t\t\t\t>\r\n\t\t\t\t\t<DropdownToggle caret size=\"sm\" outline color=\"light\">\r\n\t\t\t\t\t\t{this.state.bpmStep}\r\n\t\t\t\t\t</DropdownToggle>\r\n\t\t\t\t\t<DropdownMenu>\r\n\t\t\t\t\t\t<DropdownItem\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.onBpmStepSelect(5);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t5\r\n\t\t\t\t\t\t</DropdownItem>\r\n\t\t\t\t\t\t<DropdownItem\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.onBpmStepSelect(10);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t10\r\n\t\t\t\t\t\t</DropdownItem>\r\n\t\t\t\t\t\t<DropdownItem\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.onBpmStepSelect(20);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t20\r\n\t\t\t\t\t\t</DropdownItem>\r\n\t\t\t\t\t\t<DropdownItem\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.onBpmStepSelect(30);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t30\r\n\t\t\t\t\t\t</DropdownItem>\r\n\t\t\t\t\t\t<DropdownItem\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.onBpmStepSelect(50);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t50\r\n\t\t\t\t\t\t</DropdownItem>\r\n\t\t\t\t\t</DropdownMenu>\r\n\t\t\t\t</ButtonDropdown>\r\n\t\t\t\tbpm\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\trenderSpeedRange() {\r\n\r\n\t\t// console.log('renderSpeedRange', this.state.bpmRange[0])\r\n\t\treturn (<div>\r\n\t\t\tSpeed range\r\n\t\t\t<AdvancedRange\r\n\t\t\t\tref=\"bpmRange\"\r\n\t\t\t\tmin={30}\r\n\t\t\t\tmax={600}\r\n\t\t\t\tdefaultValue={[\r\n\t\t\t\t\tthis.state.bpmRange[0],\r\n\t\t\t\t\tthis.state.bpmRange[1]\r\n\t\t\t\t]}\r\n\t\t\t\tpushable={true}\r\n\t\t\t\tonAfterChange={(value) => this.onBpmRangeChange(value)}\r\n\t\t\t/>\r\n\t\t</div>);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SimplePanel className=\"ModePanel\" title=\"Mode\">\r\n\t\t\t\t<ButtonGroup size=\"sm\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\toutline\r\n\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\tonClick={() => this.onModeChange(playModes.BY_BAR)}\r\n\t\t\t\t\t\tactive={this.state.playMode === playModes.BY_BAR}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tBy bar\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\toutline\r\n\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\tonClick={() => this.onModeChange(playModes.BY_TIME)}\r\n\t\t\t\t\t\tactive={this.state.playMode === playModes.BY_TIME}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tBy time\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\toutline\r\n\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\tonClick={() => this.onModeChange(playModes.STABLE)}\r\n\t\t\t\t\t\tactive={this.state.playMode === playModes.STABLE}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tStable\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</ButtonGroup>\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode !== playModes.STABLE}>\r\n\t\t\t\t\t{/* {this.state.playMode !== playModes.STABLE ? this.renderSpeedRange() : ''} */}\r\n\t\t\t\t\t{this.renderSpeedRange()}\r\n\t\t\t\t</Collapse>\r\n\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode === playModes.BY_BAR}>\r\n\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\tIncrease speed every\r\n\t\t\t\t\t\t<GeometricSlider\r\n\t\t\t\t\t\t\tref=\"byBarSlider\"\r\n\t\t\t\t\t\t\tdefaultValue={this.state.byBarInterval}\r\n\t\t\t\t\t\t\tbadgeFormatter={this.byBarFormatter}\r\n\t\t\t\t\t\t\tonChange={v => this.onBarIntervalChange(v)}\r\n\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\tmax={301}\r\n\t\t\t\t\t\t\tmarksAt={[1, 2, 5, 10, 20, 50, 100, 300]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Collapse>\r\n\t\t\t\t<Collapse isOpen={this.state.playMode === playModes.BY_TIME}>\r\n\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\tIncrease speed every\r\n\t\t\t\t\t\t<GeometricSlider\r\n\t\t\t\t\t\t\tref=\"byTimeSlider\"\r\n\t\t\t\t\t\t\tdefaultValue={this.state.byTimeInterval}\r\n\t\t\t\t\t\t\tbadgeFormatter={this.byTimeFormatter}\r\n\t\t\t\t\t\t\tmarkFormatter={Utils.formatTime}\r\n\t\t\t\t\t\t\tonChange={v => this.onTimeIntervalChange(v)}\r\n\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\tmax={600}\r\n\t\t\t\t\t\t\tmarksAt={[1, 2, 5, 10, 30, 60, 120, 240, 600]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Collapse>\r\n\t\t\t\t{this.state.playMode !== playModes.STABLE ? this.renderIncreaseBpmDropdown() : ''}\r\n\t\t\t\t<Collapse isOpen={this.state.playMode === playModes.STABLE}>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\tChoose bpm\r\n\r\n\t\t\t\t\t\t<AdvancedSlider\r\n\t\t\t\t\t\t\tref=\"stableBpmSlider\"\r\n\t\t\t\t\t\t\tincluded={false}\r\n\t\t\t\t\t\t\tmin={10}\r\n\t\t\t\t\t\t\tmax={600}\r\n\t\t\t\t\t\t\tmarks={{ 30: '30', 100: '100', 200: '200', 300: '300', 400: '400', 500: '500', 600: '600' }}\r\n\t\t\t\t\t\t\tvalue={this.state.stableBpmSlider}\r\n\t\t\t\t\t\t\tonChange={this.onBpmSliderChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Collapse>\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode !== playModes.STABLE}>\r\n\t\t\t\t\t<div>After plan</div>\r\n\t\t\t\t\t<ButtonGroup size=\"sm\">\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\t\tonClick={() => this.onPlaybackChange(playbackModes.STOP)}\r\n\t\t\t\t\t\t\tactive={this.state.playbackMode === playbackModes.STOP}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tStop\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\t\tonClick={() => this.onPlaybackChange(playbackModes.CYCLE)}\r\n\t\t\t\t\t\t\tactive={this.state.playbackMode === playbackModes.CYCLE}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tCycle back\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\t\tonClick={() => this.onPlaybackChange(playbackModes.CONTINUE)}\r\n\t\t\t\t\t\t\tactive={this.state.playbackMode === playbackModes.CONTINUE}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tLast speed\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\t\tonClick={() => this.onPlaybackChange(playbackModes.REPEAT)}\r\n\t\t\t\t\t\t\tactive={this.state.playbackMode === playbackModes.REPEAT}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tStart over\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t</Collapse>\r\n\t\t\t</SimplePanel>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default ModePanel;\r\n\r\nModePanel.defaultProps = {\r\n\tonAfterChange: null\r\n};\r\n","import {playModes} from \"./PlayModes\"\r\nimport {playbackModes} from \"./PlaybackModes\"\r\nimport { instruments } from \"./InstrumentLib\";\r\n\r\n\r\nexport const PresetsLib = [\r\n    {\r\n        title: \"4 beats every 4 bars\",\r\n        beatsPerStep: 4,\r\n        playMode: playModes.BY_BAR,\r\n        interval: 4,\r\n        bpmStep: 20,\r\n        bpmRange: [100, 400],\r\n        accents: [0, 1, 2, 1]\r\n    },\r\n    {\r\n        title: \"Jhaptal tabla\",\r\n        instrument: instruments.TABLA,\r\n\t\tbeatsPerStep: 10,\r\n\t\tbpmRange: [200, 400],\r\n        accents: [0, 1, 0, 0, 1, 2, 1, 0, 0, 1 ],\r\n        playMode: playModes.BY_TIME,\r\n        interval: 5*60,\r\n        bpmStep: 10\r\n    },\r\n    {title: \"Balkan 1\", \"bpmRange\":[241,400],\"beatsPerStep\":7,\"accents\":[0,1,2,0,1,2,1],\"instrument\":\"electrokit\",\"playMode\":\"by_bar\",\"interval\":20,\"bpmStep\":30},\r\n    {title: \"Balkan 2\", \"bpmRange\":[293,400],\"beatsPerStep\":7,\"accents\":[0,1,2,0,1,2,1],\"instrument\":\"tabla\",\"playMode\":\"by_bar\",\"interval\":300,\"bpmStep\":50},\r\n    {title: \"Groove 1\", \"bpmRange\":[222,262],\"beatsPerStep\":8,\"accents\":[0,2,1,2,1,0,1,1],\"instrument\":\"electrokit\",\"playMode\":\"by_time\",\"interval\":600,\"bpmStep\":50},\r\n    {title: \"Groove 2\", \"bpmRange\":[222,400],\"beatsPerStep\":8,\"accents\":[0,2,0,2,2,2,0,1],\"instrument\":\"electrokit\",\"playMode\":\"by_bar\",\"interval\":20,\"bpmStep\":50},\r\n\r\n\r\n];\r\n\r\nexport const InitPreset = {\r\n    title: \"INIT\",\r\n    instrument: instruments.TABLA,\r\n    beatsPerStep: 4,\r\n    bpmRange: [300, 400],\r\n    accents: [1, 0, 0, 0],\r\n    playMode: playModes.BY_TIME,\r\n    playbackMode: playbackModes.STOP,\r\n    interval: 10,\r\n    bpmStep: 50,\r\n    isHidden: true\r\n}","import React, { Component } from 'react';\r\n\r\nclass Vis extends Component {\r\n    state = {}\r\n    ctx;\r\n    width = 300;\r\n    height = 200;\r\n    values = [];\r\n\r\n    drawFFT(values) {\r\n        this.values = values;\r\n        this.redraw();\r\n    }\r\n\r\n    redraw() {\r\n        this.ctx = this.refs.canvas.getContext(\"2d\");\r\n        \r\n        // this.ctx.clearRect(0, 0,this.width,this.height);\r\n        // console.log('<Vis>redraw', this.width, this.height)\r\n        this.ctx.clearRect(0,0,this.width, this.height)\r\n        this.ctx.rect(0, 0, this.width, this.height);\r\n        // this.ctx.stroke();\r\n        \r\n        var max = -Infinity;\r\n        var min = Infinity;\r\n\r\n        if (this.values.length > 0) {\r\n            \r\n            const barWidth = this.width / (this.values.length+2);\r\n\r\n            // this.values store decibels for each freq in range [-140,0]\r\n            this.ctx.lineWidth = barWidth;\r\n            this.ctx.lineCap = \"round\";\r\n            for (let i = 0, len = this.values.length; i < len ; i++) {\r\n                // debugger\r\n                var x = (barWidth + 5)* i + barWidth / 2 ;\r\n                \r\n                var h = ((this.values[i] + 140) / 140) * this.height;\r\n\r\n\r\n                max = Math.max(max, this.values[i])\r\n                min = Math.min(min, this.values[i])\r\n                // this.ctx.fillStyle = \"rgba(255, 85, 85, \"+ (1 - i/(len+10)) + \")\";\r\n                // this.ctx.fillRect(x, this.height, barWidth, -h);\r\n                this.ctx.strokeStyle = \"rgba(255, 85, 85, \"+ (1 - i/(len+10)) + \")\";\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(x, this.height );\r\n                this.ctx.lineTo(x, this.height - h);\r\n                // this.ctx.lineTo(70, 100);\r\n                \r\n                this.ctx.stroke();\r\n                \r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    // drawBar(val) {\r\n    //     // if (val > 0) {\r\n    //         console.log('val',val)\r\n    //     // }\r\n    //     // this.ctx.clearRect(0, 0, this.width, this., canvasHeight);\r\n    //     var barWidth = this.width / val.size;\r\n    //     debugger\r\n    //     for (var i = 0, len = values.length; i < len; i++){\r\n    //         var x = canvasWidth * (i / len);\r\n    //         var y = (values[i] + 140) * 2;\r\n    //         fftContext.fillStyle = \"rgba(0, 0, 0, \" + i/len + \")\";\r\n    //         fftContext.fillRect(x, canvasHeight - y, barWidth, canvasHeight);\r\n    //     }\r\n    // }\r\n\r\n    componentDidMount() {\r\n        window.addEventListener(\"resize\", () => this.updateDimensions());\r\n        this.updateDimensions()\r\n        this.redraw();\r\n    }\r\n\r\n    updateDimensions() {\r\n        let { clientWidth } = this.refs.container;\r\n        \r\n        this.refs.canvas.width = clientWidth;\r\n        // this.refs.canvas.height = clientHeight\r\n\r\n        this.width = clientWidth;\r\n        // this.height = clientHeight;\r\n \r\n        this.redraw();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n                <div ref=\"container\">\r\n                    <canvas ref='canvas' height=\"200\"/>\r\n                </div>\r\n            \r\n        );\r\n    }\r\n}\r\n\r\nexport default Vis;","import React, { Component } from \"react\";\nimport \"./App.css\";\nimport \"./components/SoundMachine\";\nimport SoundMachine from \"./components/SoundMachine\";\nimport Planner from \"./components/Planner\";\nimport \"rc-slider/assets/index.css\";\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport { Container, Row, Col } from \"reactstrap\";\nimport {\n\tButtonDropdown,\n\tDropdownToggle,\n\tDropdownMenu,\n\tDropdownItem\n} from \"reactstrap\";\nimport AdvancedSlider from \"./components/AdvancedSlider\";\nimport BarManager from \"./components/BarManager\";\nimport { instruments } from \"./components/InstrumentLib\";\nimport PresetsManager from \"./components/PresetsManager\";\nimport ModePanel from \"./components/ModePanel\";\nimport { playModes } from \"./components/PlayModes\";\nimport { withCookies } from \"react-cookie\";\nimport { PresetsLib, InitPreset } from \"./components/PresetsLib\";\nimport { accentTypes } from \"./components/AccentTypes\";\nimport SimplePanel from \"./components/SimplePanel\";\nimport Vis from \"./components/Vis\"\nimport { playbackModes } from \"./components/PlaybackModes\";\n\nclass App extends Component {\n\tstate = {\n\t\tcurrentBpm: 60,\n\t\tinstrument: instruments.ELECTRO_KIT,\n\t\tinstrumentDropdownOpen: false,\n\t\tinstrumentDropdownLabel: \"Electro kit\", // bit messy, why would we hardcode this here, it ought to be taken from instrumentLib\n\t\tcycleDropdownOpen: false\n\t};\n\n\tplaybackDirection = true; // true => forward, false => backward\n\n\tcomponentDidMount() {\n\t\t// initialize accents\n\t\tthis.refs.sm.setAccents(this.refs.barManager.getAccents());\n\n\t\t// keyboard listeners\n\t\tdocument.addEventListener(\"keydown\", e => this.handleKeyDown(e));\n\n\t\t// initialize with UI settings\n\t\tthis.refs.planner.setPlan(this.getUiState());\n\n\t\t// this.refs.sm.setBpm(this.state.currentBpm)\n\t\t// this.initialized = true;\n\n\t\tthis.refs.sm.setVis(this.refs.vis)\n\t}\n\n\n\thandleKeyDown(e) {\n\t\t// console.log(\"key\", e);\n\t\tswitch (e.keyCode) {\n\t\t\tcase 32: // space\n\t\t\t\t// e.preventDefault();\n\t\t\t\tif (this.refs.sm.state.isPlaying) {\n\t\t\t\t\tthis.refs.planner.stepForward();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.refs.sm.handleStartStop();\n\t\t\t\t}\n\t\t\t\t// if (this.state.keysActive) {\n\t\t\t\t// \te.preventDefault();\n\t\t\t\t// }\n\n\t\t\t\tbreak;\n\t\t\tcase 38: // Arrow up\n\t\t\t\te.preventDefault();\n\t\t\t\tif (this.state.currentBpm < 600) {\n\t\t\t\t\tthis.setBpm(this.state.currentBpm + 10);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 40: // arrow down\n\t\t\t\te.preventDefault();\n\t\t\t\tif (this.state.currentBpm > 10) {\n\t\t\t\t\tthis.setBpm(this.state.currentBpm - 10);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 37: // Arrow left\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.refs.planner.stepBackward();\n\t\t\t\tbreak;\n\t\t\tcase 39: // Arrow right\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.refs.planner.stepForward();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\n\tonInstrumentSelect(newInstrument) {\n\t\tthis.refs.sm.setInstrument(newInstrument);\n\t\tconst label = this.refs.sm.getCurrentInstrumentLabel();\n\t\t// trigger storing current instrument. Bit clunky...\n\n\n\t\tthis.setState({\n\t\t\tinstrument: newInstrument,\n\t\t\tinstrumentDropdownLabel: label\n\t\t}, this.getUiState);\n\n\n\t}\n\n\n\t// TODO: make it automatic\n\trenderInstrumentsDropDown() {\n\t\treturn (<ButtonDropdown\n\t\t\tisOpen={this.state.instrumentDropdownOpen}\n\t\t\ttoggle={() => this.onInstrumentChange()}\n\t\t>\n\t\t\t<DropdownToggle\n\t\t\t\tcaret\n\t\t\t\tsize=\"sm\"\n\t\t\t\toutline\n\t\t\t\tcolor=\"light\"\n\t\t\t>\n\t\t\t\t{this.state.instrumentDropdownLabel}\n\t\t\t</DropdownToggle>\n\t\t\t<DropdownMenu>\n\t\t\t\t<DropdownItem\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tthis.onInstrumentSelect(\n\t\t\t\t\t\t\tinstruments.TABLA\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tTabla\n\t\t\t\t</DropdownItem>\n\t\t\t\t<DropdownItem\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tthis.onInstrumentSelect(\n\t\t\t\t\t\t\tinstruments.ELECTRO_KIT\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tElectro Kit\n\t\t\t\t</DropdownItem>\n\t\t\t\t<DropdownItem\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tthis.onInstrumentSelect(\n\t\t\t\t\t\t\tinstruments.METRONOME\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tMetronome\n\t\t\t\t</DropdownItem>\n\t\t\t</DropdownMenu>\n\t\t</ButtonDropdown>);\n\n\t}\n\trenderPlaybackPane() {\n\t\treturn (\n\t\t\t<Container className=\"pane\">\n\t\t\t\t<Row className=\"pane-title\">PLAYBACK</Row>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col xs=\"3\">Instrument</Col>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t{this.renderInstrumentsDropDown()}\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\t\t\t\t<Row>\n\t\t\t\t\t<Col xs={3}>Beats per step</Col>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<AdvancedSlider\n\t\t\t\t\t\t\tref=\"beatsPerStep\"\n\t\t\t\t\t\t\tmin={2}\n\t\t\t\t\t\t\tmax={16}\n\t\t\t\t\t\t\tdefaultValue={this.props.beatsPerStep}\n\t\t\t\t\t\t\tonAfterChange={() => this.onBeatsPerStepChange()}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\t\t\t\t<Row>\n\t\t\t\t\t<Col xs={3}>Accents</Col>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<BarManager\n\t\t\t\t\t\t\tonAfterChange={() => this.onAccentsChange()}\n\t\t\t\t\t\t\tref=\"barManager\"\n\t\t\t\t\t\t\tdefaultValue={this.props.accents}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\t\t\t\t{/* <Row>\n\t\t\t\t\t<Col xs=\"3\">Playback</Col>\n\t\t\t\t\t<Col>One Time/LoopBack/Repeat</Col>\n\t\t\t\t</Row> */}\n\t\t\t</Container>\n\t\t);\n\t}\n\n\tonModePanelChanged() {\n\t\t// console.log(\"<App>onModePanelChanged\")\n\t\tconst state = this.getUiState();\n\n\t\t// create new plan\n\t\tthis.refs.planner.setPlan(state);\n\t}\n\n\trenderBottomPane() {\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>{this.renderPresetsPane()}</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<SimplePanel title={\"Keyboard controls\"} className=\"about\">\n\t\t\t\t\t\t\t<div><code>up/down</code> - adjust tempo</div>\n\t\t\t\t\t\t\t<div><code>left/right</code> - previous/next step according to plan</div>\n\t\t\t\t\t\t\t<div><code>space</code> - start/next step</div>\n\t\t\t\t\t\t</SimplePanel>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\t\t\t\t<div className=\"footer\">\n\t\t\t\t\t<div>By using this site you agree to the use of cookies to store user defined presets.</div>\n\t\t\t\t\t<div>Created using React and <a href=\"https://tonejs.github.io/\" rel=\"noopener noreferrer\" target=\"_blank\">Tone.js</a>. Source code available <a  href=\"https://github.com/indiebubbler/metro\">here</a>. <br/>Contact dev at <a href=\"mailto:indiebubbler@gmail.com?subject=Feedback\">indiebubbler@gmail.com</a>.</div>\n\t\t\t\t</div>\n\t\t\t</Container>\n\n\t\t);\n\t}\n\n\tonProgress(progress) {\n\t\tthis.refs.planner.setProgress(progress)\n\t}\n\n\trenderLeftPane() {\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<SimplePanel title=\"Control\">\n\t\t\t\t\t\t\t<SoundMachine\n\t\t\t\t\t\t\t\tref=\"sm\"\n\t\t\t\t\t\t\t\tbeatsPerStep={this.state.beatsPerStep}\n\t\t\t\t\t\t\t\tonLoopEnd={() => this.onLoopEnd()}\n\t\t\t\t\t\t\t\tonBeat={beat => this.onBeat(beat)}\n\t\t\t\t\t\t\t\tinstrument={this.state.instrument}\n\t\t\t\t\t\t\t\t// onToggle={(state) => this.onSoundMachineToggle(state)}\n\t\t\t\t\t\t\t\tonProgress={(progress) => this.onProgress(progress)}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t</SimplePanel>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<ModePanel\n\t\t\t\t\t\t\tref=\"modePanel\"\n\t\t\t\t\t\t\tplayMode={this.props.playMode}\n\t\t\t\t\t\t\tinterval={this.props.interval}\n\t\t\t\t\t\t\tbpmStep={this.props.bpmStep}\n\t\t\t\t\t\t\tbpmRange={this.props.bpmRange}\n\t\t\t\t\t\t\t//bpmStableSlider={this.props.bpmStableSlider}\n\t\t\t\t\t\t\tcurrentBpm={this.state.currentBpm}\n\t\t\t\t\t\t\t// defaultValue={{playMode: this.props.playMode, interval: this.props.interval, bpmStep: this.props.bpmStep}}\n\t\t\t\t\t\t\tonAfterChange={() => this.onModePanelChanged()}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>{this.renderPlaybackPane()}</Col>\n\t\t\t\t</Row>\n\t\t\t\t{/* <Row>\n\t\t\t\t\t<Col>{this.renderCyclePane()}</Col>\n\t\t\t\t</Row> */}\n\t\t\t</Container>\n\t\t);\n\t}\n\n\trenderPresetsPane() {\n\t\treturn (\n\t\t\t<Container className=\"pane\">\n\t\t\t\t<Row className=\"pane-title\">Presets</Row>\n\t\t\t\t<PresetsManager\n\t\t\t\t\tref=\"presetsManager\"\n\t\t\t\t\tcookies={this.props.cookies}\n\t\t\t\t\tpresets={PresetsLib}\n\t\t\t\t\tgetPreset={() => this.getUiState()}\n\t\t\t\t\tonSelect={preset => this.onPresetSelect(preset)}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t);\n\t}\n\n\tonPresetSelect(preset) {\n\t\t// console.log(\"setting preset\", preset);\n\n\t\tthis.refs.beatsPerStep.setState({ value: preset.beatsPerStep });\n\n\t\tthis.refs.sm.setBeatsPerStep(preset.beatsPerStep);\n\n\t\tthis.onInstrumentSelect(preset.instrument || instruments.TABLA);\n\n\t\tthis.refs.barManager.setAccents(preset.accents, preset.beatsPerStep);\n\n\t\tthis.refs.modePanel.setValue(preset);\n\n\t}\n\n\trenderRightPane() {\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<SimplePanel title={\"Plan\"}>\n\t\t\t\t\t\t\t<Planner\n\t\t\t\t\t\t\t\tcurrentBpm={this.state.currentBpm}\n\t\t\t\t\t\t\t\t// onChange={() => this.onPlanChanged()}\n\t\t\t\t\t\t\t\tonStep={step => this.onPlanStep(step)}\n\t\t\t\t\t\t\t\tref=\"planner\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</SimplePanel>\n\n\n\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<SimplePanel title={\"Visualisation\"}>\n\t\t\t\t\t\t\t<Vis ref=\"vis\" />\n\t\t\t\t\t\t</SimplePanel>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\n\t\t\t</Container>\n\t\t);\n\t}\n\n\tonLoopEnd() {\n\n\t\tconst pm = this.refs.modePanel.state.playbackMode;\n\n\t\tswitch (pm) {\n\t\t\tcase playbackModes.CYCLE:\n\t\t\t\tif (this.refs.planner.isLastStep() || this.refs.planner.isFirstStep()) {\n\t\t\t\t\tthis.playbackDirection = !this.playbackDirection;\n\t\t\t\t}\n\t\t\t\tthis.playbackDirection === true ? this.refs.planner.stepForward() : this.refs.planner.stepBackward();\n\t\t\t\tbreak;\n\t\t\tcase playbackModes.REPEAT:\n\t\t\t\tif (this.refs.planner.isLastStep()) {\n\t\t\t\t\tthis.refs.planner.setStep(0)\n\t\t\t\t} else {\n\t\t\t\t\tthis.refs.planner.stepForward();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase playbackModes.CONTINUE:\n\t\t\t\tif (this.refs.planner.isLastStep()) {\n\t\t\t\t\tlet currentMode = this.refs.modePanel.getValue();\n\t\t\t\t\tcurrentMode.playMode = playModes.STABLE;\n\t\t\t\t\tcurrentMode.stableBpmSlider = this.state.currentBpm;\n\t\t\t\t\tthis.refs.modePanel.setValue(currentMode);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.refs.planner.stepForward();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase playbackModes.STOP:\n\t\t\t\tif (this.refs.planner.isLastStep()) {\n\t\t\t\t\tthis.refs.sm.handleStartStop();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.refs.planner.stepForward();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.refs.planner.stepForward();\n\t\t}\n\t}\n\n\tonBeat(idx) {\n\t\tthis.refs.barManager.setActive(idx);\n\t}\n\n\trender() {\n\t\t// set the title with current BPM\n\t\tdocument.title =\n\t\t\t\"BPM: \" + this.state.currentBpm.toFixed(0) + \" | SpeedTrainer\"\n\n\t\t// render everything else\n\t\treturn (\n\t\t\t<div className=\"App\">\n\n\t\t\t\t<Container className=\"app-container\">\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t{/* left pane with controls */}\n\t\t\t\t\t\t\t{this.renderLeftPane()}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col>{this.renderRightPane()}</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t{/* right pane with examples and plan*/}\n\t\t\t\t\t\t\t{this.renderBottomPane()}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tonBeatsPerStepChange = () => {\n\t\t// plan doesn't change here, just the beats per step amount\n\t\tconst newBps = this.getUiState().beatsPerStep;\n\n\t\tif (newBps !== this.refs.sm.beatsPerStep) {\n\t\t\tconst accents = this.refs.barManager.getAccents();\n\n\t\t\twhile (accents.length > newBps) {\n\t\t\t\taccents.pop();\n\t\t\t}\n\t\t\twhile (accents.length < newBps) {\n\t\t\t\taccents.push(accentTypes.ACCENT_2);\n\t\t\t}\n\n\t\t\tthis.refs.sm.setBeatsPerStep(newBps);\n\t\t\tthis.refs.barManager.setAccents(accents);\n\t\t\tthis.setState({ beatsPerStep: newBps });\n\t\t}\n\t};\n\n\tonPlanStep(step) {\n\t\t// console.log(\"<Apdiv>onPlanStep\", step)\n\t\t// this.setBpm(step.bpm);\n\n\t\tif (step) {\n\t\t\tthis.setState({ currentBpm: this.refs.sm.setStep(step) });\n\t\t}\n\t}\n\n\n\tsetBpm = newBpm => {\n\t\tthis.setState({ currentBpm: newBpm });\n\t\tthis.refs.sm.setBpm(newBpm);\n\t};\n\n\tonInstrumentChange() {\n\t\tthis.setState(prevState => ({\n\t\t\tinstrumentDropdownOpen: !prevState.instrumentDropdownOpen\n\t\t}));\n\n\t}\n\n\n\tgetUiState() {\n\n\t\tconst s1 = {\n\t\t\tbeatsPerStep: this.refs.beatsPerStep.getValue(),\n\t\t\taccents: this.refs.barManager.getAccents(),\n\t\t\tinstrument: this.state.instrument\n\t\t};\n\n\t\tconst s2 = this.refs.modePanel.getValue();\n\t\t// console.log('s2',s2.playbac)\n\t\tconst uiState = { ...s1, ...s2 };\n\n\t\t// console.log(\"storing uiState\", this.uiState);\n\t\tthis.uiState = uiState;\n\t\t// HACK\n\n\n\t\tthis.uiState.instrument = this.state.instrument;\n\t\t// console.log('uiState instrument',this.uiState.instrument)\n\t\treturn uiState;\n\t}\n\n\tonAccentsChange() {\n\t\tthis.refs.sm.setAccents(this.refs.barManager.getAccents());\n\t}\n}\n\nexport default withCookies(App);\n\n// this serves as default app settings\nApp.defaultProps = {\n\tplaybackMode: InitPreset.playbackMode,\n\tplayMode: InitPreset.playMode,// playModes.BY_BAR,\n\tinterval: InitPreset.interval,\n\tinstrument: InitPreset.instrument,\n\tbpmStep: InitPreset.bpmStep,\n\tbpmRange: InitPreset.bpmRange,\n\tbeatsPerStep: InitPreset.beatsPerStep,\n\taccents: InitPreset.accents\n};\n\n// App.defaultProps = {...App.defaultProps, InitPreset}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport {CookiesProvider} from 'react-cookie'\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(  <CookiesProvider> <App  /> </CookiesProvider> , document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();"],"sourceRoot":""}