(this.webpackJsonpmetro=this.webpackJsonpmetro||[]).push([[0],{104:function(e,t,a){e.exports=a(177)},109:function(e,t,a){},110:function(e,t,a){},177:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(16),i=a.n(s),o=(a(109),a(8)),l=a(9),c=a(12),p=a(7),u=a(13),m=(a(110),a(29)),h=a(21),d=a.n(h),y=a(178),v=a(179),b=a(186),f=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(y.a,{className:"pane "+this.props.className},r.a.createElement(v.a,{className:"pane-title"},this.props.title),r.a.createElement(v.a,{className:"pane-body"},this.props.children))}}]),t}(n.Component),g=f;f.defaultProps={title:"title",children:[],className:""};var k=a(97),S="by_bar",E="by_time",w="set_time",C="constant",M="stop",T="repeat",B="continue",O={TABLA:{key:"tabla",label:"Tabla"},ELECTRO_KIT:{key:"electrokit",label:"Electronic Kit"},METRONOME:{key:"metronome",label:"Metronome"},BASIC_DRUM_KIT:{key:"basicdrumkit",label:"Basic Drum Kit"},YAMAHA_RX5:{key:"yamaha_rx5",label:"Yamaha RX 5"}},I=[{file:"dha-slide.wav",label:"Dha",instrumentKey:"tabla"},{file:"dhin-slide.wav",label:"Dhin",instrumentKey:"tabla"},{file:"tin.wav",label:"Tin",instrumentKey:"tabla"},{file:"Kick.wav",label:"Kick",instrumentKey:"electrokit"},{file:"Snare.wav",label:"Snare",instrumentKey:"electrokit"},{file:"HiHat.wav",label:"Hi Hat",instrumentKey:"electrokit"},{file:"tap.wav",label:"Tap",instrumentKey:"metronome"},{file:"down.wav",label:"Down",instrumentKey:"metronome"},{file:"up.wav",label:"Up",instrumentKey:"metronome"},{file:"Kick.wav",label:"Kick",instrumentKey:"basicdrumkit"},{file:"Snare.wav",label:"Snare",instrumentKey:"basicdrumkit"},{file:"ClosedHat.wav",label:"Closed Hat",instrumentKey:"basicdrumkit"},{file:"OpenHat.wav",label:"Open Hat",instrumentKey:"basicdrumkit"},{file:"Kick.wav",label:"Kick",instrumentKey:"yamaha_rx5"},{file:"Rim.wav",label:"Rim",instrumentKey:"yamaha_rx5"},{file:"Ride.wav",label:"Ride",instrumentKey:"yamaha_rx5"},{file:"Cowbell.wav",label:"Cowbell",instrumentKey:"yamaha_rx5"},{file:"Shaker.wav",label:"Shaker",instrumentKey:"yamaha_rx5"}],P={};Object.keys(O).map((function(e,t){return P[O[e].key]=O[e],!0}));Object.keys(O).map((function(e){return O[e]}));var R,x=[{isHeader:!0,title:"Basic"},{title:"Metronome 2/4",bpmStep:20,bpmRange:[100,200],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:60,byBarInterval:2,constantBpmSlider:300,interval:300,track:[[2],[1]],instrumentKey:"metronome"},{title:"Metronome 4/4",instrumentKey:O.METRONOME.key,playMode:E,byTimeInterval:60,bpmStep:20,bpmRange:[100,200],track:[[2],[1],[1],[1]]},{title:"Metronome 3/4",instrumentKey:O.METRONOME.key,playMode:E,byTimeInterval:60,bpmStep:20,bpmRange:[100,200],track:[[2],[1],[1]]},{isHeader:!0,title:"Drum Patterns"},{title:"Levee Break",instrumentKey:"electrokit",bpmRange:[300,400],track:[[0,2],[0],[2],[],[1,2],[],[2],[0],[2],[],[0,2],[0],[1,2],[],[2],[]],playMode:S,playbackMode:M,byTimeInterval:5,byBarInterval:10,stepsNum:10,bpmStep:10,isHidden:!0},{bpmStep:10,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:10,constantBpmSlider:300,track:[[0,2],[],[0,2],[],[2,1],[],[0,2],[],[2,0],[],[2,0],[],[1,2],[],[2,0],[]],instrumentKey:"electrokit",title:"Basic Rock"},{bpmStep:10,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:10,constantBpmSlider:300,track:[[0,2],[],[2],[],[2,1],[],[2],[0,2],[2,0],[],[0,2],[],[1,2],[],[2,0],[]],instrumentKey:"electrokit",title:"Impeach the President"},{bpmStep:10,bpmRange:[350,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:60,byBarInterval:10,constantBpmSlider:300,track:[[0,2],[2],[0,2],[2],[2,1],[2],[0,2],[3,1],[2],[2,1],[0,2],[2,1],[2,1],[0,3],[2],[2,1]],instrumentKey:"basicdrumkit",title:"Funky Drummer"},{bpmStep:10,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:10,constantBpmSlider:300,track:[[0,2],[],[2],[],[1,2],[],[2],[0],[2,0],[],[0,2],[],[1,2],[],[2],[]],instrumentKey:"electrokit",title:"Walk This Way"},{bpmStep:10,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:10,constantBpmSlider:300,track:[[0,2],[],[2,0],[],[1,2],[],[2],[],[2],[],[0,2],[0],[1,2],[],[2],[0]],instrumentKey:"electrokit",title:"It's a New Day"},{bpmStep:10,bpmRange:[300,400],currentBpm:300,playbackMode:"stop",playMode:"by_bar",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:10,constantBpmSlider:300,track:[[0],[],[],[0],[1,2],[],[0],[],[0],[],[],[],[1,2],[],[],[]],instrumentKey:"electrokit",title:"The Big Beat"},{bpmStep:20,bpmRange:[300,500],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:50,constantBpmSlider:300,interval:120,track:[[0,2],[],[0,2],[],[1,2],[],[0,2],[],[0,2],[],[0,2],[],[1,2],[],[0,2],[]],instrumentKey:"basicdrumkit",title:"Rock"},{bpmStep:20,bpmRange:[528,600],currentBpm:300,playbackMode:"stop",playMode:"constant",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:50,constantBpmSlider:600,interval:120,track:[[0],[],[3],[],[1,0],[],[3],[],[0],[2],[3],[],[1,0],[],[0,3],[]],instrumentKey:"basicdrumkit",title:"Techno"},{bpmStep:20,bpmRange:[528,600],currentBpm:300,playbackMode:"stop",playMode:"constant",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:50,constantBpmSlider:400,interval:120,track:[[0,2],[],[2],[],[1,2],[],[2],[0],[2],[],[0,2],[],[1,2],[0],[2],[0]],instrumentKey:"basicdrumkit",title:"Hip Hop"},{isHeader:!0,title:"Afro-Cuban"},{bpmStep:20,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,interval:120,track:[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[1,2],[0,2],[0,2],[2],[1,2],[0,2],[1,2,0],[2],[2],[0,2]],instrumentKey:"yamaha_rx5",title:"Son Clave"},{bpmStep:20,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[2],[0,2,1],[0,2],[2],[2,1],[0,2],[2,0,1],[2],[2],[0,2]],instrumentKey:"yamaha_rx5",title:"Rumba"},{bpmStep:20,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[2,1],[0,2],[0,2],[2],[2,1],[0,2],[2,0],[2,1],[2],[0,2]],instrumentKey:"yamaha_rx5",title:"Bossa Nova"},{bpmStep:20,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,1,3],[],[],[1,3],[0],[],[1,3],[],[0,1],[3],[3],[1],[0],[],[0,1],[]],instrumentKey:"yamaha_rx5",title:"Soukous"},{bpmStep:20,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,3],[],[1],[1,3],[0],[],[1,3],[1],[0],[],[3,1],[1],[0],[],[0,1,3],[1]],instrumentKey:"yamaha_rx5",title:"Gahu"},{bpmStep:20,bpmRange:[400,600],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:120,byBarInterval:2,constantBpmSlider:300,track:[[0,3],[],[1],[1],[0,3],[],[1,3,0],[1],[0],[],[3,1],[1],[0,3],[],[0,1],[1]],instrumentKey:"yamaha_rx5",title:"Shiko"},{isHeader:!0,title:"Polyrhythms"},{title:"3 over 4",bpmStep:20,bpmRange:[100,200],currentBpm:100,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:60,constantBpmSlider:300,track:[[1,0,0,0],[0,1,1],[1,1,1,1],[0,0,0,0]],timeSignature:4,instrumentKey:"basicdrumkit"},{bpmStep:20,bpmRange:[100,200],currentBpm:300,playbackMode:"stop",playMode:"by_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:60,byBarInterval:2,constantBpmSlider:300,track:[[1,1,0],[0,0,1],[1,1,1,1],[0,0,0]],timeSignature:3,instrumentKey:"basicdrumkit",title:"4 over 3"},{bpmStep:20,bpmRange:[121,359],currentBpm:300,playbackMode:"stop",playMode:"set_time",stepsNum:10,exerciseTime:1800,bpmStepDropdownOpen:!1,byTimeInterval:60,byBarInterval:2,constantBpmSlider:122,track:[[1,0,1,0,1,0],[1,1,1,1],[1,1,1,1,1,1],[0,0,0,0,0,0]],timeSignature:6,instrumentKey:"basicdrumkit",title:"2 over 3"},{isHeader:!0,title:"Other"},{title:"Balkan 1",bpmRange:[241,400],accents:[0,2,1,0,2,1,2],instrument:O.ELECTRO_KIT,playMode:"by_bar",interval:20,bpmStep:30},{title:"Balkan 2",bpmRange:[293,400],accents:[0,1,2,0,1,2,1],instrument:O.TABLA,playMode:"by_bar",interval:300,bpmStep:30},{title:"Groove 1",bpmRange:[222,262],accents:[0,1,2,1,2,0,2,2],instrument:O.ELECTRO_KIT,playMode:"by_time",interval:600,bpmStep:30},{title:"Groove 2",bpmRange:[222,400],accents:[0,1,0,1,1,1,0,2],instrument:O.ELECTRO_KIT,playMode:"by_bar",interval:20,bpmStep:30}],j=(O.ELECTRO_KIT.key,{bpmStep:50,bpmRange:[300,400],playbackMode:"stop",playMode:"constant",stepsNum:10,exerciseTime:600,bpmStepDropdownOpen:!1,byTimeInterval:5,byBarInterval:2,constantBpmSlider:300,track:[[1,1,0,0,0,0,0,1,0,0,1,1,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0],[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],timeSignature:16,samples:[{file:"Kick.wav",instrumentKey:"basicdrumkit"},{file:"Snare.wav",instrumentKey:"basicdrumkit"},{file:"ClosedHat.wav",instrumentKey:"basicdrumkit"},{file:"OpenHat.wav",instrumentKey:"basicdrumkit"}]}),N={"arrow up/down":"strza\u0142ki g\xf3ra/d\xf3\u0142","higher/lower BPM":"zwi\u0119ksz/zmniejsz BPM","arrow left/right":"strza\u0142ki lewa/prawa","previous/next step according to plan":"poprzedni/nast\u0119pny krok wg planu","start/stop":"zacznij/zatrzymaj",stop:"zatrzymaj",Control:"Kontrola","Start / Stop":"Zacznij / Zatrzymaj",Volume:"G\u0142o\u015bno\u015b\u0107",Instrument:"Instrument",Mode:"Tryb","Increase speed":"Zwi\u0119kszaj pr\u0119dko\u015b\u0107","BPM range":"Zakres BPM","By bar":"Co kilka takt\xf3w",bar:"takt","By time":"Co jaki\u015b czas","Set time":"W ustalonym czasie \u0107wicze\u0144",Constant:"Nie zwi\u0119kszaj","Increase speed every":"Zwi\u0119ksz pr\u0119dko\u015b\u0107 co","Number of steps":"Ilo\u015b\u0107 krok\xf3w","Up and Down":"Szybciej i wolniej",Shuffle:"Losowo","Exercise Time":"Czas \u0107wiczenia","Total time:":"Ca\u0142kowity czas:","Please select":"Prosz\u0119 wybra\u0107",Select:"Wybierz",Stop:"Zatrzymaj",Continue:"Kontynuuj",Repeat:"Od pocz\u0105tku","After plan":"Po zako\u0144czeniu","Step order":"Kolejno\u015b\u0107","Plan progress":"Post\u0119p planu","Step progress":"Post\u0119p kroku",Title:"Nazwa","Save current settings":"Zapisz bie\u017c\u0105ce ustawienia",Edit:"Edytuj","User presets":"Zapisane ustawienia",Presets:"Presety",Delete:"Usu\u0144","Save Preset":"Zapisz Ustawienia",Cancel:"Anuluj","Are you sure?":"Czy aby na pewno?","Are you sure to delete current preset?":"Czy jeste\u015b pewien, \u017ce chcesz usun\u0105\u0107 to ustawienie?",Save:"Zapisz",Polyrhythms:"Polirytmy",Basic:"Podstawowe","Drum Patterns":"Motywy perkusyjne","Afro-Cuban":"Afro-Kuba\u0144skie",Other:"Inne",Sequencer:"Sekwencer","Keyboard controls":"Skr\xf3ty klawiszowe",bars:{1:"takt",2:"takty",3:"takty",4:"takty",5:"takt\xf3w"},hours:{1:"godzina",2:"godziny",3:"godziny",4:"godziny",5:"godzin"},minutes:{1:"minuta",2:"minuty",3:"minuty",4:"minuty",5:"minut"},seconds:{1:"sekunda",2:"sekundy",3:"sekundy",4:"sekundy",5:"sekund"},hr:"godz.",hrs:"godz."};function D(){return navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en"}switch(D()){case"pl":case"pl-PL":case"pl-pl":R=N;break;default:R={}}var A=function(e){return R[e]?R[e]:e};function _(e,t){if(R[t]){if(R[t][e])return R[t][e];var a=R[t];return a[Object.keys(a)[Object.keys(a).length-1]]}return t}var K=a(180),z=a(181),L=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(y.a,{className:"SimpleProgress"},r.a.createElement("div",{className:"bar",style:{width:this.props.value+"%",display:"block"}}))}}]),t}(n.Component),F={toLocaleDateTime:function(e){return e?new Date(e).toLocaleString(D(),{dateStyle:"long",timeStyle:"short"}):""},padTime:function(e){return e<10?"0"+e:e},formatTime:function(e){if(e)return F.formatTimeFull(e,"h","m","s",!0)},formatTimeLong:function(e){if(e)return F.formatTimeFull(e,"hours","minutes","seconds",!1)},formatTimeFull:function(e,t,a,n,r){var s=new Date(0,0,0,0,0,0,0);s.setSeconds(e);var i=s.getHours(),o=s.getMinutes(),l=s.getSeconds(),c="";return 0!==i&&(c+=i+" "+_(i,t)+" "),0!==o||0!==i?(0!==i&&0!==o?c+=(r?F.padTime(o):o)+" "+_(o,a)+" ":0!==o&&(c+=(r?F.padTime(o):o)+" "+_(o,a)+" "),0!==l&&(c+=(r?F.padTime(l):l)+" "+_(l,n))):c+=s.getSeconds()+" "+_(l,n),c.trim()},storageAvailable:function(e){var t;try{t=window[e];var a="__storage_test__";return t.setItem(a,a),t.removeItem(a),!0}catch(n){return n instanceof DOMException&&(22===n.code||1014===n.code||"QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)&&t&&0!==t.length}}},U=F,V=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(s)))).state={playbackMode:a.props.playbackMode,playMode:a.props.playMode,steps:[],currentStepIdx:a.props.currentStepIdx,stepProgress:0,planProgress:0,isUpDown:!1,isPaused:!1},a.barRender=function(e){var t=a.state.currentStepIdx===e.stepIdx?"current-step":"";return r.a.createElement("div",{onClick:function(){return a.startStep(e.stepIdx)},className:"step clickable "+t,key:"key_"+e.stepIdx},e.duration!==1/0?r.a.createElement(r.a.Fragment,null,e.durationFormatted," (",e.durationBars," ",_(Math.floor(e.durationBars),"bars"),") "):"","@ ",e.bpm.toFixed(0)," bpm")},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"makePlan",value:function(e){var t=[],a=e.bpmRange[1],n=e.bpmRange[0];if(e.playMode===S)for(;n<=a;){var r={bpm:n,duration:e.byBarInterval};t.push(r),n+=e.bpmStep}else if(e.playMode===E)for(;n<=a;){var s={duration:e.byTimeInterval,bpm:n};t.push(s),n+=e.bpmStep}else if(e.playMode===C){var i={duration:1/0,bpm:e.constantBpmSlider};t.push(i)}else if(e.playMode===w)for(var o=e.exerciseTime/e.stepsNum,l=e.bpmRange[0],c=(e.bpmRange[1]-e.bpmRange[0])/(e.stepsNum-1);l<=a;){var p={duration:o,bpm:l};t.push(p),l+=c}if(this.state.isUpDown){var u=t.slice().reverse();u.shift(),t=t.concat(u)}return this.state.isRandom&&(t=this.shuffle(t.slice())),t}},{key:"shuffle",value:function(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[a],e[a]=t;return e}},{key:"onPlanStep",value:function(e){this.setState({currentStepIdx:e},this.stepChanged)}},{key:"updateProgress",value:function(){var e=this.getStep(this.state.currentStepIdx),t=(this.props.transport.ticks-e.startTimeTicks)/d.a.Time(e.duration).toTicks(),a=this.props.transport.ticks/this.endTime;this.setState({stepProgress:this.clamp(t),planProgress:this.clamp(a)})}},{key:"clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),a)}},{key:"setPlan",value:function(e){var t=this,a=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.makePlan(e));this.baseBpm=this.props.transport.bpm.value;var n=e.timeSignature,r=0;this.events=[];for(var s=[],i=0,o=function(o){var l=a[o],c=60/l.bpm;t.props.transport.schedule((function(e){return t.onPlanStep(o)}),r);var p=e.playMode===S?c*n*l.duration:l.duration,u=e.playMode===S?l.duration:l.duration/(c*n),m={bpm:l.bpm,duration:p,durationBars:u.toFixed(1),durationFormatted:U.formatTime(p),stepIdx:o,track:e.track,playMode:l.playMode,startTimeTicks:d.a.Time(r).toTicks()};switch(e.playMode){case E:case w:r+=t.calcTimeForBpm(l.duration,l.bpm);break;case S:r=l.duration*(o+1)+"m";break;case C:r=1/0;break;default:throw new Error("Invalid playMode: "+e.playMode)}i+=p,s.push(m)},l=0;l<a.length;l++)o(l);this.props.transport.schedule((function(e){return t.onPlanEnd(e)}),r),this.endTime=d.a.Time(r).toTicks(),this.setState((function(t){return{totalPlanTime:i,currentStepIdx:0,steps:s,playMode:e.playMode}}),this.stepChanged)}},{key:"calcTimeForBpm",value:function(e,t){return d.a.Time(e*t/this.baseBpm)}},{key:"startStep",value:function(e){if(this.state.currentStepIdx!==e){var t=this.getStep(e);this.props.transport.ticks=t.startTimeTicks,this.setState({currentStepIdx:e},this.stepChanged)}}},{key:"getStep",value:function(e){return this.state.steps[e]}},{key:"stepForward",value:function(){this.state.currentStepIdx+1<this.state.steps.length&&this.startStep(this.state.currentStepIdx+1)}},{key:"stepBackward",value:function(){this.state.currentStepIdx-1>=0&&this.startStep(this.state.currentStepIdx-1)}},{key:"onPlanEnd",value:function(e){this.state.playbackMode===M?this.props.onPlanEnd():this.state.playbackMode===T&&this.startStep(0)}},{key:"stepChanged",value:function(){var e=this.getCurrentStep().bpm;this.props.onPlanStep(e)}},{key:"getCurrentStep",value:function(){if(this.state.currentStepIdx>=this.state.steps.length)throw new Error("Trying to get step that doesn't exists");return this.state.steps[this.state.currentStepIdx]}},{key:"onPlaybackChange",value:function(e){this.setState({playbackMode:e},this.props.onChange)}},{key:"onUpDownBtn",value:function(){this.setState({isUpDown:!this.state.isUpDown,isRandom:!1},this.props.onChange)}},{key:"onRandomBtn",value:function(){this.setState({isRandom:!this.state.isRandom,isUpDown:!1},this.props.onChange)}},{key:"render",value:function(){var e=this;return this.state.playMode===C?r.a.createElement("div",null):r.a.createElement(g,{title:"Plan"},r.a.createElement("div",{className:"Planner"},r.a.createElement("div",null,A("Step progress")," ",r.a.createElement(L,{value:100*this.state.stepProgress})),r.a.createElement("div",null,A("Plan progress")," ",r.a.createElement(L,{value:100*this.state.planProgress})),r.a.createElement("div",{style:{height:"200px",overflow:"auto"}},this.state.steps.map((function(t){return e.barRender(t)}))),r.a.createElement("div",null,A("Total time:")," ",U.formatTime(this.state.totalPlanTime))),r.a.createElement(K.a,{isOpen:this.state.playMode!==C},r.a.createElement("div",null,A("After plan")),r.a.createElement(z.a,{size:"sm"},r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onPlaybackChange(M)},active:this.state.playbackMode===M},A("Stop")),r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onPlaybackChange(B)},active:this.state.playbackMode===B},A("Continue")),r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onPlaybackChange(T)},active:this.state.playbackMode===T},A("Repeat"))),r.a.createElement("div",null,A("Step order")),r.a.createElement(z.a,null,r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(t){return e.onUpDownBtn(t)},active:this.state.isUpDown},A("Up and Down")),r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onRandomBtn()},active:this.state.isRandom},A("Shuffle")))))}}]),t}(n.Component),H=V;V.defaultProps={playbackMode:j.playbackMode,playMode:j.playMode,onChange:function(){},onPlanStep:function(){},onPlanEnd:function(){},currentStepIdx:NaN};var W=a(189),G=a(182),Z=a(183),X=a(184),J=a(185),q=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={modal:!1,nestedModal:!1,preset:null,presetId:null,showDelete:!1},a.toggle=function(){a.setState((function(e){return{modal:!e.modal,nestedModal:!1}}))},a.toggleNested=function(){a.setState({nestedModal:!a.state.nestedModal})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleSave",value:function(){var e=this.state.preset,t=this.state.preset.title;t&&t.length>0&&(this.props.onSave(t,e),this.toggle())}},{key:"edit",value:function(e,t,a){t&&a&&(e.presetId=t,e.title=a),this.setState({preset:e,showDelete:!!t},this.toggle)}},{key:"titleChanged",value:function(e){var t=e.target.value,a=Object(m.a)({},this.state.preset);a.title=t,this.setState({preset:a})}},{key:"handleDelete",value:function(){this.props.onDeleteBtn(this.state.preset),this.toggle()}},{key:"renderDelete",value:function(){if(!0===this.state.showDelete)return r.a.createElement(k.a,{color:"warning",onClick:this.toggleNested},A("Delete"))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{style:{marginTop:"0.5em"},outline:!0,size:"sm",color:"light",onClick:this.props.onSaveBtn},A("Save current settings")),r.a.createElement(W.a,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},r.a.createElement(G.a,{toggle:this.toggle},A("Save Preset")),r.a.createElement(Z.a,null,r.a.createElement(X.a,{onChange:function(t){return e.titleChanged(t)},placeholder:A("Title"),defaultValue:this.state.preset&&this.state.preset.title||""}),r.a.createElement(W.a,{isOpen:this.state.nestedModal,toggle:this.toggleNested},r.a.createElement(G.a,{toggle:this.toggleNested},A("Are you sure?")),r.a.createElement(Z.a,null,A("Are you sure to delete current preset?")),r.a.createElement(J.a,null,r.a.createElement(k.a,{color:"warning",onClick:function(){return e.handleDelete()}},A("Delete")),r.a.createElement(k.a,{onClick:this.toggleNested},A("Cancel"))))),r.a.createElement(J.a,null,r.a.createElement(k.a,{color:"primary",onClick:function(){return e.handleSave()}},A("Save"))," ",r.a.createElement(k.a,{color:"secondary",onClick:this.toggle},A("Cancel")),this.renderDelete())))}}]),t}(n.Component),Q=q;q.defaultProps={onDeleteBtn:function(e){},onSave:function(e,t){},onSaveBtn:function(e,t){}};var Y={TRACKS_NUMBER:4,MAXIMUM_TIMESIGNATURE:24,PROGRESS_UPDATE_FPS:30,COLOR_PALETTE:{0:"#FF715B",1:"#F9CB40",2:"#BCED09",3:"#2F52E0"}},$=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={showDelete:[],showEdit:[],userPresets:[]};var n=localStorage.getItem("userPresets");return a.state.userPresets=n?JSON.parse(n):[],a.state.showDelete=a.state.userPresets?Array(a.state.userPresets.length).fill(!1):[],a.state.showEdit=a.state.userPresets?Array(a.state.userPresets.length).fill(!1):[],a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"validatePreset",value:function(e){if(e.byBarInterval=e.byBarInterval||e.interval||j.byBarInterval,e.byTimeInterval=e.byTimeInterval||e.interval||j.byTimeInterval,!e.track){var t=[];e.accents.map((function(e){return t.push([e]),!0})),e.track=t}if(!e.timeSignature){var a=e.track.length;e.timeSignature=a;for(var n=new Array(Y.TRACKS_NUMBER).fill(0).map((function(e){return new Array(a).fill(0)})),r=0;r<e.track.length;r++)for(var s=e.track[r],i=0;i<s.length;i++)n[s[i]][r]=1;e.track=n}return e.samples||(e.samples=this.convertInstrumentKeyToSamples(e.instrumentKey)),e}},{key:"convertInstrumentKeyToSamples",value:function(e){return I.filter((function(t){return t.instrumentKey===e}))}},{key:"onPresetClick",value:function(e){this.props.onSelect(this.validatePreset(e))}},{key:"onSavePreset",value:function(e,t){var a=Object(m.a)({title:e},t);if(void 0===a.presetId){var n=1;this.state.userPresets.length>0&&(n=Math.max.apply(Math,this.state.userPresets.map((function(e){return e.presetId}))),n++),a.presetId=n}a.savedDtm=new Date;var r=this.state.userPresets,s=this.state.userPresets.findIndex((function(e){return e.presetId===a.presetId}));s<0?r.push(a):r[s]=a,this.saveInLocalStorage(r)}},{key:"saveInLocalStorage",value:function(e){localStorage.setItem("userPresets",JSON.stringify(e)),this.setState({userPresets:e})}},{key:"showDeleteBtn",value:function(e,t){var a=Object(m.a)({},this.state);a[t]=!0,this.setState({showDelete:a})}},{key:"showEditBtn",value:function(e,t,a){var n=Object(m.a)({},this.state);n[t]=!0,this.setState({showEdit:n})}},{key:"hideEditBtn",value:function(e){this.setState({showEdit:!1})}},{key:"onPresetDelete",value:function(e){var t=this.state.userPresets.findIndex((function(t){return t.presetId===e.presetId})),a=this.state.userPresets.slice();if(t<0)throw new Error("Selected preset "+e.title+" has not been found in the store");a.splice(t,1),this.saveInLocalStorage(a)}},{key:"onPresetEdit",value:function(e,t){var a=this.props.getPreset();void 0!==t?this.refs.presetEditor.edit(a,this.state.userPresets[t].presetId,this.state.userPresets[t].title):this.refs.presetEditor.edit(a)}},{key:"renderUserPresets",value:function(e){var t=this;if(0!==e.length)return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,null,A("User presets"),":"),e.map((function(e,a){return r.a.createElement(v.a,{className:"presetItem clickable",onClick:function(){return t.onPresetClick(e)},key:"preset_"+a},r.a.createElement(b.a,{style:{textAlign:"left"}},e.title),r.a.createElement(b.a,{xs:"auto",className:"userPresetSavedDtm"},U.toLocaleDateTime(e.savedDtm)),r.a.createElement(b.a,null,r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(e){return t.onPresetEdit(e,a)}},A("Edit"))))})))}},{key:"render",value:function(){var e=this,t=localStorage.getItem("userPresets"),a=t?JSON.parse(t):[];return r.a.createElement(g,{className:"PresetsManager",title:A("Presets")},r.a.createElement(y.a,null,x.map((function(t,a){return t.isHeader?r.a.createElement(v.a,{className:"presetHeader",key:"header_"+a},A(t.title),":"):r.a.createElement(v.a,{onClick:function(){return e.onPresetClick(t)},className:"presetItem clickable",key:"preset_"+a},t.title)})),this.renderUserPresets(a),r.a.createElement(v.a,{style:{justifyContent:"center"}},r.a.createElement(Q,{ref:"presetEditor",onDeleteBtn:function(t){return e.onPresetDelete(t)},onSaveBtn:function(t,a){return e.onPresetEdit(t,a)},onSave:function(t,a){return e.onSavePreset(t,a)}}))))}}]),t}(n.Component),ee=$;$.defaultProps={onSelect:function(e){}};var te=a(60),ae=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={track:a.props.track,timeSignature:a.props.timeSignature},a.colorEmpty="#333",a.strokeColor="#444",a.strokeWidth="0.001em",a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"setAccents",value:function(e){this.setState({track:e})}},{key:"getCoordinatesForPercent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=t*Math.cos(2*Math.PI*e),n=t*Math.sin(2*Math.PI*e);return[a,n]}},{key:"drawSlices",value:function(e,t){var a=this;this.props.track[t];var n=1/this.props.track[t].length,s=[];this.props.track[t].forEach((function(e,r){s.push({percent:n,color:e>0?Y.COLOR_PALETTE[t]:a.colorEmpty})}));var i=0,o=[];return s.forEach((function(t,n){var s=a.getCoordinatesForPercent(i,e),l=Object(te.a)(s,2),c=l[0],p=l[1];i+=t.percent;var u=a.getCoordinatesForPercent(i,e),m=Object(te.a)(u,2),h=m[0],d=m[1],y=t.percent>.5?1:0,v=["M ".concat(c," ").concat(p),"A ".concat(e," ").concat(e," 0 ").concat(y," 1 ").concat(h," ").concat(d),"L 0 0"].join(" ");o.push(r.a.createElement("path",{key:"pie_"+n,d:v,fill:t.color,stroke:a.strokeColor,strokeWidth:a.strokeWidth}))})),o}},{key:"drawText",value:function(){for(var e=[],t=1/this.props.timeSignature,a=0,n=0;n<this.props.timeSignature;n++){var s=this.getCoordinatesForPercent(a,.9),i=Object(te.a)(s,2),o=i[0],l=i[1];o-=.06,e.push(r.a.createElement("text",{x:o,y:l,key:"label_"+n,textAnchor:"middle",transform:"rotate(90, "+o+", "+l+")",className:"svgText"},n+1)),a+=t}return r.a.createElement("g",null,e)}},{key:"setProgress",value:function(e){this.line.style.transform="rotate("+360*e+"deg)"}},{key:"render",value:function(){for(var e=this,t=.5/Y.TRACKS_NUMBER,a=[],n=0;n<this.props.track.length;n++)a.push(this.drawSlices(.8-t*n,n));return a.push(r.a.createElement("circle",{key:"innerCircle",cx:"0",cy:"0",r:.8-t*Y.TRACKS_NUMBER,fill:this.colorEmpty,stroke:this.strokeColor,strokeWidth:this.strokeWidth})),r.a.createElement("div",{ref:function(t){return e.container=t},className:"visClockContainer"},r.a.createElement("svg",{viewBox:"-1 -1 2 2",ref:function(t){return e.svg=t}},r.a.createElement("g",{style:{transform:"rotate(-90deg)"}},a,this.drawText(),r.a.createElement("line",{ref:function(t){return e.line=t},strokeLinecap:"round",x1:"0",y1:"0",x2:".7",y2:"0",stroke:"rgba(255,255,255,0.5)",strokeWidth:"0.1",style:{transform:"rotate("+360*this.props.partProgress+"deg)"}}))))}}]),t}(n.Component),ne=ae;ae.defaultProps={track:j.track,timeSignature:j.timeSignature};var re=a(190),se=a(192),ie=a(191),oe=a(188),le=a(35),ce=a(101),pe=a.n(ce),ue=a(187),me=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={value:a.props.defaultValue,regression:void 0},a.onMinusClick=function(){var e=a.state.value-a.state.btnStep;a.setState({value:e},a.props.onChange(e))},a.onPlusClick=function(){var e=a.state.value+a.state.btnStep;a.setState({value:e},a.props.onChange(e))};var n=[[0,a.props.min],[100,a.props.max]];return a.state.regression=pe.a.exponential(n,{precision:10}),a.prepareMarks(),a.state.value=a.props.defaultValue,a.state.btnStep=e.btnStep||1,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"prepareMarks",value:function(){this.marks={};for(var e=0;e<this.props.marksAt.length;e++)this.marks[this.findX(this.props.marksAt[e])]=this.props.marksAt[e]}},{key:"onChange",value:function(e){var t=Math.floor(this.state.regression.predict(e)[1]);this.setState({value:t}),this.props.onChange(t)}},{key:"findX",value:function(e){return Math.log(e)/this.state.regression.equation[1]}},{key:"setValue",value:function(e){this.setState({value:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(k.a,{size:"sm",outline:!0,className:"inlineBtn",onClick:this.onMinusClick},"-"),r.a.createElement(ue.a,{color:"light",onClick:this.onBadgeClick,className:"d-i"},this.props.badgeFormatter(this.state.value)),r.a.createElement(k.a,{size:"sm",outline:!0,className:"inlineBtn",onClick:this.onPlusClick},"+")),r.a.createElement(le.b,{ref:"slider",included:!1,value:this.findX(this.state.value),style:{height:"45px"},onChange:function(t){return e.onChange(t)},min:0,max:100,step:.5,marks:this.marks}))}}]),t}(n.Component),he=me;me.defaultProps={marksNum:6,marksStyle:{color:"#ccc"},desc:"",badgeFormatter:function(e){return e},markFormatter:function(e){return e},marksAt:[]};var de=a(58),ye=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(ue.a,{color:"light",className:"d-i"},this.state.bounds[0]," - ",this.state.bounds[1])),r.a.createElement("div",{style:{height:"30px"}},Object(de.a)(Object(p.a)(t.prototype),"render",this).call(this)))}}]),t}(le.a),ve=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).onMinusClick=function(){var e=a.state.value-a.state.btnStep;a.setState({value:e},a.props.onChange(e))},a.onPlusClick=function(){var e=a.state.value+a.state.btnStep;a.setState({value:e},a.props.onChange(e))},a.state.btnStep=e.btnStep||1,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"advancedSlider"},!0===this.props.disableBtns?"":r.a.createElement(k.a,{size:"sm",outline:!0,className:"inlineBtn",onClick:this.onMinusClick},"-"),r.a.createElement(ue.a,{color:"light",className:"d-i"},this.state.value),!0===this.props.disableBtns?"":r.a.createElement(k.a,{size:"sm",outline:!0,className:"inlineBtn",onClick:this.onPlusClick},"+")),r.a.createElement("div",{style:{height:"30px"}},r.a.createElement("div",null,Object(de.a)(Object(p.a)(t.prototype),"render",this).call(this))))}},{key:"onBadgeClick",value:function(){}}]),t}(le.b),be=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={value:void 0,innerValue:0},a.state.innerMarks={},Object.values(a.props.marks).map((function(e,t){return a.state.innerMarks[t]={label:e.label},!0})),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.props.value,n=void 0!==a?a:t.value,r=Object.keys(this.props.marks).indexOf(n+"");r!==t.innerValue&&this.setState({innerValue:r,value:a})}},{key:"onSliderChange",value:function(e){var t=Object.values(this.props.marks)[e].value;this.setState({innerValue:e,value:t}),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(ue.a,{color:"light",className:"d-i"},this.props.badgeFormatter(this.state.value))),r.a.createElement("div",{style:{height:"3.5em",width:"95%",margin:"auto",whiteSpace:"nowrap"}},r.a.createElement(le.b,{ref:"slider",included:!1,value:this.state.innerValue,style:{height:"3.5em"},onChange:function(t){return e.onSliderChange(t)},min:0,max:Object.keys(this.props.marks).length-1,step:1,marks:this.state.innerMarks})))}}]),t}(n.Component),fe=be;be.defaultProps={badgeFormatter:function(e){return e},markFormatter:function(e){return e},defaultValue:0};var ge=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={bpmStep:a.props.bpmStep,bpmRange:a.props.bpmRange,playbackMode:a.props.playbackMode,playMode:a.props.playMode,stepsNum:a.props.stepsNum,exerciseTime:a.props.exerciseTime,bpmStepDropdownOpen:!1,byTimeInterval:a.props.byTimeInterval,byBarInterval:a.props.byBarInterval,constantBpmSlider:a.props.constantBpmSlider},a.onBpmSliderChange=function(e){a.setState({constantBpmSlider:e},a.onAfterChange)},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onAfterChange",value:function(e){this.props.onChange()}},{key:"onModeChange",value:function(e){var t=Object(m.a)({},this.state);e===C&&e!==this.state.playMode&&(t.constantBpmSlider=this.props.transport.bpm.value),t.playMode=e,this.setState(t,this.onAfterChange)}},{key:"onBpmRangeChange",value:function(e){this.setState({bpmRange:e},this.onAfterChange)}},{key:"onBpmStepChange",value:function(){this.setState((function(e){return{bpmStepDropdownOpen:!e.bpmStepDropdownOpen}}))}},{key:"onBpmStepSelect",value:function(e){this.setState({bpmStep:e},this.onAfterChange)}},{key:"setValue",value:function(e){this.refs.byBarSlider.setValue(e.byBarInterval||j.byBarInterval),this.refs.byTimeSlider.setValue(e.byTimeInterval||j.byTimeInterval),this.refs.bpmRange.setState({bounds:e.bpmRange}),this.setState({playMode:e.playMode,playbackMode:e.playbackMode||this.state.playbackMode,bpmStep:e.bpmStep,exerciseTime:e.exerciseTime||this.state.exerciseTime,stepsNum:e.stepsNum||this.state.stepsNum,byBarInterval:e.byBarInterval,byTimeInterval:e.byTimeInterval,bpmRange:e.bpmRange,constantBpmSlider:e.constantBpmSlider||this.state.constantBpmSlider},this.onAfterChange)}},{key:"onTimeIntervalChange",value:function(e){this.setState({byTimeInterval:e,interval:e},this.onAfterChange)}},{key:"onBarIntervalChange",value:function(e){this.setState({byBarInterval:e,interval:e},this.onAfterChange)}},{key:"byBarFormatter",value:function(e){return e+" "+_(e,"bars")}},{key:"renderIncreaseBpmDropdown",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(re.a,{style:{margin:"0px 5px"},isOpen:this.state.bpmStepDropdownOpen,toggle:function(){return e.onBpmStepChange()}},r.a.createElement(se.a,{caret:!0,size:"sm",outline:!0,color:"light"},this.state.bpmStep),r.a.createElement(ie.a,null,[1,2,3,5,10,15,20,30,50,100].map((function(t){return r.a.createElement(oe.a,{key:"bpm_"+t,onClick:function(){e.onBpmStepSelect(t)}},t)})))),"bpm")}},{key:"onStepsSliderChange",value:function(e){this.setState({stepsNum:e},this.onAfterChange)}},{key:"onExerciseTimeSliderChange",value:function(e){this.setState({exerciseTime:e},this.onAfterChange)}},{key:"renderTimeSlider",value:function(){var e=this,t={};return[300,600,900,1200,1800,3600,7200,10800].map((function(e){return t[e]={value:e,label:U.formatTime(e)},!0})),r.a.createElement("div",null,A("Exercise Time"),r.a.createElement(fe,{ref:"exerciseTimeSlider",badgeFormatter:U.formatTimeLong,markFormatter:U.formatTime,marks:t,value:this.state.exerciseTime,onChange:function(t){return e.onExerciseTimeSliderChange(t)}}))}},{key:"renderStepsSlider",value:function(){var e=this;return r.a.createElement("div",null,A("Number of steps"),r.a.createElement(ve,{ref:"stepsSlider",min:2,included:!1,max:100,marks:{1:"1",5:"5",10:"10",15:"15",20:"20",30:"30",40:"40",50:"50",60:"60",70:"70",80:"80",90:"90",100:"100"},value:this.state.stepsNum,onChange:function(t){return e.onStepsSliderChange(t)}}))}},{key:"renderSpeedRange",value:function(){var e=this;return r.a.createElement("div",null,A("BPM range"),r.a.createElement(ye,{ref:"bpmRange",min:30,max:1200,defaultValue:[this.state.bpmRange[0],this.state.bpmRange[1]],pushable:!0,onAfterChange:function(t){return e.onBpmRangeChange(t)}}))}},{key:"render",value:function(){var e=this;return r.a.createElement(g,{className:"ModePanel",title:"Mode",width:"300px"},r.a.createElement("h6",null,A("Increase speed")),r.a.createElement(z.a,{size:"sm"},r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(w)},active:this.state.playMode===w},A("Set time")),r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(S)},active:this.state.playMode===S},A("By bar")),r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(E)},active:this.state.playMode===E},A("By time")),r.a.createElement(k.a,{size:"sm",outline:!0,onClick:function(){return e.onModeChange(C)},active:this.state.playMode===C},A("Constant"))),r.a.createElement(K.a,{isOpen:this.state.playMode!==C},this.renderSpeedRange()),r.a.createElement(K.a,{isOpen:this.state.playMode===w},this.renderTimeSlider(),this.renderStepsSlider()),r.a.createElement(K.a,{isOpen:this.state.playMode===S},r.a.createElement("div",null,A("Increase speed every"),r.a.createElement(he,{ref:"byBarSlider",defaultValue:this.state.byBarInterval,badgeFormatter:this.byBarFormatter,onChange:function(t){return e.onBarIntervalChange(t)},min:1,max:301,marksAt:[1,2,5,10,20,50,100,300]}))),r.a.createElement(K.a,{isOpen:this.state.playMode===E},r.a.createElement("div",null,A("Increase speed every"),r.a.createElement(he,{ref:"byTimeSlider",defaultValue:this.state.byTimeInterval,badgeFormatter:U.formatTimeLong,markFormatter:U.formatTime,onChange:function(t){return e.onTimeIntervalChange(t)},min:1,max:1200,marksAt:[1,2,5,10,30,60,120,240,600,1200]}))),r.a.createElement(K.a,{isOpen:this.state.playMode!==C&&this.state.playMode!==w},this.renderIncreaseBpmDropdown()),r.a.createElement(K.a,{isOpen:this.state.playMode===C},r.a.createElement("div",null,A("BPM"),r.a.createElement(ve,{ref:"constantBpmSlider",included:!1,min:10,btnStep:10,max:1200,marks:{30:"30",200:"200",400:"400",600:"600",800:"800",1e3:"1000",1200:"1200"},value:this.state.constantBpmSlider,onChange:this.onBpmSliderChange}))))}}]),t}(n.Component),ke=ge;ge.defaultProps={playMode:j.playMode,playbackMode:j.playbackMode,interval:j.interval,bpmStep:j.bpmStep,bpmRange:j.bpmRange,byTimeInterval:j.byTimeInterval,byBarInterval:j.byBarInterval,stepsNum:j.stepsNum,exerciseTime:j.exerciseTime,constantBpmSlider:j.constantBpmSlider,onAfterChange:null};var Se=a(50),Ee=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={activeIdx:null,label:A("Please select")},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(j.samples[this.props.idx]){var e=P[j.samples[this.props.idx].instrumentKey],t=j.samples[this.props.idx].file;this.onSampleSelect(e.key,t)}}},{key:"addBeat",value:function(){this.props.trackRow.length<Y.MAXIMUM_TIMESIGNATURE&&this.props.onMeasureChange(this.props.trackRow.length+1)}},{key:"removeBeat",value:function(){this.props.trackRow.length>1&&this.props.onMeasureChange(this.props.trackRow.length-1)}},{key:"onSampleChange",value:function(){this.setState((function(e){return{sampleDropdownOpen:!e.sampleDropdownOpen}}))}},{key:"onSampleSelect",value:function(e,t){this.props.soundLibrary.use(this.props.idx,e,t)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"trackRow"},r.a.createElement("div",{className:"label"},r.a.createElement(re.a,{isOpen:this.state.sampleDropdownOpen,toggle:function(){return e.onSampleChange()}},r.a.createElement(se.a,{caret:!0,size:"sm",outline:!0,style:{width:"6rem"},color:"light",ref:"dropdown"},this.props.soundLibrary.playersArr[this.props.idx]?this.props.soundLibrary.playersArr[this.props.idx].fullLabel:A("Select")),r.a.createElement(ie.a,null,I.map((function(t,a){return r.a.createElement(oe.a,{key:"row_"+a,onClick:function(){return e.onSampleSelect(t.instrumentKey,t.file)}},P[t.instrumentKey].label," - ",t.label)})))),r.a.createElement(ue.a,{color:"outline",style:{alignSelf:"center",width:"1.2rem"}},this.props.trackRow.length),r.a.createElement(z.a,{size:"xs",vertical:!0},r.a.createElement(k.a,{onClick:function(){return e.addBeat()}},"+"),r.a.createElement(k.a,{onClick:function(){return e.removeBeat()}},"-"))),r.a.createElement("div",{className:"cells",ref:"cellsDiv"},this.props.trackRow.map((function(t,a){var n={};return e.props.trackRow[a]&&(n.backgroundColor=Y.COLOR_PALETTE[e.props.idx]),r.a.createElement("div",{key:"cell_"+a,className:"clickable cell",style:n,onClick:function(){return e.props.onClick(e.props.idx,a)}})}))))}}]),t}(n.Component),we=Ee;Ee.defaultProps={};var Ce=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={timeSignature:a.props.timeSignature},a.rowRefs=[],a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleCellClick",value:function(e,t){var a=Object(Se.a)(this.props.track),n=a[e][t];a[e][t]=n>0?0:1,this.props.onChange(a,this.props.timeSignature)}},{key:"setProgress",value:function(e){this.indicator.style.left=this.indicator.minLeft+e*(this.indicator.maxRight-this.indicator.minLeft)+"px"}},{key:"updateDimensions",value:function(){var e=this.refs.trackRow_0.refs.cellsDiv.getBoundingClientRect(),t=this.refs.trackRow_3.refs.cellsDiv.getBoundingClientRect(),a=(e.left,e.top),n=t.bottom,r=(t.right,this.refs.indicator),s=this.refs.trackRow_0.refs.cellsDiv.offsetLeft;r.minLeft=this.refs.trackRow_0.refs.cellsDiv.offsetLeft;var i=s+this.refs.trackRow_0.refs.cellsDiv.offsetWidth;r.style.left=s+"px",r.maxRight=i,r.style.height=n-a+"px",this.indicator=r}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",(function(){return e.updateDimensions()})),this.updateDimensions()}},{key:"addBeat",value:function(){if(this.props.timeSignature<Y.MAXIMUM_TIMESIGNATURE){for(var e=Object(Se.a)(this.props.track),t=0;t<e.length;t++)e[t].length<Y.MAXIMUM_TIMESIGNATURE&&e[t].push(0);this.props.onChange(e,this.props.timeSignature+1)}}},{key:"removeBeat",value:function(){if(this.props.timeSignature>1){for(var e=Object(Se.a)(this.props.track),t=0;t<e.length;t++)e[t].length>1&&e[t].pop();this.props.onChange(e,this.props.timeSignature-1)}}},{key:"onTrackRowSignatureChange",value:function(e,t){if(t<24){var a=Object(Se.a)(this.props.track);t>a[e].length?a[e].push(0):a[e].pop(),this.props.onChange(a,this.props.timeSignature)}}},{key:"componentDidUpdate",value:function(){this.updateDimensions()}},{key:"render",value:function(){var e=this,t=0;return this.indicator&&(t=this.indicator.minLeft+this.props.partProgress*(this.indicator.maxRight-this.indicator.minLeft)+"px"),r.a.createElement(g,{style:{padding:"15px"},title:A("Sequencer")},r.a.createElement("div",{className:"trackView"},r.a.createElement("div",{className:"trackContainer"},r.a.createElement("div",{className:"indicator",ref:"indicator",style:{left:t}}),[0,1,2,3].map((function(t){return r.a.createElement(we,{idx:t,ref:"trackRow_"+t,soundLibrary:e.props.soundLibrary,onMeasureChange:function(a){return e.onTrackRowSignatureChange(t,a)},key:"trackRow_"+t,timeSignature:e.props.timeSignature,progress:e.props.progress,trackRow:e.props.track[t],onClick:function(t,a){return e.handleCellClick(t,a)}})}))),r.a.createElement("div",{className:"btnContainer"},r.a.createElement(z.a,{size:"sm",vertical:!0},r.a.createElement(k.a,{onClick:function(){return e.addBeat()}},"+"),r.a.createElement(k.a,{onClick:function(){return e.removeBeat()}},"-")),r.a.createElement("div",{height:"1em"},r.a.createElement(ue.a,{className:"beatsCntBadge",color:"dark"},this.props.timeSignature)))))}}]),t}(n.Component),Me=Ce;Ce.defaultProps={track:j.track};var Te=a(103),Be=a.n(Te),Oe=function(){function e(t){Object(o.a)(this,e),this.players=new d.a.Players({}),this.playersArr=[],this.reverb=(new d.a.Reverb).toMaster(),this.reverb.decay=4,this.reverb.predelay=.05,this.reverb.generate(),this.reverb.wet.value=0,this.players.connect(this.reverb),this.players.toMaster()}return Object(l.a)(e,[{key:"use",value:function(e,t,a){var n=this,r=P[t];this.players.add("player_"+e,"./audio/"+t+"/"+a,(function(e){return n.onLoad(e)}));var s=this.players.get("player_"+e);s.instrument=r,s.file=a,s.idx=e,s.fullLabel=I.find((function(e){return e.file===a})).label,this.playersArr[e]=s}},{key:"getSamples",value:function(){var e=[];return this.playersArr.map((function(t){return e.push({file:t.file,instrumentKey:t.instrument.key}),!0})),e}},{key:"play",value:function(e,t){var a=this.playersArr[e];a&&a.loaded&&a.start(t)}},{key:"setReverb",value:function(e){this.reverb.wet.value=e}}]),e}(),Ie=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).soundLibrary=new Oe,a.state={initialized:!1,config:j,track:a.props.track,timeSignature:a.props.timeSignature},a.transport=d.a.Transport,a.tone=d.a,a.repeat=function(e,t){a.soundLibrary.play(t,e)},a.setBpm=function(e){if(isNaN(e)||e<=0||e>1200)throw new Error("Invalid BPM value: "+e);e!==a.transport.bpm.value&&(d.a.Transport.bpm.value=e,document.title=e.toFixed(0)+" | "+a.documentTitle,a.setState({bpm:e}))},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.a.Transport.lookAhead=10,this.part=new d.a.Part((function(t,a){return e.repeat(t,a)}),[]),this.part.loop=!0,this.part.start(0);var t=this.getConfig();this.setPlan(t),this.initProgressUpdate(),this.documentTitle=document.title,this.setState({initialized:!0}),this.props.onReady()}},{key:"getConfig",value:function(){return Object(m.a)({},this.refs.modePanel.state,{},{track:this.state.track},{},{timeSignature:this.state.timeSignature},{},{samples:this.soundLibrary.getSamples()})}},{key:"initProgressUpdate",value:function(){var e=this;setInterval((function(){return e.onProgress()}),1e3/Y.PROGRESS_UPDATE_FPS)}},{key:"setPlan",value:function(e){this.transport.cancel(),this.transport.position=0,this.setTrack(e.track.slice(),e.timeSignature),this.refs.planner.setPlan(e)}},{key:"createPoly",value:function(e,t,a){for(var n=this.tone.Time("1m").toTicks()/e.length,r=0;r<e.length;r++)e[r]>0&&this.part.add(n.toFixed(0)*r+"i",t)}},{key:"setTrack",value:function(e,t){if(this.state.track!==e){e.length<Y.TRACKS_NUMBER&&e.push(new Array(t).fill(0)),this.setTimeSignature(t),this.part.removeAll();for(var a=0;a<e.length;a++)this.createPoly(e[a],a,t);this.part.loopEnd="1m",this.part.start(0),this.setState({track:e,timeSignature:t})}}},{key:"onProgress",value:function(){"stopped"!==this.transport.state&&(this.refs.debug&&(this.refs.debug.innerHTML=this.transport.seconds.toFixed(1)),this.refs.planner&&this.refs.planner.updateProgress(),this.refs.svgClock.setProgress(this.part.progress),this.refs.trackView.setProgress(this.part.progress))}},{key:"calcTimeForBpm",value:function(e,t){return d.a.Time(e*t/this.baseBpm)}},{key:"setTimeSignature",value:function(e){e!==this.transport.timeSignature&&(this.transport.timeSignature=e)}},{key:"toggle",value:function(){"started"===d.a.Transport.state?this.stop():this.start()}},{key:"onPlanStep",value:function(e){this.setBpm(e)}},{key:"onControlChange",value:function(){var e=this.getConfig();this.setPlan(e)}},{key:"onPresetSelect",value:function(e){this.setState({track:e.track,timeSignature:e.timeSignature},(function(){this.refs.modePanel.setValue(e)}));for(var t=0;t<e.samples.length;t++)this.soundLibrary.use(t,e.samples[t].instrumentKey,e.samples[t].file)}},{key:"onTrackChange",value:function(e,t){if(this.state.timeSignature!==t){var a=this.getConfig();a.track=e,a.timeSignature=t,this.setPlan(a)}else this.setTrack(e,t)}},{key:"onVolumeChange",value:function(e){this.tone.Master.volume.value=60*e/100-60+6}},{key:"onReverbChange",value:function(e){this.soundLibrary.setReverb(e/100)}},{key:"handleKey",value:function(e,t){switch(t.preventDefault(),e){case"s":case"space":this.toggle();break;case"esc":this.stop();break;case"left":this.refs.planner.stepBackward();break;case"right":this.refs.planner.stepForward();break;case"up":this.state.bpm<600&&this.setBpm(this.state.bpm+10);break;case"down":this.state.bpm>10&&this.setBpm(this.state.bpm-10)}}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Be.a,{handleKeys:["s","space","esc","left","right","up","down"],onKeyEvent:function(t,a){return e.handleKey(t,a)}}),r.a.createElement(y.a,null,r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement(g,{title:A("Control")},r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement(k.a,{onClick:function(){return e.toggle()},color:this.state.isPlaying?"secondary":"light",block:!0},A("Start / Stop")))),r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement("h2",null,r.a.createElement("span",{ref:"bpmInfo",className:"badge badge-dark bpm-info"},"BPM: ",d.a.Transport.bpm.value.toFixed(0))))),r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement("div",null,A("Volume")),r.a.createElement("div",null,r.a.createElement(ve,{ref:"volumeSlider",min:0,disableBtns:!0,btnStep:1,max:100,defaultValue:90,onChange:function(t){return e.onVolumeChange(t)}})),r.a.createElement("div",null,A("Reverb")),r.a.createElement("div",null,r.a.createElement(ve,{ref:"reverbSlider",min:0,disableBtns:!0,btnStep:1,max:100,defaultValue:0,onChange:function(t){return e.onReverbChange(t)}})))))),r.a.createElement(b.a,{style:{margin:"auto"}},r.a.createElement(ne,{ref:"svgClock",soundLibrary:this.soundLibrary,timeSignature:this.state.timeSignature,track:this.state.track}))),r.a.createElement(v.a,null,r.a.createElement(ke,{ref:"modePanel",transport:this.transport,onChange:function(){return e.onControlChange()}})),r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement(Me,{ref:"trackView",soundLibrary:this.soundLibrary,track:this.state.track,instrument:this.state.instrument,timeSignature:this.state.timeSignature,onChange:function(t,a){return e.onTrackChange(t,a)}}))),r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement(H,{transport:this.transport,onChange:function(){return e.onControlChange()},onPlanStep:function(t){return e.onPlanStep(t)},onPlanEnd:function(){return e.stop()},ref:"planner"}))),r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement(ee,{ref:"presetsManager",getPreset:function(){return e.getConfig()},onSelect:function(t){return e.onPresetSelect(t)}})))))}},{key:"stop",value:function(){this.transport.stop(),this.transport.position=0,this.setState({isPlaying:!1})}},{key:"start",value:function(){this.transport.start("+.1"),this.part.start(),this.setState({isPlaying:!0})}}]),t}(n.Component),Pe=Ie;Ie.defaultProps={instrument:j.instrument,track:j.track,timeSignature:j.timeSignature,onReady:function(){}};a(175),a(176);var Re=a(78),xe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={showMask:!0},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){Re.a.initialize({trackingId:"UA-151010848-1",debug:!0,gaOptions:{cookieDomain:"none"}}),Re.a.pageview(window.location.pathname+window.location.search)}},{key:"removeLoadMask",value:function(){this.setState({showMask:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(y.a,{className:"app-container "},r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement(Pe,{ref:"sm",onReady:function(){return e.removeLoadMask()}}))),r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement(g,{title:A("Keyboard controls"),className:"about"},r.a.createElement("div",null,r.a.createElement("code",null,A("arrow up/down"))," - ",A("higher/lower BPM")),r.a.createElement("div",null,r.a.createElement("code",null,A("arrow left/right"))," - ",A("previous/next step according to plan")),r.a.createElement("div",null,r.a.createElement("code",null,"space, s")," - ",A("start/stop")),r.a.createElement("div",null,r.a.createElement("code",null,"esc")," - ",A("stop"))))),r.a.createElement(v.a,null,r.a.createElement(b.a,null,r.a.createElement("div",{className:"footer"},r.a.createElement("div",null,r.a.createElement("h6",null,"If you like this app consider donation to a developer using following ",r.a.createElement(ue.a,{href:"https://paypal.me/indiebubblerdev",target:"blank"},"link"))),r.a.createElement("div",null,"Join discord using ",r.a.createElement(ue.a,{href:"https://discord.gg/fAwnmVh",target:"blank"},"this link")," for feedback and improvement suggestions."),r.a.createElement("div",null,"By using this site you agree to the use of cookies to store user defined presets and analytics."),r.a.createElement("div",null,"Created using ",r.a.createElement(ue.a,{href:"https://reactjs.org/",target:"blank"},"React")," and ",r.a.createElement(ue.a,{href:"https://tonejs.github.io/",target:"blank"},"Tone.js"),". Source code available ",r.a.createElement(ue.a,{href:"https://github.com/indiebubbler/metro"},"here"),"."),r.a.createElement("div",null,"If you want help translating this page please contact ",r.a.createElement(ue.a,{href:"mailto:indiebubbler@gmail.com?subject=Feedback"},"indiebubbler@gmail.com"),"."),r.a.createElement("div",null,"\xa9 IndieBubbler 2019-2020. Version 2.0 beta"))))),r.a.createElement("div",{ref:"loadMask",className:!0===this.state.showMask?"loadmask ":"loadmask fadeOut"}))}}]),t}(n.Component),je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ne(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(xe,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/metro",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/metro","/service-worker.js");je?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ne(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):Ne(t,e)}))}}()}},[[104,1,2]]]);
//# sourceMappingURL=main.f17d3ddc.chunk.js.map