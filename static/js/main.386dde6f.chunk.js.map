{"version":3,"sources":["components/SimplePanel.jsx","components/AccentTypes.jsx","components/SoundMachineInstrument.jsx","components/PlayModes.jsx","components/PlaybackModes.jsx","components/Instruments.jsx","components/Locale.jsx","components/PresetsLib.jsx","components/InstrumentLib.jsx","localization/pl-pl.jsx","components/SimpleProgress.jsx","components/Utils.jsx","components/Planner.jsx","components/EditPresetModal.jsx","components/PresetsManager.jsx","components/SvgClock.jsx","components/Sliders/GeometricSlider.jsx","components/Sliders/AdvancedRange.jsx","components/Sliders/AdvancedSlider.jsx","components/Sliders/DiscreteSlider.jsx","components/ModePanel.jsx","components/TrackView/TrackRow.jsx","components/TrackView/TrackView.jsx","components/SoundMachine.jsx","App.jsx","serviceWorker.js","index.js"],"names":["SimplePanel","Container","className","this","props","Row","title","children","Component","defaultProps","AccentNotes","accentTypes","Object","keys","map","item","idx","accentColor","0","1","2","3","4","5","6","SoundMachineInstrument","onReadyCb","samples","length","Error","samplerMapping","file","baseUrl","key","onload","label","Sampler","onReady","PlayModes","PlaybackModes","Instruments","TABLA","ELECTRO_KIT","METRONOME","BASIC_DRUM_KIT","YAMAHA_RX5","InstrumentsByKey","locale","InstrumentsArray","PresetsLib","instrumentKey","playMode","byTimeInterval","bpmStep","bpmRange","track","playbackMode","byBarInterval","stepsNum","isHidden","InitPreset","exerciseTime","InstrumentLib","state","lib","currentInstrumentKey","undefined","fft","setInstrument","smi","onInstrumentReady","toMaster","getInstrument","loadInstrument","pl","GetNavigatorLanguage","navigator","languages","userLanguage","language","browserLanguage","Tr","text","TrRange","number","l","SimpleProgress","style","width","value","display","Utils","toLocaleDateTime","dateTime","Date","toLocaleString","dateStyle","timeStyle","padTime","t","formatTime","timeInSeconds","formatTimeFull","formatTimeLong","hLabel","mLabel","sLabel","usePad","setSeconds","h","getHours","m","getMinutes","s","getSeconds","o","trim","storageAvailable","type","storage","window","x","setItem","removeItem","e","DOMException","code","name","Planner","steps","currentStepIdx","stepProgress","planProgress","isUpDown","isPaused","barRender","b","cls","stepIdx","onClick","startStep","duration","Infinity","durationFormatted","durationBars","Math","floor","bpm","toFixed","segments","max","segment","push","constantBpmSlider","rev","slice","reverse","shift","concat","isRandom","shuffle","array","temporaryValue","randomIndex","currentIndex","random","setState","stepChanged","step","getStep","transport","ticks","startTimeTicks","Tone","Time","toTicks","endTime","clamp","min","config","plan","makePlan","baseBpm","timeSignature","events","totalPlanTime","i","beatDuration","schedule","time","onPlanStep","durationInBars","bar","calcTimeForBpm","onPlanEnd","prevState","seconds","getCurrentStep","newPlaybackMode","onChange","height","overflow","Collapse","isOpen","ButtonGroup","size","Button","outline","onPlaybackChange","active","onUpDownBtn","onRandomBtn","NaN","EditPresetModal","modal","nestedModal","preset","presetId","showDelete","toggle","toggleNested","onSave","newTitle","target","onDeleteBtn","color","marginTop","onSaveBtn","Modal","ModalHeader","ModalBody","Input","titleChanged","placeholder","defaultValue","JSON","stringify","ModalFooter","handleDelete","handleSave","renderDelete","PresetsManager","showEdit","userPresets","storedPresets","localStorage","getItem","parse","Array","fill","interval","instrument","accents","onSelect","validatePreset","apply","p","savedDtm","findIndex","saveInLocalStorage","presets","newPresets","splice","getPreset","refs","presetEditor","edit","onPresetClick","Col","textAlign","xs","onPresetEdit","userPresetsJson","renderUserPresets","justifyContent","ref","onPresetDelete","onSavePreset","SvgClock","colorEmpty","strokeColor","strokeWidth","progress","line","transform","percent","r","cos","PI","y","sin","radius","filter","pctStep","slices","forEach","trackColumn","indexOf","cumulativePercent","paths","getCoordinatesForPercent","startX","startY","endX","endY","largeArcFlag","pathData","join","d","stroke","labels","accent","textAnchor","radiusIncrement","circles","drawSvg","cx","cy","el","container","viewBox","svg","drawText","strokeLinecap","x1","y1","x2","y2","GeometricSlider","regression","onMinusClick","newValue","btnStep","onPlusClick","exponential","precision","prepareMarks","marks","marksAt","findX","v","predict","log","equation","Badge","onBadgeClick","badgeFormatter","included","marksNum","marksStyle","desc","markFormatter","AdvancedRange","bounds","Range","AdvancedSlider","Slider","DiscreteSlider","innerValue","innerMarks","values","prevProps","theValue","sliderValue","margin","whiteSpace","onSliderChange","ModePanel","currentBpm","bpmStepDropdownOpen","onBpmSliderChange","onAfterChange","newMode","byBarSlider","setValue","byTimeSlider","barsNum","ButtonDropdown","onBpmStepChange","DropdownToggle","caret","DropdownMenu","DropdownItem","onBpmStepSelect","onExerciseTimeSliderChange","10","15","20","30","40","50","60","70","80","90","100","onStepsSliderChange","pushable","onBpmRangeChange","onModeChange","renderSpeedRange","renderTimeSlider","renderStepsSlider","byBarFormatter","onBarIntervalChange","onTimeIntervalChange","renderIncreaseBpmDropdown","200","400","600","800","1000","1200","TrackRow","activeIdx","activeColor","sample","trackRow","backgroundColor","borderColor","TrackView","rowRefs","sampleIdx","columnIdx","newColumn","current","setActive","React","createRef","padding","filterTrack","trackIdx","handleColumnClick","vertical","addBeat","removeBeat","SoundMachine","progressFps","instrumentLib","initialized","Transport","tone","repeat","notes","triggerAttack","trackView","setActiveColumn","loop","setBpm","isNaN","document","documentTitle","onInstrumentSelect","Synth","triggerAttackRelease","Buffer","on","onBufferError","lookAhead","Part","note","start","getConfig","setPlan","initProgressUpdate","modePanel","setInterval","onProgress","cancel","position","setTrack","planner","force","setTimeSignature","pattern","isArray","subItem","removeAll","add","cnt","remove","loopEnd","debug","innerHTML","updateProgress","svgClock","setProgress","stop","instrumentDropdownOpen","mustRecreate","hasInstrument","samplesUsedCnt","newTrack","element","col","subEl","instrumentDropdownLabel","onInstrumentChange","stepBackward","stepForward","handleKeys","onKeyEvent","handleKey","isPlaying","block","renderInstrumentsDropDown","onControlChange","isLengthChanged","onTrackChange","onPresetSelect","App","showMask","ReactGA","initialize","trackingId","gaOptions","cookieDomain","pageview","location","pathname","search","removeLoadMask","href","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","onUpdate","onSuccess","catch","error","ReactDOM","render","getElementById","URL","process","origin","addEventListener","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.386dde6f.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport {Container, Row} from 'reactstrap'\r\n\r\nclass SimplePanel extends Component {\r\n    render() { \r\n        return (\r\n            <Container className={\"pane \" + this.props.className}>\r\n\t\t\t\t<Row className=\"pane-title\">{this.props.title}</Row>\r\n\t\t\t\t<Row className=\"pane-body\">{this.props.children}</Row>\r\n            </Container>\r\n            );\r\n    }\r\n}\r\n \r\nexport default SimplePanel;\r\n\r\n\r\nSimplePanel.defaultProps = {\r\n    title: 'title',\r\n    children: [],\r\n    className: ''\r\n };","// internal set of notes that will trigger samples on sampler\r\nexport const AccentNotes = [\"C3\", \"C#3\", \"D3\", \"D#3\", \"E3\", \"F3\", \"F#3\"];\r\n\r\n\r\nconst accentTypes = {}\r\nObject.keys(AccentNotes).map(function (item, idx) {\r\n\t   accentTypes[ \"accent_\" + idx ] = idx;\r\n\t   return true;\r\n});\r\nexport {accentTypes};\r\n\r\n// set of colors for accents\r\nexport const accentColor = {\t\r\n\t0: '#ff6355',\r\n\t1: '#ff7155',\r\n\t2: '#ff8055',\r\n\t3: '#ff8e55',\r\n\t4: '#ff9955',\r\n\t5: '#ff9c55',\r\n\t6: '#ffaa55'\r\n}","import { Sampler } from 'tone'\r\nimport { AccentNotes } from './AccentTypes';\r\n\r\n\r\nclass SoundMachineInstrument extends Sampler {\r\n\r\n    constructor(props, onReadyCb) {\r\n        // console.log('<SoundMachineInstrument>constructor', props.key)\r\n        \r\n        if (props.samples.length > AccentNotes.length) {\r\n            throw new Error(\"Limited to \" + AccentNotes.length + \" samples per instrument\")\r\n        }\r\n\r\n        let samplerMapping = {}\r\n        props.samples.map(function (item, idx) {\r\n            samplerMapping[ AccentNotes[idx] ] = item.file;\r\n            // expected to return a value in function\r\n            return true;\r\n        })\r\n\r\n        super(samplerMapping, {\r\n            baseUrl: props.baseUrl || './audio/' + props.key + '/',\r\n            onload: () => onReadyCb(this)\r\n        });\r\n        this.key = props.key;\r\n        this.label = props.label;\r\n        this.samples = props.samples;\r\n    }\r\n}\r\n\r\nexport default SoundMachineInstrument;\r\n\r\nSoundMachineInstrument.defaultProps = {\r\n    onReady: function () { }\r\n}","\r\n// NOTE: If we change any of existing string names we will screw up user presets on client's side\r\nexport const PlayModes = {\r\n\tBY_BAR: \"by_bar\",\r\n\tBY_TIME: \"by_time\",\r\n\tSET_TIME: \"set_time\",\r\n\tCONSTANT: \"constant\"\r\n};","export const PlaybackModes = {\r\n\tSTOP: \"stop\",\r\n\tCYCLE: \"cycle\",\r\n\tREPEAT: \"repeat\",\r\n\tCONTINUE: \"continue\"\r\n};","export const Instruments = {\r\n    TABLA: {\r\n        key: 'tabla',\r\n        label: 'Tabla',\r\n        samples: [{\r\n            file: \"dha-slide.wav\",\r\n            label: \"Dha\",\r\n            idx: 0\r\n        }, {\r\n            file: \"dhin-slide.wav\",\r\n            label: \"Dhin\",\r\n            idx: 1\r\n        }, {\r\n            file: \"tin.wav\",\r\n            label: \"Tin\",\r\n            idx: 2\r\n        }]\r\n    },\r\n    ELECTRO_KIT: {\r\n        key: 'electrokit',\r\n        label: 'Electronic Kit',\r\n        samples: [{\r\n            file: \"Kick.wav\",\r\n            label: \"Kick\",\r\n            idx: 0\r\n        }, {\r\n            file: \"Snare.wav\",\r\n            label: \"Snare\",\r\n            idx: 1\r\n        }, {\r\n            file: \"HiHat.wav\",\r\n            label: \"Hi Hat\",\r\n            idx: 2\r\n        }]\r\n    },\r\n    METRONOME: {\r\n        key: 'metronome',\r\n        label: 'Metronome',\r\n        samples: [{\r\n            file: \"tap.wav\",\r\n            label: \"Tap\",\r\n            idx: 0\r\n        }, {\r\n            file: \"down.wav\",\r\n            label: \"Down\",\r\n            idx: 1\r\n        }, {\r\n            file: \"up.wav\",\r\n            label: \"Up\",\r\n            idx: 2\r\n        }]\r\n    },\r\n    BASIC_DRUM_KIT: {\r\n        key: 'basicdrumkit',\r\n        label: 'Basic Drum Kit',\r\n        samples: [{\r\n            file: \"Kick.wav\",\r\n            label: \"Kick\",\r\n            // color:  colors[0],\r\n            idx: 0\r\n        }, {\r\n            file: \"Snare.wav\",\r\n            label: \"Snare\",\r\n            // color:  colors[3],\r\n            idx: 1\r\n        }, {\r\n            file: \"ClosedHat.wav\",\r\n            label: \"Closed Hat\",\r\n            // color:  colors[2],\r\n            idx: 2\r\n        }, {\r\n            file: \"OpenHat.wav\",\r\n            label: \"Open Hat\",\r\n            // color:  colors[1],\r\n            idx: 3\r\n        }]\r\n    },\r\n    YAMAHA_RX5: {\r\n        key: 'yamaha_rx5',\r\n        label: 'Yamaha RX 5',\r\n        samples: [{\r\n            file: \"Kick.wav\",\r\n            label: \"Kick\",\r\n            // color:  colors[0],\r\n            idx: 0\r\n        }, {\r\n            file: \"Rim.wav\",\r\n            label: \"Rim\",\r\n            // color:  colors[3],\r\n            idx: 1\r\n        }, {\r\n            file: \"Ride.wav\",\r\n            label: \"Ride\",\r\n            // color:  colors[2],\r\n            idx: 2\r\n        }, {\r\n            file: \"Cowbell.wav\",\r\n            label: \"Cowbell\",\r\n            // color:  colors[1],\r\n            idx: 3\r\n        }, {\r\n            file: \"Shaker.wav\",\r\n            label: \"Shaker\",\r\n            // color:  colors[1],\r\n            idx: 4\r\n        }]\r\n    }\r\n};\r\n\r\n\r\nconst InstrumentsByKey = {}\r\nObject.keys(Instruments).map(function (item, idx) {\r\n    InstrumentsByKey[ Instruments[item].key ] = Instruments[item];\r\n    // expected to return a value from arrow func\r\n    return true;\r\n});\r\nexport {InstrumentsByKey};\r\n\r\nexport const InstrumentsArray = Object.keys(Instruments)\r\n.map(item => {\r\n    return Instruments[item]\r\n});\r\n","import pl from '../localization/pl-pl'\r\n// import it from '../localization/it-it'\r\n\r\n// A bit rough attempt to i18n\r\nexport function GetNavigatorLanguage() {\r\n    return (navigator.languages && navigator.languages.length) ? navigator.languages[0] : navigator.userLanguage || navigator.language || navigator.browserLanguage || 'en';\r\n}\r\n\r\n// set language for the app\r\nlet locale;\r\nswitch ( GetNavigatorLanguage() )\r\n{\r\n    case 'pl': \r\n    case 'pl-PL': \r\n    case 'pl-pl': \r\n        locale = pl;\r\n        break;\r\n    default: \r\n        locale = {};    // this will default to en\r\n        break;\r\n}\r\n\r\nfunction Tr(text) {\r\n    if (locale[text]) {\r\n        return locale[text];\r\n    }\r\n    else {\r\n        return text;\r\n    }\r\n}\r\nexport default Tr;\r\n\r\nexport function TrRange(number, label) {\r\n    if (!locale[label]) {\r\n        return label\r\n    }\r\n    else if (locale[label][number]) {\r\n        return locale[label][number]\r\n    }\r\n    else {\r\n        const l =  locale[label];\r\n        // If it's not specified then return last defined term \r\n        // Bit dodgy, but should do the job. \r\n        return l[Object.keys(l)[Object.keys(l).length -1]]\r\n    }\r\n}\r\n\r\n\r\n","import {PlayModes} from \"./PlayModes\"\r\nimport {PlaybackModes} from \"./PlaybackModes\"\r\nimport { Instruments }  from \"./Instruments\"; // TODO get rid of old lowercase 'instruments'\r\n\r\nexport const PresetsLib = [\r\n    {title: \"Metronome 2/4\", \"bpmStep\":20,\"bpmRange\":[100,200],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":60,\"byBarInterval\":2,\"constantBpmSlider\":300,\"interval\":300,\"track\":[[2],[1]],\"instrumentKey\":\"metronome\"},\r\n\r\n    {\r\n        title: \"Metronome 4/4\",\r\n        instrumentKey: Instruments.METRONOME.key,\r\n        playMode: PlayModes.BY_TIME,\r\n        byTimeInterval: 60,\r\n        bpmStep: 20,\r\n        bpmRange: [100, 200],\r\n        track: [[2],[1],[1],[1]]\r\n    },\r\n    {\r\n        title: \"Metronome 3/4\",\r\n        instrumentKey: Instruments.METRONOME.key,\r\n        playMode: PlayModes.BY_TIME,\r\n        byTimeInterval: 60,\r\n        bpmStep: 20,\r\n        bpmRange: [100, 200],\r\n        track: [[2],[1],[1]]\r\n    },\r\n\r\n    {\r\n        title: \"Levee Break\",\r\n        instrumentKey: 'electrokit',\r\n        bpmRange: [300, 400],\r\n        track: [[0,2],[0],[2],[],[1,2],[],[2],[0],[2],[],[0,2],[0],[1,2],[],[2],[]],\r\n        playMode: PlayModes.BY_BAR,\r\n        playbackMode: PlaybackModes.STOP,\r\n        byTimeInterval: 5,\r\n        byBarInterval: 2,\r\n        stepsNum: 10,\r\n        bpmStep: 50,\r\n        isHidden: true\r\n    },\r\n    {\"bpmStep\":50,\"bpmRange\":[300,400],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_bar\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":5,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,2],[],[0,2],[],[2,1],[],[0,2],[],[2,0],[],[2,0],[],[1,2],[],[2,0],[]],\"instrumentKey\":\"electrokit\",\"title\":\"Basic Rock\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[300,400],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_bar\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":5,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,2],[],[2],[],[2,1],[],[2],[0,2],[2,0],[],[0,2],[],[1,2],[],[2,0],[]],\"instrumentKey\":\"electrokit\",\"title\":\"Impeach the President\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[350,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":60,\"byBarInterval\":10,\"constantBpmSlider\":300,\"track\":[[0,2],[2],[0,2],[2],[2,1],[2],[0,2],[3,1],[2],[2,1],[0,2],[2,1],[2,1],[0,3],[2],[2,1]],\"instrumentKey\":\"basicdrumkit\",\"title\":\"Funky Drummer\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[300,400],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_bar\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":5,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,2],[],[2],[],[1,2],[],[2],[0],[2,0],[],[0,2],[],[1,2],[],[2],[]],\"instrumentKey\":\"electrokit\",\"title\":\"Walk This Way\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[300,400],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_bar\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":5,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,2],[],[2,0],[],[1,2],[],[2],[],[2],[],[0,2],[0],[1,2],[],[2],[0]],\"instrumentKey\":\"electrokit\",\"title\":\"It's a New Day\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[300,400],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_bar\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":5,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0],[],[],[0],[1,2],[],[0],[],[0],[],[],[],[1,2],[],[],[]],\"instrumentKey\":\"electrokit\",\"title\":\"The Big Beat\"},\r\n    {\"bpmStep\":20,\"bpmRange\":[300,500],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":50,\"constantBpmSlider\":300,\"interval\":120,\"track\":[[0,2],[],[0,2],[],[1,2],[],[0,2],[],[0,2],[],[0,2],[],[1,2],[],[0,2],[]],\"instrumentKey\":\"basicdrumkit\",\"title\":\"Rock\"},\r\n    {\"bpmStep\":20,\"bpmRange\":[528,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"constant\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":50,\"constantBpmSlider\":600,\"interval\":120,\"track\":[[0],[],[3],[],[1,0],[],[3],[],[0],[2],[3],[],[1,0],[],[0,3],[]],\"instrumentKey\":\"basicdrumkit\",\"title\":\"Techno\"},\r\n    {\"bpmStep\":20,\"bpmRange\":[528,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"constant\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":50,\"constantBpmSlider\":400,\"interval\":120,\"track\":[[0,2],[],[2],[],[1,2],[],[2],[0],[2],[],[0,2],[],[1,2],[0],[2],[0]],\"instrumentKey\":\"basicdrumkit\",\"title\":\"Hip Hop\"},\r\n\r\n    // Afro-Cuban\r\n    {\"bpmStep\":50,\"bpmRange\":[400,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":2,\"constantBpmSlider\":300,\"interval\":120,\"track\":[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[1,2],[0,2],[0,2],[2],[1,2],[0,2],[1,2,0],[2],[2],[0,2]],\"instrumentKey\":\"yamaha_rx5\",\"title\":\"Son Clave\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[400,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[2],[0,2,1],[0,2],[2],[2,1],[0,2],[2,0,1],[2],[2],[0,2]],\"instrumentKey\":\"yamaha_rx5\",\"title\":\"Rumba\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[400,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,1,2],[2],[2],[0,1,2],[2,0],[2],[2,1],[0,2],[0,2],[2],[2,1],[0,2],[2,0],[2,1],[2],[0,2]],\"instrumentKey\":\"yamaha_rx5\",\"title\":\"Bossa Nova\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[400,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,1,3],[],[],[1,3],[0],[],[1,3],[],[0,1],[3],[3],[1],[0],[],[0,1],[]],\"instrumentKey\":\"yamaha_rx5\",\"title\":\"Soukous\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[400,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,3],[],[1],[1,3],[0],[],[1,3],[1],[0],[],[3,1],[1],[0],[],[0,1,3],[1]],\"instrumentKey\":\"yamaha_rx5\",\"title\":\"Gahu\"},\r\n    {\"bpmStep\":50,\"bpmRange\":[400,600],\"currentBpm\":300,\"playbackMode\":\"stop\",\"playMode\":\"by_time\",\"stepsNum\":10,\"exerciseTime\":1800,\"bpmStepDropdownOpen\":false,\"byTimeInterval\":120,\"byBarInterval\":2,\"constantBpmSlider\":300,\"track\":[[0,3],[],[1],[1],[0,3],[],[1,3,0],[1],[0],[],[3,1],[1],[0,3],[],[0,1],[1]],\"instrumentKey\":\"yamaha_rx5\",\"title\":\"Shiko\"},\r\n\r\n\r\n    // ancient ones, but leave them for compaitibility\r\n    {title: \"Balkan 1\", \"bpmRange\":[241,400],\"accents\":[0,2,1,0,2,1,2],\"instrument\":Instruments.ELECTRO_KIT,\"playMode\":\"by_bar\",\"interval\":20,\"bpmStep\":30},\r\n    {title: \"Balkan 2\", \"bpmRange\":[293,400],\"accents\":[0,1,2,0,1,2,1],\"instrument\":Instruments.TABLA,\"playMode\":\"by_bar\",\"interval\":300,\"bpmStep\":50},\r\n    {title: \"Groove 1\", \"bpmRange\":[222,262],\"accents\":[0,1,2,1,2,0,2,2],\"instrument\":Instruments.ELECTRO_KIT,\"playMode\":\"by_time\",\"interval\":600,\"bpmStep\":50},\r\n    {title: \"Groove 2\", \"bpmRange\":[222,400],\"accents\":[0,1,0,1,1,1,0,2],\"instrument\":Instruments.ELECTRO_KIT,\"playMode\":\"by_bar\",\"interval\":20,\"bpmStep\":50},\r\n\r\n];\r\n \r\nexport const InitPreset = {\r\n    title: \"Initialization setting\",\r\n    instrumentKey: Instruments.ELECTRO_KIT.key,\r\n    bpmRange: [300, 400],\r\n    track: [[0,2],[0],[2],[],[1,2],[],[2],[0],[2],[],[0,2],[0],[1,2],[],[2],[]],    // Levee Break\r\n    // accents: [1, 0, 0, 0,0 ,0,0,0,0],\r\n    playMode: PlayModes.SET_TIME,\r\n    playbackMode: PlaybackModes.STOP,\r\n    byTimeInterval: 5,\r\n    byBarInterval: 2,\r\n    stepsNum: 10,\r\n    exerciseTime: 600,\r\n    // constantBpmSlider: 300,\r\n    bpmStep: 20,\r\n    isHidden: true\r\n}\r\n","import { Component } from \"react\";\r\nimport SoundMachineInstrument from \"./SoundMachineInstrument\"\r\nimport { InitPreset } from \"./PresetsLib\";\r\nimport {InstrumentsByKey} from \"./Instruments\"\r\n\r\nclass InstrumentLib extends Component {\r\n    state = {};\r\n    lib = {};\r\n    currentInstrumentKey = undefined\r\n    fft = undefined\r\n\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        // this.fft = new Tone.FFT(128);\r\n\r\n        //Tone.Buffer.on(\"load\", () => this.onBufferLoaded());\r\n        \r\n        // InstrumentsArray.map((instrument) => {\r\n        //     var smi = new SoundMachineInstrument({\r\n        //         key: instrument.key,\r\n        //         label: instrument.label,\r\n        //         samples: instrument.samples\r\n        //     });\r\n        //     this.lib[instrument.key] = smi;\r\n\r\n        //     // connect instruments to FFT analyzer\r\n        //     // smi.fan(this.fft).toMaster();\r\n            \r\n        //     // expected a return value from arrow func\r\n        //     return true;\r\n        // })\r\n\r\n        this.setInstrument(InitPreset.instrumentKey)\r\n    }\r\n\r\n\r\n    loadInstrument(instrumentKey) {\r\n        if (InstrumentsByKey[instrumentKey] === undefined) {\r\n            throw new Error(\"Invalid instrumentKey: \" + instrumentKey)\r\n        }\r\n        new SoundMachineInstrument(InstrumentsByKey[instrumentKey], (smi) => this.onInstrumentReady(smi));\r\n    }\r\n\r\n    onInstrumentReady(smi) {\r\n        this.lib[smi.key] = smi;\r\n        this.currentInstrumentKey = smi.key;\r\n        smi.toMaster()\r\n        this.props.onInstrumentReady(smi)\r\n    }\r\n\r\n\r\n    hasInstrument(instrumentKey) {\r\n        return this.lib[instrumentKey] !== undefined;\r\n    }\r\n\r\n    \r\n    setInstrument(instrumentKey) {\r\n        if (this.lib[instrumentKey] === undefined) {\r\n            this.loadInstrument(instrumentKey)    \r\n        }\r\n        else {\r\n            this.currentInstrumentKey = instrumentKey;\r\n            return this.getInstrument();\r\n        }\r\n        \r\n    }\r\n\r\n    getInstrument(instrumentKey) {\r\n        if (this.lib[instrumentKey] === undefined) {\r\n            throw new Error(\"Instrument not loaded \" + instrumentKey)\r\n        }\r\n        return this.lib[instrumentKey]\r\n    }\r\n\r\n}\r\nexport default InstrumentLib;\r\n","const pl = {\r\n    /* App */\r\n    \"arrow up/down\": \"strzałki góra/dół\",\r\n    \"higher/lower BPM\": \"zwiększ/zmniejsz BPM\",\r\n    \"arrow left/right\": \"strzałki lewa/prawa\",\r\n    \"previous/next step according to plan\": \"poprzedni/następny krok wg planu\",\r\n    \"start/stop\": \"zacznij/zatrzymaj\",\r\n    \"stop\": \"zatrzymaj\",\r\n\r\n    /* SoundMachine */\r\n    \"Control\": \"Kontrola\",\r\n    \"Start / Stop\": \"Zacznij / Zatrzymaj\",\r\n    \"Instrument\": \"Instrument\",\r\n    \"Mode\": \"Tryb\",\r\n    \"Increase speed\": \"Zwiększaj prędkość\",\r\n    \"BPM range\": \"Zakres BPM\",\r\n    \"By bar\": \"Co kilka taktów\",\r\n    \"bar\": \"takt\",\r\n    \"By time\": \"Co jakiś czas\",\r\n    \"Set time\": \"W ustalonym czasie ćwiczeń\",\r\n    \"Stable\": \"Nie zwiększaj\",\r\n    \"Increase speed every\": \"Zwiększ prędkość co\",\r\n    \"Number of steps\": \"Ilość kroków\",\r\n    \"Up and Down\": \"Szybciej i wolniej\",\r\n    \"Shuffle\": \"Losowo\",\r\n    \"Exercise Time\": \"Czas ćwiczenia\",\r\n    \"Total time:\": \"Całkowity czas:\",\r\n\r\n    /* Planner */\r\n    \"Stop\": \"Zatrzymaj\",\r\n    \"Continue\": \"Kontynuuj\",\r\n    \"Repeat\": \"Od początku\",\r\n    \"After plan\": \"Po zakończeniu\",\r\n    \"Step order\": \"Kolejność\",\r\n\r\n    \"Plan progress\": \"Postęp planu\",\r\n    \"Step progress\": \"Postęp kroku\",\r\n\r\n    /* Presets */\r\n    \"Title\": \"Nazwa\",\r\n    \"Save current settings\": \"Zapisz bieżące ustawienia\",\r\n    \"Edit\": \"Edytuj\",\r\n    \"User presets\": \"Zapisane ustawienia\",\r\n    \"Presets\": \"Presety\",\r\n    \"Delete\": \"Usuń\",\r\n    \"Save Preset\": \"Zapisz Ustawienia\",\r\n    \"Cancel\": \"Anuluj\",\r\n    \"Are you sure?\": \"Czy aby na pewno?\",\r\n    \"Are you sure to delete current preset?\": \"Czy jesteś pewien, że chcesz usunąć to ustawienie?\",\r\n    \"Save\": \"Zapisz\",\r\n\r\n    /* TrackView */\r\n    \"Sequencer\": \"Sekwencer\",\r\n\r\n    /* Keyboard control panel */\r\n    \"Keyboard controls\": \"Skróty klawiszowe\",\r\n\r\n    /* Utils */\r\n    \"bars\": {\r\n        1: \"takt\",\r\n        2: \"takty\",\r\n        3: \"takty\",\r\n        4: \"takty\",\r\n        5: \"taktów\"\r\n    },\r\n\r\n    \"hours\": {\r\n        1: \"godzina\",\r\n        2: \"godziny\",\r\n        3: \"godziny\",\r\n        4: \"godziny\",\r\n        5: \"godzin\"\r\n    },\r\n\r\n    \"minutes\": {\r\n        1: \"minuta\",\r\n        2: \"minuty\",\r\n        3: \"minuty\",\r\n        4: \"minuty\",\r\n        5: \"minut\"\r\n    },\r\n\r\n    \"seconds\": {\r\n        1: \"sekunda\",\r\n        2: \"sekundy\",\r\n        3: \"sekundy\",\r\n        4: \"sekundy\",\r\n        5: \"sekund\"\r\n    },\r\n\r\n    \"hr\": \"godz.\",\r\n    \"hrs\": \"godz.\"\r\n}\r\n\r\nexport default pl;","import React, { Component } from 'react';\r\nimport {Container} from 'reactstrap';\r\n\r\nclass SimpleProgress extends Component {\r\n    state = {  }\r\n    render() { \r\n        return ( <Container className=\"SimpleProgress\">\r\n            <div className=\"bar\" style={{width: this.props.value  + \"%\", display: 'block'}} />\r\n        </Container> );\r\n    }\r\n}\r\n \r\nexport default SimpleProgress;","import { TrRange, GetNavigatorLanguage } from './Locale'\r\n\r\nconst Utils = {\r\n\r\n\ttoLocaleDateTime: function (dateTime) {\r\n\t\t// safety\r\n\t\tif (!dateTime) return '';\r\n\r\n\t\t// go for it\r\n\t\treturn new Date(dateTime).toLocaleString(GetNavigatorLanguage(), {\r\n\t\t\tdateStyle: \"long\",\r\n\t\t\ttimeStyle: \"short\"\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tpadTime: function (t) {\r\n\t\treturn t < 10 ? \"0\" + t : t;\r\n\t},\r\n\r\n\tformatTime: function (timeInSeconds) {\r\n\t\tif (timeInSeconds) {\r\n\t\t\treturn Utils.formatTimeFull(timeInSeconds, 'h', 'm', 's', true);\r\n\t\t}\r\n\t},\r\n\r\n\tformatTimeLong: function (timeInSeconds) {\r\n\t\tif (timeInSeconds) {\r\n\t\t\treturn Utils.formatTimeFull(timeInSeconds, 'hours', 'minutes', 'seconds', false);\r\n\t\t}\r\n\t},\r\n\r\n\tformatTimeFull: function (timeInSeconds, hLabel, mLabel, sLabel, usePad) {\r\n\t\tlet t = new Date(0, 0, 0, 0, 0, 0, 0);\r\n\t\tt.setSeconds(timeInSeconds);\r\n\t\tconst h = t.getHours();\r\n\t\tconst m = t.getMinutes();\r\n\t\tconst s = t.getSeconds();\r\n\r\n\t\tlet o = \"\";\r\n\r\n\t\tif (h !== 0) {\r\n\t\t\to += h + ' ' + TrRange(h, hLabel) + \" \";\r\n\t\t}\r\n\r\n\t\tif (m !== 0 || h !== 0) {\r\n\t\t\tif (h !== 0 && m !== 0) {\r\n\t\t\t\to += (usePad ? Utils.padTime(m) : m) + ' ' + TrRange(m, mLabel) + \" \";\r\n\t\t\t}\r\n\t\t\telse if (m !== 0) {\r\n\t\t\t\to += (usePad ? Utils.padTime(m) : m) + ' ' + TrRange(m, mLabel) + \" \";\r\n\t\t\t}\r\n\t\t\tif (s !== 0) {\r\n\t\t\t\to += \"\" + (usePad ? Utils.padTime(s) : s) + ' ' + TrRange(s, sLabel)\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\to += t.getSeconds() + ' ' + TrRange(s, sLabel)\r\n\t\t}\r\n\t\treturn o.trim();\r\n\t},\r\n\r\n\tstorageAvailable: function (type) {\r\n\t\tvar storage;\r\n\t\ttry {\r\n\t\t\tstorage = window[type];\r\n\t\t\tvar x = '__storage_test__';\r\n\t\t\tstorage.setItem(x, x);\r\n\t\t\tstorage.removeItem(x);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\treturn e instanceof DOMException && (\r\n\t\t\t\t// everything except Firefox\r\n\t\t\t\te.code === 22 ||\r\n\t\t\t\t// Firefox\r\n\t\t\t\te.code === 1014 ||\r\n\t\t\t\t// test name field too, because code might not be present\r\n\t\t\t\t// everything except Firefox\r\n\t\t\t\te.name === 'QuotaExceededError' ||\r\n\t\t\t\t// Firefox\r\n\t\t\t\te.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\r\n\t\t\t\t// acknowledge QuotaExceededError only if there's something already stored\r\n\t\t\t\t(storage && storage.length !== 0);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default Utils;","import React, { Component } from \"react\";\r\nimport Tone from 'tone'\r\nimport Tr, {TrRange} from './Locale'\r\nimport { Collapse, ButtonGroup, Button } from \"reactstrap\";\r\nimport SimplePanel from \"./SimplePanel\"\r\nimport { PlayModes } from \"./PlayModes\";\r\nimport { PlaybackModes } from \"./PlaybackModes\";\r\nimport SimpleProgress from \"./SimpleProgress\";\r\nimport Utils from \"./Utils\";\r\nimport { InitPreset } from \"./PresetsLib\";\r\n\r\n// import Control from \"./Control\"\r\nclass Planner extends Component {\r\n\tstate = {\r\n\t\tplaybackMode: this.props.playbackMode,\r\n\t\tplayMode: this.props.playMode,\r\n\t\tsteps: [],\r\n\t\tcurrentStepIdx: this.props.currentStepIdx,\r\n\t\tstepProgress: 0,\r\n\t\tplanProgress: 0,\r\n\t\tisUpDown: false,\r\n\t\tisPaused: false\r\n\t};\r\n\r\n\tmakePlan(s) {\r\n\t\tlet segments = [];\r\n\t\t// some helpful variables\r\n\t\tconst max = s.bpmRange[1];\r\n\t\tlet bpm = s.bpmRange[0];\r\n\r\n\t\tif (s.playMode === PlayModes.BY_BAR) {\r\n\t\t\twhile (bpm <= max) {\r\n\t\t\t\tconst segment = {\r\n\t\t\t\t\tbpm: bpm,\r\n\t\t\t\t\tduration: s.byBarInterval\r\n\t\t\t\t};\r\n\t\t\t\tsegments.push(segment);\r\n\t\t\t\tbpm += s.bpmStep;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (s.playMode === PlayModes.BY_TIME) {\r\n\t\t\twhile (bpm <= max) {\r\n\t\t\t\tconst segment = {\r\n\t\t\t\t\tduration: s.byTimeInterval,\r\n\t\t\t\t\tbpm: bpm\r\n\t\t\t\t};\r\n\t\t\t\tsegments.push(segment);\r\n\t\t\t\tbpm += s.bpmStep;\r\n\t\t\t}\r\n\t\t} else if (s.playMode === PlayModes.CONSTANT) {\r\n\t\t\tconst segment = {\r\n\t\t\t\tduration: Infinity,\r\n\t\t\t\tbpm: s.constantBpmSlider\r\n\t\t\t};\r\n\t\t\tsegments.push(segment);\r\n\t\t}\r\n\t\telse if (s.playMode === PlayModes.SET_TIME) {\r\n\t\t\tconst duration = s.exerciseTime  / (s.stepsNum );\r\n\t\t\t\r\n\t\t\tlet bpm = s.bpmRange[0];\r\n\t\t\tconst bpmStep = (s.bpmRange[1] - s.bpmRange[0]) / (s.stepsNum -1 );\r\n\t\t\twhile (bpm <= max) {\r\n\t\t\t\tconst segment = {\r\n\t\t\t\t\tduration: duration,\r\n\t\t\t\t\tbpm: bpm\r\n\t\t\t\t};\r\n\t\t\t\tsegments.push(segment);\r\n\t\t\t\tbpm += bpmStep;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.state.isUpDown) {\r\n\t\t\tconst rev = segments.slice().reverse();\r\n\t\t\trev.shift()\r\n\t\t\tsegments = segments.concat(rev);\r\n\t\t}\r\n\t\tif (this.state.isRandom) {\r\n\t\t\tsegments = this.shuffle(segments.slice())\r\n\t\t}\r\n\t\treturn segments;\r\n\t}\r\n\r\n\tshuffle(array) {\r\n\t\tvar currentIndex = array.length, temporaryValue, randomIndex;\r\n\r\n\t\t// While there remain elements to shuffle...\r\n\t\twhile (0 !== currentIndex) {\r\n\r\n\t\t\t// Pick a remaining element...\r\n\t\t\trandomIndex = Math.floor(Math.random() * currentIndex);\r\n\t\t\tcurrentIndex -= 1;\r\n\r\n\t\t\t// And swap it with the current element.\r\n\t\t\ttemporaryValue = array[currentIndex];\r\n\t\t\tarray[currentIndex] = array[randomIndex];\r\n\t\t\tarray[randomIndex] = temporaryValue;\r\n\t\t}\r\n\r\n\t\treturn array;\r\n\t}\r\n\r\n\tonPlanStep(idx) {\r\n\t\tthis.setState({ currentStepIdx: idx }, this.stepChanged)\r\n\t}\r\n\r\n\tupdateProgress() {\r\n\t\tconst step = this.getStep(this.state.currentStepIdx);\r\n\t\tconst stepProgress = (this.props.transport.ticks - step.startTimeTicks) / (Tone.Time(step.duration).toTicks());\r\n\t\tconst planProgress =  this.props.transport.ticks  / this.endTime;\r\n\t\tthis.setState({ stepProgress: this.clamp(stepProgress), planProgress: this.clamp(planProgress) })\r\n\t}\r\n\r\n\tclamp(value, min = 0 , max = 1) {\r\n\t\treturn Math.min(Math.max(value, min), max);\r\n\t}\r\n\r\n\tsetPlan(config, stepIdx = 0) {\r\n\t\tconst plan = this.makePlan(config);\r\n\t\tthis.baseBpm = this.props.transport.bpm.value\r\n\r\n\t\tconst timeSignature = config.track.length;\r\n\t\tlet t = 0;\r\n\t\tthis.events = [];\r\n\t\tlet steps = []\r\n\t\tlet totalPlanTime = 0;\r\n\r\n\t\tfor (let i = 0; i < plan.length; i++) {\r\n\t\t\tconst s = plan[i];\r\n\t\t\tconst beatDuration = 60 / s.bpm;\r\n\r\n\t\t\t// create  step end event\r\n\t\t\tthis.props.transport.schedule((time) => this.onPlanStep(i), t)\r\n\r\n\t\t\tconst duration = config.playMode === PlayModes.BY_BAR ? beatDuration * timeSignature * s.duration : s.duration;\r\n\r\n\t\t\tconst durationInBars = config.playMode === PlayModes.BY_BAR ? s.duration : s.duration / (beatDuration * timeSignature);\r\n\r\n\t\t\tconst bar = {\r\n\t\t\t\tbpm: s.bpm,\r\n\t\t\t\tduration: duration,\r\n\t\t\t\tdurationBars: durationInBars.toFixed(1),\r\n\t\t\t\tdurationFormatted: Utils.formatTime(duration),\r\n\t\t\t\tstepIdx: i,\r\n\t\t\t\ttrack: config.track,\r\n\t\t\t\tplayMode: s.playMode,\r\n\t\t\t\tstartTimeTicks: Tone.Time(t).toTicks()\r\n\t\t\t};\r\n\r\n\r\n\t\t\tswitch (config.playMode) {\r\n\t\t\t\tcase PlayModes.BY_TIME:\r\n\t\t\t\tcase PlayModes.SET_TIME:\r\n\t\t\t\t\tt += this.calcTimeForBpm(s.duration, s.bpm);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase PlayModes.BY_BAR:\r\n\t\t\t\t\tt = s.duration * (i + 1) + \"m\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase PlayModes.CONSTANT:\r\n\t\t\t\t\tt = Infinity\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error('Invalid playMode: ' + config.playMode)\r\n\t\t\t}\r\n\r\n\t\t\ttotalPlanTime += duration\r\n\t\t\tsteps.push(bar);\r\n\r\n\t\t}\r\n\r\n\t\tthis.props.transport.schedule((time) => this.onPlanEnd(time), t);\r\n\t\tthis.endTime = Tone.Time(t).toTicks();\r\n\t\t\r\n\t\tthis.setState(\r\n\t\t\tprevState => ({\r\n\t\t\t\ttotalPlanTime: totalPlanTime,\r\n\t\t\t\t// hmm this is shit as change in currentStepIdx doesn't move transport, this needs some thinking \r\n\t\t\t\tcurrentStepIdx: 0,\r\n\t\t\t\tsteps: steps,\r\n\t\t\t\tplayMode: config.playMode\r\n\t\t\t}),\r\n\t\t\tthis.stepChanged\r\n\t\t);\r\n\t}\r\n\r\n\tcalcTimeForBpm(seconds, bpm) {\r\n\t\treturn Tone.Time(seconds * bpm / this.baseBpm);\r\n\r\n\t}\r\n\r\n\tstartStep(stepIdx) {\r\n\t\tif (this.state.currentStepIdx !== stepIdx) {\r\n\t\t\tconst s = this.getStep(stepIdx);\r\n\t\t\tthis.props.transport.ticks = s.startTimeTicks;\r\n\t\t\tthis.setState({ currentStepIdx: stepIdx }, this.stepChanged)\r\n\t\t}\r\n\t}\r\n\r\n\tgetStep(idx) {\r\n\t\treturn this.state.steps[idx];\r\n\t}\r\n\r\n\tstepForward() {\r\n\t\t// check if we're not at the end of plan\r\n\t\tif (this.state.currentStepIdx + 1 < this.state.steps.length) {\r\n\t\t\tthis.startStep(this.state.currentStepIdx + 1)\r\n\t\t}\r\n\t}\r\n\r\n\tstepBackward() {\r\n\t\tif (this.state.currentStepIdx - 1 >= 0) {\r\n\t\t\tthis.startStep(this.state.currentStepIdx - 1)\r\n\t\t}\r\n\t}\r\n\r\n\tonPlanEnd(time) {\r\n\t\tif (this.state.playbackMode === PlaybackModes.STOP) {\r\n\t\t\tthis.props.onPlanEnd();\r\n\t\t}\r\n\t\telse if (this.state.playbackMode === PlaybackModes.REPEAT) {\r\n\t\t\tthis.startStep(0)\r\n\t\t}\r\n\t}\r\n\tstepChanged() {\r\n\t\tconst bpm = this.getCurrentStep().bpm\r\n\t\tthis.props.onPlanStep(bpm)\r\n\t}\r\n\r\n\tgetCurrentStep() {\r\n\t\tif (this.state.currentStepIdx >= this.state.steps.length) {\r\n\t\t\tthrow new Error(\"Trying to get step that doesn't exists\");\r\n\t\t}\r\n\t\treturn this.state.steps[this.state.currentStepIdx];\r\n\t}\r\n\r\n\tonPlaybackChange(newPlaybackMode) {\r\n\t\tthis.setState({ playbackMode: newPlaybackMode }, this.props.onChange);\r\n\t}\r\n\r\n\tbarRender = b => {\r\n\t\tconst cls = this.state.currentStepIdx === b.stepIdx ? \"current-step\" : \"\";\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tonClick={() => this.startStep(b.stepIdx)}\r\n\t\t\t\tclassName={\"step clickable \" + cls}\r\n\t\t\t\tkey={\"key_\" + b.stepIdx}\r\n\t\t\t>\r\n\t\t\t\t{\r\n\t\t\t\t\tb.duration !== Infinity\r\n\t\t\t\t\t\t? <>{b.durationFormatted} ({b.durationBars} {TrRange(Math.floor(b.durationBars),\"bars\")}) </>\r\n\t\t\t\t\t\t: ''}\r\n\t\t\t\t@ {b.bpm.toFixed(0)} bpm\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tonUpDownBtn() {\r\n\t\tthis.setState({ isUpDown: !this.state.isUpDown, isRandom: false }, this.props.onChange)\r\n\t}\r\n\r\n\tonRandomBtn() {\r\n\t\tthis.setState({ isRandom: !this.state.isRandom, isUpDown: false }, this.props.onChange)\r\n\t}\r\n\trender() {\r\n\t\tif (this.state.playMode === PlayModes.CONSTANT) {\r\n\t\t\treturn <div/>\r\n\t\t}\r\n\t\treturn (\r\n\r\n\t\t\t<SimplePanel title={\"Plan\"}>\r\n\t\t\t\t<div className=\"Planner\">\r\n\t\t\t\t\t{/* <div>Next step in {this.state.stepProgress.toFixed(1)} seconds</div> */}\r\n\t\t\t\t\t<div>{Tr(\"Step progress\")} <SimpleProgress value={this.state.stepProgress * 100} /></div>\r\n\t\t\t\t\t<div>{Tr(\"Plan progress\")} <SimpleProgress value={this.state.planProgress * 100} /></div>\r\n\r\n\t\t\t\t\t{/* <Button onClick={() => this.togglePause()}>\r\n\t\t\t\t\tisPaused:\r\n\t\t\t\t\t{this.state.isPaused === true ? \"paused\" : \"normal\"}\r\n\t\t\t\t</Button> */}\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div style={{height: '200px', overflow: 'auto'}}>\r\n\t\t\t\t\t\t{this.state.steps.map(bar => this.barRender(bar))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{Tr(\"Total time:\")} {Utils.formatTime(this.state.totalPlanTime)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Collapse isOpen={this.state.playMode !== PlayModes.CONSTANT}>\r\n\t\t\t\t\t<div>{Tr(\"After plan\")}</div>\r\n\t\t\t\t\t<ButtonGroup size=\"sm\">\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tonClick={() => this.onPlaybackChange(PlaybackModes.STOP)}\r\n\t\t\t\t\t\t\tactive={this.state.playbackMode === PlaybackModes.STOP}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{Tr(\"Stop\")}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tonClick={() => this.onPlaybackChange(PlaybackModes.CONTINUE)}\r\n\t\t\t\t\t\t\tactive={this.state.playbackMode === PlaybackModes.CONTINUE}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{Tr(\"Continue\")}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tonClick={() => this.onPlaybackChange(PlaybackModes.REPEAT)}\r\n\t\t\t\t\t\t\tactive={this.state.playbackMode === PlaybackModes.REPEAT}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{Tr(\"Repeat\")}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t\t<div>{Tr(\"Step order\")}</div>\r\n\t\t\t\t\t<ButtonGroup>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\tonClick={(e) => this.onUpDownBtn(e)}\r\n\t\t\t\t\t\t\tactive={this.state.isUpDown}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{Tr(\"Up and Down\")}\r\n\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\toutline\r\n\t\t\t\t\t\t\t// toggle\r\n\t\t\t\t\t\t\tonClick={() => this.onRandomBtn()}\r\n\t\t\t\t\t\t\tactive={this.state.isRandom}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{Tr(\"Shuffle\")}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t</Collapse>\r\n\r\n\t\t\t</SimplePanel>\r\n\r\n\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Planner;\r\n\r\nPlanner.defaultProps = {\r\n\tplaybackMode: InitPreset.playbackMode,\r\n\tplayMode: InitPreset.playMode,\r\n\tonChange: () => { },\r\n\tonPlanStep: () => { },\r\n\tonPlanEnd: () => { },\r\n\tcurrentStepIdx: NaN\r\n};\r\n","import React, { Component } from \"react\";\r\nimport {\r\n\tInput,\r\n\tButton,\r\n\tModal,\r\n\tModalHeader,\r\n\tModalBody,\r\n\tModalFooter\r\n} from \"reactstrap\";\r\nimport Tr from \"./Locale\"\r\n\r\nclass EditPresetModal extends Component {\r\n\tstate = {\r\n\t\tmodal: false,\r\n\t\tnestedModal: false,\r\n\t\tpreset: null,\r\n\t\tpresetId: null,\r\n\t\tshowDelete: false\r\n\t};\r\n\r\n\ttoggle = () => {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tmodal: !prevState.modal,\r\n\t\t\tnestedModal: false\r\n\t\t}));\r\n\t}\r\n\r\n\ttoggleNested = () => {\r\n\t\tthis.setState({ nestedModal: !this.state.nestedModal })\r\n\t}\r\n\r\n\r\n\thandleSave() {\r\n\t\tconst preset = this.state.preset;\r\n\t\tconst title = this.state.preset.title;\r\n\t\tif (title && title.length > 0) {\r\n\t\t\tthis.props.onSave(title, preset);\r\n\t\t\tthis.toggle();\r\n\t\t}\r\n\t}\r\n\r\n\tedit(preset, presetId, title) {\r\n\r\n\t\t// preset = {...presetId};\r\n\t\tif (presetId && title) {\r\n\t\t\tpreset.presetId = presetId;\r\n\t\t\tpreset.title = title;\r\n\r\n\t\t}\r\n\t\t// debugger;\r\n\t\tthis.setState(\r\n\t\t\t{\r\n\t\t\t\tpreset: preset,\r\n\t\t\t\tshowDelete: presetId ? true : false\r\n\t\t\t},\r\n\t\t\tthis.toggle\r\n\t\t);\r\n\t}\r\n\r\n\ttitleChanged(e) {\r\n\t\tconst newTitle = e.target.value;\r\n\t\tlet preset = { ...this.state.preset };\r\n\t\tpreset.title = newTitle;\r\n\t\tthis.setState({ preset });\r\n\t}\r\n\r\n\thandleDelete() {\r\n\t\tthis.props.onDeleteBtn(this.state.preset);\r\n\t\tthis.toggle();\r\n\t}\r\n\r\n\trenderDelete() {\r\n\t\tif (this.state.showDelete === true) {\r\n\t\t\treturn (\r\n\t\t\t\t<Button color=\"warning\" onClick={this.toggleNested}>{Tr(\"Delete\")}</Button>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tstyle={{ marginTop: '0.5em' }}\r\n\t\t\t\t\toutline\r\n\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\tonClick={this.props.onSaveBtn}\r\n\t\t\t\t>\r\n\t\t\t\t\t{Tr(\"Save current settings\")}\r\n\t\t\t\t</Button>\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tisOpen={this.state.modal}\r\n\t\t\t\t\ttoggle={this.toggle}\r\n\t\t\t\t\tclassName={this.props.className}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ModalHeader toggle={this.toggle}>{Tr(\"Save Preset\")}</ModalHeader>\r\n\t\t\t\t\t<ModalBody>\r\n\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\tonChange={e => this.titleChanged(e)}\r\n\t\t\t\t\t\t\tplaceholder={Tr(\"Title\")}\r\n\t\t\t\t\t\t\tdefaultValue={\r\n\t\t\t\t\t\t\t\t(this.state.preset &&\r\n\t\t\t\t\t\t\t\t\tthis.state.preset.title) ||\r\n\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<div className=\"code\">\r\n\t\t\t\t\t\t\t{JSON.stringify(this.state.preset)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Modal isOpen={this.state.nestedModal} toggle={this.toggleNested}>\r\n\t\t\t\t\t\t\t<ModalHeader toggle={this.toggleNested}>{Tr(\"Are you sure?\")}</ModalHeader>\r\n\t\t\t\t\t\t\t<ModalBody>{Tr(\"Are you sure to delete current preset?\")}</ModalBody>\r\n\t\t\t\t\t\t\t<ModalFooter>\r\n\t\t\t\t\t\t\t\t<Button color=\"warning\" onClick={() => this.handleDelete()}>{Tr(\"Delete\")}</Button>\r\n\t\t\t\t\t\t\t\t<Button onClick={this.toggleNested}>{Tr(\"Cancel\")}</Button>\r\n\t\t\t\t\t\t\t</ModalFooter>\r\n\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t</ModalBody>\r\n\t\t\t\t\t<ModalFooter>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\tonClick={() => this.handleSave()}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{Tr(\"Save\")}\r\n\t\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t\t<Button color=\"secondary\" onClick={this.toggle}>\r\n\t\t\t\t\t\t\t{Tr(\"Cancel\")}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t{this.renderDelete()}\r\n\t\t\t\t\t</ModalFooter>\r\n\t\t\t\t</Modal>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default EditPresetModal;\r\n\r\n\r\nEditPresetModal.defaultProps = {\r\n\tonDeleteBtn: function (preset) { },\r\n\tonSave: function (title, preset) { },\r\n\tonSaveBtn: function (e, idx) { }\r\n};","import React, { Component } from \"react\";\r\nimport { Button, Container, Row, Col } from \"reactstrap\";\r\nimport EditPresetModal from \"./EditPresetModal\"\r\nimport { PresetsLib, InitPreset } from './PresetsLib'\r\nimport Tr from './Locale'\r\nimport SimplePanel from \"./SimplePanel\";\r\nimport Utils from \"./Utils\"\r\n\r\nclass PresetsManager extends Component {\r\n\tstate = {\r\n\t\tshowDelete: [],\r\n\t\tshowEdit: [],\r\n\t\tuserPresets: []\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\t// const isStorageAvailable = Utils.storageAvailable('localStorage')\r\n\t\t// this.userPresets = '{}'\r\n\t\tconst storedPresets = localStorage.getItem('userPresets');\r\n\t\tthis.state.userPresets = storedPresets ? JSON.parse(storedPresets) : [];\r\n\r\n\t\tthis.state.showDelete = this.state.userPresets ? Array(this.state.userPresets.length).fill(false) : []\r\n\t\tthis.state.showEdit = this.state.userPresets ? Array(this.state.userPresets.length).fill(false) : []\r\n\t}\r\n\r\n\t// Old version of app didn't use certain properties.\r\n\t// If user did store some ancient presets in cookie this will make it work again\r\n\tvalidatePreset(preset) {\r\n\r\n\t\tpreset.byBarInterval = preset.byBarInterval || preset.interval || InitPreset.byBarInterval;\r\n\t\tpreset.byTimeInterval = preset.byTimeInterval || preset.interval || InitPreset.byTimeInterval;\r\n\t\tpreset.instrumentKey = preset.instrumentKey || preset.instrument.key;\r\n\r\n\t\tif (!preset.track) {\r\n\t\t\tlet track = [];\r\n\t\t\tpreset.accents.map(item => {\r\n\t\t\t\ttrack.push([item])\r\n\t\t\t\t// expected te return value in arrow function\r\n\t\t\t\treturn true;\r\n\t\t\t})\r\n\t\t\tpreset.track = track;\r\n\t\t}\r\n\t\treturn preset;\r\n\t}\r\n\r\n\tonPresetClick(preset) {\r\n\t\tthis.props.onSelect(this.validatePreset(preset));\r\n\t}\r\n\r\n\tonSavePreset(title, o) {\r\n\t\tconst preset = { title: title, ...o }\r\n\r\n\t\t// if it's got presetId then overwrite preset with such id\r\n\t\t// if no presetId then create it here\r\n\t\tif (preset.presetId === undefined) {\r\n\t\t\tlet presetId = 1;\r\n\t\t\tif (this.state.userPresets.length > 0) {\r\n\t\t\t\t// find max and add 1\r\n\t\t\t\tpresetId = Math.max.apply(Math, this.state.userPresets.map(function (p) { return p.presetId; }));\r\n\t\t\t\tpresetId++\r\n\t\t\t}\r\n\r\n\t\t\t// assign id\r\n\t\t\tpreset.presetId = presetId;\r\n\t\t}\r\n\r\n\r\n\t\t// update date\r\n\t\tpreset.savedDtm = new Date();\r\n\r\n\t\tlet userPresets = this.state.userPresets;\r\n\r\n\t\t// if (!userPresets) {\r\n\t\t// \tuserPresets = [];\r\n\t\t// }\r\n\r\n\t\t// overwrite by presetId\r\n\t\tlet idx = this.state.userPresets.findIndex(o => o.presetId === preset.presetId);\r\n\r\n\t\tif (idx < 0) {\r\n\t\t\tuserPresets.push(preset)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tuserPresets[idx] = preset;\r\n\t\t}\r\n\r\n\r\n\t\tthis.saveInLocalStorage(userPresets);\r\n\t\t// window.localStorage.setItem(preset.title, preset);\r\n\t}\r\n\r\n\tsaveInLocalStorage(presets) {\r\n\t\tlocalStorage.setItem('userPresets', JSON.stringify(presets))\r\n\t\tthis.setState({ userPresets: presets })\r\n\t}\r\n\r\n\tshowDeleteBtn(e, idx) {\r\n\t\tlet showDelete = { ...this.state };\r\n\t\tshowDelete[idx] = true;\r\n\t\tthis.setState({ showDelete });\r\n\t}\r\n\r\n\tshowEditBtn(e, idx, presetId) {\r\n\t\tlet showEdit = { ...this.state };\r\n\t\tshowEdit[idx] = true;\r\n\t\tthis.setState({ showEdit });\r\n\t}\r\n\thideEditBtn(e) {\r\n\t\tthis.setState({ showEdit: false })\r\n\t}\r\n\r\n\tonPresetDelete(preset) {\r\n\t\tlet idx = this.state.userPresets.findIndex(o => o.presetId === preset.presetId);\r\n\t\tlet newPresets = this.state.userPresets.slice();\r\n\r\n\t\t// let idx = this.state.userPresets.indexOf(preset)\r\n\t\tif (idx < 0) {\r\n\t\t\tthrow new Error(\"Selected preset \" + preset.title + \" has not been found in the store\")\r\n\t\t}\r\n\r\n\t\t// remove preset\r\n\t\tnewPresets.splice(idx, 1);\r\n\t\tthis.saveInLocalStorage(newPresets);\r\n\t}\r\n\r\n\tonPresetEdit(e, idx) {\r\n\t\tvar p = this.props.getPreset();\r\n\t\tif (idx !== undefined) {\r\n\r\n\t\t\tthis.refs.presetEditor.edit(p, this.state.userPresets[idx].presetId, this.state.userPresets[idx].title)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.refs.presetEditor.edit(p)\r\n\t\t}\r\n\t}\r\n\r\n\trenderUserPresets(userPresets) {\r\n\t\tif (userPresets.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t{Tr(\"User presets\")}:\r\n\t\t\t\t</Row>\r\n\t\t\t\t{userPresets.map((item, idx) => (\r\n\t\t\t\t\t<Row className=\"presetItem clickable\"\r\n\t\t\t\t\t\tonClick={() => this.onPresetClick(item)}\r\n\t\t\t\t\t\tkey={\"preset_\" + idx}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Col style={{textAlign: 'left'}} >\r\n\t\t\t\t\t\t\t{item.title}\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col xs=\"auto\" className=\"userPresetSavedDtm\">\r\n\t\t\t\t\t\t\t{Utils.toLocaleDateTime(item.savedDtm)}\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<Button  size=\"sm\" outline \r\n\t\t\t\t\t\t\t\tonClick={(e) => this.onPresetEdit(e, idx)}>\r\n\t\t\t\t\t\t\t\t{Tr(\"Edit\")}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t{/* // <div className='editBtn clickable' onClick={(e) =>}></div> */}\r\n\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t))}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst userPresetsJson = localStorage.getItem('userPresets');\r\n\t\tlet userPresets = userPresetsJson ? JSON.parse(userPresetsJson) : [];\r\n\r\n\t\t// let userPresets = [];\r\n\t\t// // console.log('<PresetsManager>userPresets', userPresets)\r\n\t\treturn (\r\n\t\t\t<SimplePanel className=\"PresetsManager\" title={Tr(\"Presets\")}>\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t{PresetsLib.map((item, idx) => (\r\n\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\tonClick={() => this.onPresetClick(item)}\r\n\t\t\t\t\t\t\tclassName={\"presetItem clickable\"}\r\n\t\t\t\t\t\t\tkey={\"preset_\" + idx}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{item.title}\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t))}\r\n\t\t\t\t\t{this.renderUserPresets(userPresets)}\r\n\t\t\t\t\t{/* center button */}\r\n\t\t\t\t\t<Row style={{ justifyContent: 'center' }}>\r\n\t\t\t\t\t\t<EditPresetModal ref='presetEditor' onDeleteBtn={(preset) => this.onPresetDelete(preset)} onSaveBtn={(e, idx) => this.onPresetEdit(e, idx)} onSave={(title, preset) => this.onSavePreset(title, preset)} />\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Container>\r\n\t\t\t</SimplePanel>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default PresetsManager;\r\n\r\nPresetsManager.defaultProps = {\r\n\tonSelect: function (preset) { }\r\n};\r\n","import React, { Component } from 'react';\r\nimport { accentColor } from './AccentTypes';\r\nimport { InitPreset } from './PresetsLib'\r\n\r\nclass SvgClock extends Component {\r\n    state = {\r\n        track: this.props.track\r\n    }\r\n    colorEmpty = \"#333\";\r\n    strokeColor = \"#444\";\r\n    strokeWidth=\"0.001em\"\r\n\r\n    setProgress(progress) {\r\n        this.line.style.transform = 'rotate(' + progress * 360 + 'deg)'\r\n    }\r\n\r\n    setAccents(track) {\r\n        this.setState({ track: track })\r\n        // this.drawSvg()\r\n    }\r\n\r\n    getCoordinatesForPercent(percent, r = 1) {\r\n        const x = r * Math.cos(2 * Math.PI * percent);\r\n        const y = r * Math.sin(2 * Math.PI * percent);\r\n        return [x, y];\r\n    }\r\n\r\n    drawSvg(radius, filter) {\r\n        // Drawing pie charts by David Gilbertson, taken from https://medium.com/hackernoon/a-simple-pie-chart-in-svg-dbdd653b6936\r\n        let pctStep = 1 / this.props.track.length;\r\n        let slices = [];\r\n        // let step = pctStep;\r\n        this.props.track.forEach(trackColumn => {\r\n            const idx = trackColumn.indexOf(filter);\r\n            slices.push({ percent: pctStep, color: idx >= 0 ? accentColor[filter] : this.colorEmpty });\r\n            // step += pctStep;\r\n        })\r\n        let cumulativePercent = 0;\r\n\r\n        let paths = [];\r\n        slices.forEach((slice, idx) => {\r\n            // destructuring assignment sets the two variables at once\r\n            const [startX, startY] = this.getCoordinatesForPercent(cumulativePercent, radius);\r\n\r\n            // each slice starts where the last slice ended, so keep a cumulative percent\r\n            cumulativePercent += slice.percent;\r\n\r\n            const [endX, endY] = this.getCoordinatesForPercent(cumulativePercent, radius);\r\n\r\n            // if the slice is more than 50%, take the large arc (the long way around)\r\n            const largeArcFlag = slice.percent > .5 ? 1 : 0;\r\n\r\n            // create an array and join it just for code readability\r\n            const pathData = [\r\n                `M ${startX} ${startY}`, // Move\r\n                `A ${radius} ${radius} 0 ${largeArcFlag} 1 ${endX} ${endY}`, // Arc\r\n                `L 0 0`, // Line\r\n            ].join(' ');\r\n\r\n            // create a <path> and append it to the <svg> element\r\n            paths.push(\r\n                <path key={\"pie_\" + idx} d={pathData} fill={slice.color} stroke={this.strokeColor} strokeWidth={this.strokeWidth}  />\r\n            )\r\n        });\r\n        return paths\r\n    }\r\n\r\n    drawText() {\r\n        let labels = [];\r\n        const pctStep = 1 / this.props.track.length;\r\n        let cumulativePercent = 0;\r\n\r\n        this.props.track.forEach((accent, idx) => {\r\n            let [x, y] = this.getCoordinatesForPercent(cumulativePercent, 0.9);\r\n            // tweak position of labels\r\n            x -= 0.06\r\n            labels.push(\r\n                <text x={x} y={y} key={\"label_\" + idx} textAnchor=\"middle\" transform={\"rotate(90, \" + x + \", \" + y + \")\"} className=\"svgText\">{idx + 1}</text>\r\n            )\r\n            cumulativePercent += pctStep\r\n        });\r\n\r\n        return <g>{labels}</g>;\r\n    }\r\n\r\n    render() {\r\n        if (!this.props.instrument) {\r\n            return <div>Instrument not loaded</div>\r\n        }\r\n\r\n        let radiusIncrement = 0.5 / this.props.instrument.samples.length;\r\n\r\n        let circles = [];\r\n        for (let i = 0; i < this.props.instrument.samples.length; i++) {\r\n            circles.push(this.drawSvg(0.8 -radiusIncrement * i, i));\r\n        }\r\n        circles.push( \r\n            <circle key=\"innerCircle\" cx=\"0\" cy=\"0\" r={0.8 - radiusIncrement * this.props.instrument.samples.length} fill={this.colorEmpty} stroke={this.strokeColor}  strokeWidth={this.strokeWidth}  />\r\n        )\r\n\r\n        return (\r\n            <div ref={el => (this.container = el)} className=\"visClockContainer\">\r\n                <svg viewBox=\"-1 -1 2 2\" ref={el => (this.svg = el)}>\r\n                    <g style={{ transform: 'rotate(-90deg)' }}>\r\n\r\n                        {\r\n                            circles\r\n                        }\r\n                        {this.drawText()}\r\n                        <line ref={el => (this.line = el)} strokeLinecap=\"round\" x1=\"0\" y1=\"0\" x2=\".7\" y2=\"0\" stroke=\"rgba(255,255,255,0.5)\" strokeWidth=\"0.1\" />\r\n                    </g>\r\n                </svg>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default SvgClock;\r\n\r\nSvgClock.defaultProps = {\r\n    track: InitPreset.track\r\n}","import React, { Component } from 'react';\r\nimport Slider from 'rc-slider'\r\nimport regression from 'regression';\r\nimport { Badge, Button } from 'reactstrap'\r\n\r\n\r\nclass GeometricSlider extends Component {\r\n    state = {\r\n        value: this.props.defaultValue,\r\n        regression: undefined\r\n    };\r\n\r\n    constructor(props) {\r\n        // TODO:  \r\n        // currently it works only for min=1 only\r\n        super(props);\r\n\r\n        const d = [[0, this.props.min], [100, this.props.max]];\r\n\r\n        this.state.regression = regression.exponential(d, { precision: 10 })\r\n\r\n        this.prepareMarks();\r\n\r\n        this.state.value = this.props.defaultValue;\r\n\r\n        this.state.btnStep = props.btnStep || 1;\r\n    }\r\n\r\n    onMinusClick = () => {\r\n        const newValue = this.state.value - this.state.btnStep;\r\n        this.setState({ value: newValue }, this.props.onChange(newValue))\r\n    }\r\n\r\n    onPlusClick = () => {\r\n        const newValue = this.state.value + this.state.btnStep;\r\n        this.setState({ value: newValue }, this.props.onChange(newValue))\r\n    }\r\n\r\n\r\n    prepareMarks() {\r\n        this.marks = {};\r\n\r\n        for (let i = 0; i < this.props.marksAt.length; i++) {\r\n            this.marks[this.findX(this.props.marksAt[i])] = this.props.marksAt[i];\r\n        }\r\n    }\r\n\r\n    onChange(v) {\r\n        const value = Math.floor(this.state.regression.predict(v)[1]);\r\n        this.setState({ value: value })\r\n        this.props.onChange(value)\r\n    }\r\n\r\n    findX(y) {\r\n        // y = e^bx ==> x = ln(y) / b\r\n        return Math.log(y) / this.state.regression.equation[1];\r\n    }\r\n\r\n    setValue(v) {\r\n        this.setState({ value: v })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <div>\r\n                    <Button size=\"sm\" outline className=\"inlineBtn\" onClick={this.onMinusClick}>-</Button>\r\n                    <Badge color=\"light\" onClick={this.onBadgeClick} className=\"d-i\">\r\n                        {this.props.badgeFormatter(this.state.value)}\r\n                    </Badge>\r\n                    <Button size=\"sm\" outline className=\"inlineBtn\" onClick={this.onPlusClick}>+</Button>\r\n                </div>\r\n                <Slider ref=\"slider\" included={false} value={this.findX(this.state.value)} style={{ height: '45px' }} onChange={(v) => this.onChange(v)} min={0} max={100} step={0.5} marks={this.marks} />\r\n            </>\r\n        )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default GeometricSlider;\r\n\r\nGeometricSlider.defaultProps = {\r\n    marksNum: 6,\r\n    marksStyle: {\r\n        color: '#ccc'\r\n    },\r\n    desc: '',\r\n    badgeFormatter: function (v) { return v; },\r\n    markFormatter: function (v) { return v; },\r\n    marksAt: []\r\n}","import React from \"react\";\r\nimport { Range } from \"rc-slider\";\r\nimport { Badge } from \"reactstrap\";\r\n\r\nclass AdvancedRange extends Range {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Badge\r\n\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\t// onClick={this.onBadgeClick}\r\n\t\t\t\t\t\tclassName=\"d-i\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{this.state.bounds[0]} - {this.state.bounds[1]}\r\n\t\t\t\t\t</Badge>\r\n\t\t\t\t</div>\r\n                <div style={{ height: \"30px\" }}>\r\n                {super.render()}\r\n                </div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default AdvancedRange;\r\n","import React from \"react\";\r\nimport Slider from \"rc-slider\";\r\nimport { Badge, Button } from \"reactstrap\";\r\n// import {Container, Row, Col} from 'reactstrap'\r\n\r\nclass AdvancedSlider extends Slider {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\r\n\t\tthis.state.btnStep = props.btnStep || 1;\r\n\t}\r\n\tonMinusClick = () => {\r\n\t\tconst newValue = this.state.value - this.state.btnStep;\r\n\t\tthis.setState({value: newValue}, this.props.onChange(newValue))\r\n\t}\r\n\r\n\tonPlusClick = () => {\r\n\t\tconst newValue = this.state.value + this.state.btnStep;\r\n\t\tthis.setState({value: newValue}, this.props.onChange(newValue))\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div className=\"advancedSlider\">\r\n\t\t\t\t\t<Button size=\"sm\" outline className=\"inlineBtn\" onClick={this.onMinusClick}>-</Button>\r\n\t\t\t\t\t<Badge\r\n\t\t\t\t\t\tcolor=\"light\"\r\n\t\t\t\t\t\tclassName=\"d-i\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{this.state.value}\r\n\t\t\t\t\t\t{/* {this.props.badgeFormatter(this.state.value)} */}\r\n\t\t\t\t\t</Badge>\r\n\t\t\t\t\t<Button size=\"sm\" outline className=\"inlineBtn\" onClick={this.onPlusClick}>+</Button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ height: \"30px\" }}>\r\n\t\t\t\t\t<div>{super.render()}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tonBadgeClick() {\r\n\t\t// TODO attach editorInPlace\r\n\t}\r\n}\r\n\r\nexport default AdvancedSlider;\r\n","import React, { Component } from \"react\";\r\nimport Slider from \"rc-slider\";\r\nimport { Badge } from \"reactstrap\";\r\n\r\nclass DiscreteSlider extends Component {\r\n\r\n    state = {\r\n        value: undefined,\r\n        innerValue: 0\r\n    }\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n        // helpful to display marks properly (need to be an object)\r\n        this.state.innerMarks = {};\r\n        Object.values(this.props.marks).map((el, idx)  => {\r\n            this.state.innerMarks[idx] = {label: el.label};\r\n            return true;\r\n        })\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        // TODO: apply this componentDidUpdate to remaining custom sliders\r\n        var value = this.props.value;\r\n        var theValue = value !== undefined ? value : prevState.value;\r\n        var innerValue = Object.keys(this.props.marks).indexOf(theValue+ '');\r\n        \r\n        if ( innerValue !== prevState.innerValue) {\r\n            this.setState({innerValue: innerValue, value: value});\r\n        }\r\n    }\r\n\r\n    onSliderChange(sliderValue) {\r\n        const value = Object.values(this.props.marks)[sliderValue].value;\r\n        this.setState({ innerValue: sliderValue, value: value })\r\n        this.props.onChange(value)\r\n    }\r\n\r\n    \r\n    render() {\r\n        return (\r\n            <>\r\n                <div>\r\n                    <Badge\r\n                        color=\"light\"\r\n                        className=\"d-i\"\r\n                    >\r\n                        {this.props.badgeFormatter(this.state.value)}\r\n                    </Badge>\r\n                </div>\r\n                {/* render it slightly narrower so we fit marks which usually falls outside the container */}\r\n                <div style={{ height: \"3.5em\", width: '95%', margin: 'auto', whiteSpace: 'nowrap' }}>\r\n                    <Slider ref=\"slider\"\r\n                        included={false}\r\n                        value={this.state.innerValue}\r\n                        style={{ height: '3.5em' }}\r\n                        onChange={(v) => this.onSliderChange(v)}\r\n                        min={0}\r\n                        max={Object.keys(this.props.marks).length - 1}\r\n                        step={1}\r\n                        marks={this.state.innerMarks} />\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default DiscreteSlider;\r\n\r\n\r\nDiscreteSlider.defaultProps = {\r\n    badgeFormatter: function (v) { return v; },\r\n    markFormatter: function (v) { return v; },\r\n    defaultValue: 0\r\n}","import React, { Component } from \"react\";\r\nimport SimplePanel from \"./SimplePanel\";\r\nimport {\r\n\tButtonGroup,\r\n\tButton,\r\n\tCollapse,\r\n\tButtonDropdown,\r\n\tDropdownToggle,\r\n\tDropdownItem,\r\n\tDropdownMenu\r\n} from \"reactstrap\";\r\nimport { PlayModes } from \"./PlayModes\";\r\nimport GeometricSlider from \"./Sliders/GeometricSlider\";\r\nimport AdvancedRange from \"./Sliders/AdvancedRange\"\r\nimport AdvancedSlider from \"./Sliders/AdvancedSlider\"\r\nimport DiscreteSlider from \"./Sliders/DiscreteSlider\"\r\nimport Utils from \"./Utils\";\r\nimport { InitPreset } from \"./PresetsLib\";\r\nimport Tr, { TrRange } from \"./Locale\"\r\nclass ModePanel extends Component {\r\n\tstate = {\r\n\t\tbpmStep: this.props.bpmStep,\r\n\t\tbpmRange: this.props.bpmRange,\r\n\t\tcurrentBpm: this.props.bpmRange[0],\r\n\t\tplaybackMode: this.props.playbackMode,\r\n\t\tplayMode: this.props.playMode,\r\n\t\tstepsNum: this.props.stepsNum,\r\n\t\texerciseTime: this.props.exerciseTime,\r\n\t\tbpmStepDropdownOpen: false,\r\n\t\tbyTimeInterval: this.props.byTimeInterval,\r\n\t\tbyBarInterval: this.props.byBarInterval,\r\n\t\tconstantBpmSlider: 300\r\n\t}\r\n\r\n\tonAfterChange(e) {\r\n\t\tthis.props.onChange()\r\n\t}\r\n\r\n\tonModeChange(newMode) {\r\n\t\tthis.setState({ playMode: newMode }, this.onAfterChange);\r\n\t}\r\n\r\n\r\n\r\n\tonBpmRangeChange(bpmRange) {\r\n\t\tthis.setState({ bpmRange: bpmRange }, this.onAfterChange);\r\n\t}\r\n\r\n\tonBpmSliderChange = (value) => {\r\n\t\tthis.setState({ constantBpmSlider: value }, this.onAfterChange);\r\n\t}\r\n\r\n\tonBpmStepChange() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tbpmStepDropdownOpen: !prevState.bpmStepDropdownOpen\r\n\t\t}));\r\n\t}\r\n\r\n\tonBpmStepSelect(value) {\r\n\t\tthis.setState({ bpmStep: value }, this.onAfterChange);\r\n\t}\r\n\r\n\tsetValue(o) {\r\n\t\tthis.refs.byBarSlider.setValue(o.byBarInterval || InitPreset.byBarInterval)\r\n\t\tthis.refs.byTimeSlider.setValue(o.byTimeInterval || InitPreset.byTimeInterval)\r\n\t\t// this.refs.exerciseTimeSlider.setValue(o.exerciseTime || InitPreset.exerciseTime);\r\n\r\n\t\tthis.refs.bpmRange.setState({ bounds: o.bpmRange })\r\n\t\tthis.setState(\r\n\t\t\t{\r\n\t\t\t\tplayMode: o.playMode,\r\n\t\t\t\tplaybackMode: o.playbackMode || this.state.playbackMode,\r\n\t\t\t\tbpmStep: o.bpmStep,\r\n\t\t\t\texerciseTime: o.exerciseTime || this.state.exerciseTime,\r\n\t\t\t\tstepsNum: o.stepsNum || this.state.stepsNum,\r\n\t\t\t\tbyBarInterval: o.byBarInterval,// || this.state.byBarInterval,\r\n\t\t\t\tbyTimeInterval: o.byTimeInterval, //|| this.state.byTimeInterval,\r\n\t\t\t\tbpmRange: o.bpmRange,\r\n\r\n\t\t\t\tconstantBpmSlider: o.constantBpmSlider || this.state.constantBpmSlider\r\n\r\n\t\t\t},\r\n\t\t\tthis.onAfterChange\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tonTimeIntervalChange(v) {\r\n\t\tthis.setState({ byTimeInterval: v, interval: v }, this.onAfterChange);\r\n\t}\r\n\r\n\tonBarIntervalChange(v) {\r\n\t\tthis.setState({ byBarInterval: v, interval: v }, this.onAfterChange);\r\n\t}\r\n\r\n\tbyBarFormatter(barsNum) {\r\n\t\treturn barsNum + \" \" + TrRange(barsNum, \"bars\");\r\n\t}\r\n\r\n\trenderIncreaseBpmDropdown() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<ButtonDropdown\r\n\t\t\t\t\tstyle={{ margin: \"0px 5px\" }}\r\n\t\t\t\t\tisOpen={this.state.bpmStepDropdownOpen}\r\n\t\t\t\t\ttoggle={() => this.onBpmStepChange()}\r\n\t\t\t\t>\r\n\t\t\t\t\t<DropdownToggle caret size=\"sm\" outline color=\"light\">\r\n\t\t\t\t\t\t{this.state.bpmStep}\r\n\t\t\t\t\t</DropdownToggle>\r\n\t\t\t\t\t<DropdownMenu>\r\n\t\t\t\t\t\t{[1,2,3,5,10,15,20,30,50,100].map(el => {\r\n\t\t\t\t\t\t\treturn <DropdownItem key={\"bpm_\"+el} onClick={() => {this.onBpmStepSelect(el)}}>{el}</DropdownItem>\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t</DropdownMenu>\r\n\t\t\t\t</ButtonDropdown>\r\n\t\t\t\tbpm\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tonStepsSliderChange(value) {\r\n\t\tthis.setState({ stepsNum: value }, this.onAfterChange);\r\n\t}\r\n\r\n\tonExerciseTimeSliderChange(value) {\r\n\t\tthis.setState({ exerciseTime: value }, this.onAfterChange);\r\n\t}\r\n\r\n\r\n\r\n\trenderTimeSlider() {\r\n\t\tconst marks = {}\r\n\t\tconst mArr = [300,600,900,1200,1800,3600,7200,10800]\r\n\t\t\r\n\t\tmArr.map(el => {\r\n\t\t\tmarks[el] = {value: el, label: Utils.formatTime(el)};\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\treturn (<div>\r\n\t\t\t{Tr(\"Exercise Time\")}\r\n\t\t\t<DiscreteSlider\r\n\t\t\t\tref=\"exerciseTimeSlider\"\r\n\t\t\t\tbadgeFormatter={Utils.formatTimeLong}\r\n\t\t\t\tmarkFormatter={Utils.formatTime}\r\n\t\t\t\tmarks={marks}\r\n\t\t\t\tvalue={this.state.exerciseTime}\r\n\t\t\t\tonChange={(value) => this.onExerciseTimeSliderChange(value)}\r\n\t\t\t/>\r\n\t\t\t\r\n\t\t</div>);\r\n\t}\r\n\r\n\trenderStepsSlider() {\r\n\t\treturn (<div>\r\n\t\t\t{Tr(\"Number of steps\")}\r\n\t\t\t<AdvancedSlider\r\n\t\t\t\tref=\"stepsSlider\"\r\n\t\t\t\tmin={2}\r\n\t\t\t\tincluded={false}\r\n\t\t\t\tmax={100}\r\n\t\t\t\tmarks={{ 1: '1', 5: '5', 10: '10', 15: '15', 20: '20', 30: '30', 40: '40', 50: '50', 60: '60', 70: '70', 80: '80', 90: '90', 100: '100' }}\r\n\t\t\t\tvalue={this.state.stepsNum}\r\n\t\t\t\tonChange={(value) => this.onStepsSliderChange(value)}\r\n\t\t\t/>\r\n\t\t</div>);\r\n\t}\r\n\trenderSpeedRange() {\r\n\t\treturn (<div>\r\n\t\t\t{Tr(\"BPM range\")}\r\n\t\t\t<AdvancedRange\r\n\t\t\t\tref=\"bpmRange\"\r\n\t\t\t\tmin={30}\r\n\t\t\t\tmax={1200}\r\n\t\t\t\tdefaultValue={[\r\n\t\t\t\t\tthis.state.bpmRange[0],\r\n\t\t\t\t\tthis.state.bpmRange[1]\r\n\t\t\t\t]}\r\n\t\t\t\tpushable={true}\r\n\t\t\t\tonAfterChange={(value) => this.onBpmRangeChange(value)}\r\n\t\t\t/>\r\n\t\t</div>);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SimplePanel className=\"ModePanel\" title=\"Mode\" width=\"300px\">\r\n\t\t\t\t<h6>{Tr('Increase speed')}</h6>\r\n\t\t\t\t<ButtonGroup size=\"sm\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\toutline\r\n\t\t\t\t\t\tonClick={() => this.onModeChange(PlayModes.SET_TIME)}\r\n\t\t\t\t\t\tactive={this.state.playMode === PlayModes.SET_TIME}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{Tr(\"Set time\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\toutline\r\n\t\t\t\t\t\tonClick={() => this.onModeChange(PlayModes.BY_BAR)}\r\n\t\t\t\t\t\tactive={this.state.playMode === PlayModes.BY_BAR}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{Tr(\"By bar\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\toutline\r\n\t\t\t\t\t\tonClick={() => this.onModeChange(PlayModes.BY_TIME)}\r\n\t\t\t\t\t\tactive={this.state.playMode === PlayModes.BY_TIME}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{Tr(\"By time\")}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\toutline\r\n\t\t\t\t\t\tonClick={() => this.onModeChange(PlayModes.CONSTANT)}\r\n\t\t\t\t\t\tactive={this.state.playMode === PlayModes.CONSTANT}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{Tr(\"Stable\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</ButtonGroup>\r\n\r\n\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode !== PlayModes.CONSTANT}>\r\n\t\t\t\t\t{this.renderSpeedRange()}\r\n\t\t\t\t</Collapse>\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode === PlayModes.SET_TIME}>\r\n\t\t\t\t\t{this.renderTimeSlider()}\r\n\t\t\t\t\t{this.renderStepsSlider()}\r\n\t\t\t\t</Collapse>\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode === PlayModes.BY_BAR}>\r\n\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{Tr(\"Increase speed every\")}\r\n\t\t\t\t\t\t<GeometricSlider\r\n\t\t\t\t\t\t\tref=\"byBarSlider\"\r\n\t\t\t\t\t\t\tdefaultValue={this.state.byBarInterval}\r\n\t\t\t\t\t\t\tbadgeFormatter={this.byBarFormatter}\r\n\t\t\t\t\t\t\tonChange={v => this.onBarIntervalChange(v)}\r\n\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\tmax={301}\r\n\t\t\t\t\t\t\tmarksAt={[1, 2, 5, 10, 20, 50, 100, 300]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Collapse>\r\n\t\t\t\t<Collapse isOpen={this.state.playMode === PlayModes.BY_TIME}>\r\n\t\t\t\t\t<div>\r\n\r\n\t\t\t\t\t\t{Tr(\"Increase speed every\")}\r\n\t\t\t\t\t\t<GeometricSlider\r\n\t\t\t\t\t\t\tref=\"byTimeSlider\"\r\n\t\t\t\t\t\t\tdefaultValue={this.state.byTimeInterval}\r\n\t\t\t\t\t\t\tbadgeFormatter={Utils.formatTimeLong}\r\n\t\t\t\t\t\t\tmarkFormatter={Utils.formatTime}\r\n\t\t\t\t\t\t\tonChange={v => this.onTimeIntervalChange(v)}\r\n\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\tmax={1200}\r\n\t\t\t\t\t\t\tmarksAt={[1, 2, 5, 10, 30, 60, 120, 240, 600, 1200]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Collapse>\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode !== PlayModes.CONSTANT && this.state.playMode !== PlayModes.SET_TIME}>\r\n\t\t\t\t\t{this.renderIncreaseBpmDropdown()}\r\n\t\t\t\t</Collapse>\r\n\r\n\t\t\t\t<Collapse isOpen={this.state.playMode === PlayModes.CONSTANT}>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\tChoose bpm\r\n\r\n\t\t\t\t\t\t<AdvancedSlider\r\n\t\t\t\t\t\t\tref=\"constantBpmSlider\"\r\n\t\t\t\t\t\t\tincluded={false}\r\n\t\t\t\t\t\t\tmin={10}\r\n\t\t\t\t\t\t\tbtnStep={10}\r\n\t\t\t\t\t\t\tmax={1200}\r\n\t\t\t\t\t\t\tmarks={{ 30: '30', 200: '200', 400: '400', 600: '600', 800: '800', 1000: '1000',  1200: '1200' }}\r\n\t\t\t\t\t\t\tvalue={this.state.constantBpmSlider}\r\n\t\t\t\t\t\t\tonChange={this.onBpmSliderChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Collapse>\r\n\r\n\t\t\t</SimplePanel>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default ModePanel;\r\n\r\nModePanel.defaultProps = {\r\n\tplayMode: InitPreset.playMode,\r\n\tplaybackMode: InitPreset.playbackMode,\r\n\tinterval: InitPreset.interval,\r\n\tbpmStep: InitPreset.bpmStep,\r\n\tbpmRange: InitPreset.bpmRange,\r\n\tbyTimeInterval: InitPreset.byTimeInterval,\r\n\tbyBarInterval: InitPreset.byBarInterval,\r\n\tstepsNum: InitPreset.stepsNum,\r\n\texerciseTime: InitPreset.exerciseTime,\r\n\tcurrentBpm: InitPreset.bpmRange[0],\r\n\tonAfterChange: null\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { accentColor } from \"../AccentTypes\";\r\n\r\n\r\nclass TrackRow extends Component {\r\n\r\n    state = {\r\n        activeIdx : null\r\n    }\r\n\r\n    activeColor = 'rgb(255, 121, 121)';\r\n\r\n    setActive(idx) {\r\n        this.setState({activeIdx: idx})\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"trackRow\">\r\n                <div className=\"label\">\r\n                    <span>{this.props.sample.label}</span>\r\n                </div>\r\n                {\r\n                    this.props.trackRow.map((el, idx) => {\r\n\r\n                        const style = {}\r\n                        if (this.props.trackRow[idx]) {\r\n                            style.backgroundColor = accentColor[this.props.sample.idx] \r\n                        }\r\n                        if (this.state.activeIdx === idx) {\r\n                            style.borderColor = this.activeColor;\r\n                        }\r\n                        return (\r\n                            <div\r\n                                key={\"cell_\" + idx}\r\n                                className=\"clickable cell\"\r\n                                style={style}\r\n                                onClick={() => this.props.onClick(this.props.sample.idx, idx)} />\r\n                        )\r\n                    })\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default TrackRow;\r\n\r\nTrackRow.defaultProps = {\r\n}\r\n\r\n","import React, { Component } from \"react\";\r\nimport TrackRow from './TrackRow'\r\nimport SimplePanel from \"../SimplePanel\";\r\nimport { Badge, Button, ButtonGroup } from 'reactstrap'\r\nimport { InitPreset } from \"../PresetsLib\";\r\nimport Tr from \"../Locale\"\r\n\r\nclass TrackView extends Component {\r\n    state = {\r\n        track: this.props.track\r\n    }\r\n\r\n    rowRefs = [];\r\n\r\n    handleColumnClick(sampleIdx, columnIdx) {\r\n        // copy array\r\n        let track = [...this.props.track];\r\n        let newColumn = [...this.props.track[columnIdx]];\r\n\r\n        const idx = this.props.track[columnIdx].indexOf(sampleIdx);\r\n        if (idx < 0) {\r\n            // add\r\n            newColumn.push(sampleIdx)\r\n        }\r\n        else {\r\n            // remove\r\n            newColumn.splice(idx, 1);\r\n        }\r\n        track[columnIdx] = newColumn\r\n        this.props.onChange(track)\r\n    }\r\n\r\n    setActiveColumn(idx) {\r\n        this.rowRefs.map((ref) => {\r\n            if (ref.current) {\r\n                ref.current.setActive(idx);\r\n            }\r\n            return true;\r\n        })\r\n    }\r\n\r\n    addBeat() {\r\n        if (this.props.track.length < 24) {\r\n            let track = [...this.props.track]\r\n            // add empty beat\r\n            track.push([]);\r\n            this.props.onChange(track, true)\r\n        }\r\n    }\r\n\r\n    removeBeat() {\r\n        if (this.props.track.length > 1) {\r\n            let track = [...this.props.track];\r\n            track.splice(track.length - 1, 1);\r\n            this.props.onChange(track, true)\r\n        }\r\n    }\r\n\r\n    filterTrack(sampleIdx) {\r\n        return this.props.track.map(item => {\r\n            return item.indexOf(sampleIdx) >= 0;\r\n        })\r\n    }\r\n\r\n    render() {\r\n        if (this.props.instrument === undefined) {\r\n            return <div>No instrument loaded</div>\r\n        }\r\n\r\n        this.props.instrument.samples.map(sample => {\r\n            this.rowRefs.push(React.createRef());\r\n            return true;\r\n        })\r\n\r\n        return (\r\n\r\n            <SimplePanel style={{ padding: '15px' }} title={Tr(\"Sequencer\")}>\r\n                <div className=\"trackview\">\r\n                    <div className=\"trackContainer\">\r\n                        {\r\n                            this.props.instrument.samples.map(sample => {\r\n                                return <TrackRow ref={this.rowRefs[sample.idx]} key={\"trackRow_\" + sample.idx} sample={sample} trackRow={this.filterTrack(sample.idx)} onClick={(sampleIdx, trackIdx) => this.handleColumnClick(sampleIdx, trackIdx)} />\r\n                            })\r\n                        }\r\n                    </div>\r\n                    <div className=\"btnContainer\">\r\n                        <ButtonGroup size=\"sm\" vertical>\r\n                            <Button onClick={() => this.addBeat()}>+</Button>\r\n                            <Button onClick={() => this.removeBeat()}>-</Button>\r\n                        </ButtonGroup>\r\n                        <div height=\"1em\">\r\n                        <Badge className=\"beatsCntBadge\" color=\"dark\">{this.props.track.length}</Badge>\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                </div>\r\n            </SimplePanel>\r\n        )\r\n    }\r\n}\r\n\r\nexport default TrackView;\r\n\r\nTrackView.defaultProps = {\r\n    track: InitPreset.track\r\n}\r\n\r\n","import React, { Component } from \"react\";\r\nimport Tone from \"tone\";\r\nimport { Badge, ButtonDropdown, DropdownToggle, DropdownMenu, DropdownItem, Container, Row, Col } from \"reactstrap\";\r\nimport SimplePanel from './SimplePanel'\r\nimport InstrumentLib from \"./InstrumentLib\";\r\nimport { InstrumentsArray } from \"./Instruments\"\r\nimport { Button } from 'reactstrap'\r\nimport { InitPreset } from './PresetsLib'\r\nimport Planner from './Planner'\r\nimport Tr from './Locale'\r\nimport PresetsManager from './PresetsManager'\r\nimport SvgClock from \"./SvgClock\";\r\nimport { AccentNotes } from './AccentTypes'\r\nimport ModePanel from './ModePanel'\r\nimport TrackView from './TrackView/TrackView'\r\nimport KeyboardEventHandler from 'react-keyboard-event-handler'\r\n\r\nclass SoundMachine extends Component {\r\n\r\n\tprogressFps = 30; // TODO: Set this according to device. higher values might cause slower devices to stutter\r\n\r\n\tinstrumentLib = new InstrumentLib({\r\n\t\tonInstrumentReady: (smi) => this.onInstrumentReady(smi)\r\n\t});\r\n\r\n\tstate = {\r\n\t\tinitialized: false,\r\n\t\tconfig: InitPreset,\r\n\t\ttrack: this.props.track\r\n\t};\r\n\r\n\ttransport = Tone.Transport;\r\n\ttone = Tone;\r\n\r\n\tonBufferError(e) {\r\n\t\tthrow new Error(e);\r\n\t}\r\n\r\n\tonInstrumentReady(smi) {\r\n\r\n\t\tthis.onInstrumentSelect(smi.key)\r\n\r\n\t\tif (this.state.initialized === false) {\r\n\t\t\tthis.setState({ initialized: true })\r\n\t\t\tthis.props.onReady();\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t// reload/debug bell\r\n\t\tvar synth = new Tone.Synth().toMaster();\r\n\t\tsynth.triggerAttackRelease(\"A2\");\r\n\r\n\t\tTone.Buffer.on(\"error\", this.onBufferError);\r\n\r\n\t\tTone.Transport.lookAhead = 10;\r\n\r\n\t\tthis.loop = new Tone.Part((time, note) => this.repeat(time, note), [])\r\n\t\tthis.loop.loop = true;\r\n\t\tthis.loop.start(0)\r\n\r\n\r\n\r\n\t\tconst config = this.getConfig();\r\n\r\n\t\tthis.setPlan(config);\r\n\r\n\t\tthis.initProgressUpdate();\r\n\t\tthis.documentTitle = document.title;\r\n\t}\r\n\r\n\tgetConfig() {\r\n\t\treturn { ...this.refs.modePanel.state, ...{ track: this.state.track }, ...{ instrumentKey: this.state.instrument ? this.state.instrument.key : InitPreset.instrumentKey } };\r\n\t}\r\n\r\n\r\n\tinitProgressUpdate() {\r\n\t\tsetInterval(() => this.onProgress(), 1000 / this.progressFps)\r\n\t}\r\n\r\n\tsetPlan(config) {\r\n\t\t// cancel all events\r\n\t\tthis.transport.cancel();\r\n\t\tthis.transport.position = 0;\r\n\t\t// debugger\r\n\t\tthis.setTrack(config.track.slice());\t// TODO: Unsure why we need to pass copy\r\n\t\tthis.refs.planner.setPlan(config);\r\n\r\n\t}\r\n\r\n\tsetTrack(track, force = false) {\r\n\t\t// debugger\r\n\t\tif ((force === false && this.state.track === track)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.setTimeSignature(track.length);\r\n\r\n\t\t// map track encoded as digits into notes\r\n\t\tlet pattern = track.map((item) => {\r\n\t\t\tlet o;\r\n\r\n\t\t\tif (!Array.isArray(item)) {\r\n\t\t\t\tthrow new Error(\"Invalid track item\");\r\n\t\t\t}\r\n\r\n\t\t\to = item.map((subItem) => {\r\n\t\t\t\treturn [AccentNotes[subItem]]\r\n\t\t\t});\r\n\r\n\t\t\treturn o;\r\n\t\t})\r\n\r\n\t\tthis.loop.removeAll();\r\n\r\n\t\t// add new notes if requires\r\n\t\tif (pattern.length > this.loop.length) {\r\n\t\t\tfor (let i = this.loop.length; i < pattern.length; i++) {\r\n\t\t\t\t// console.log('adding beat at', \"0:\" + i, pattern[i])\r\n\t\t\t\tthis.loop.add(\"0:\" + i, pattern[i]);\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\telse if (pattern.length < this.loop.length) {\r\n\t\t\tconst cnt = this.loop.length - pattern.length\r\n\t\t\t// console.log('elements to delete', cnt)\r\n\r\n\t\t\tfor (let i = 0; i < cnt; i++) {\r\n\t\t\t\tlet idx = pattern.length + i;\r\n\t\t\t\t// console.log('removing', idx)\r\n\t\t\t\tthis.loop.remove(\"0:\" + idx)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.loop.loopEnd = '1m'\r\n\t\tthis.loop.start(0);\r\n\r\n\t\tthis.setState({ track: track })\r\n\r\n\t}\r\n\r\n\tonProgress() {\r\n\t\tif (this.transport.state === 'stopped') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.refs.debug) {\r\n\t\t\tthis.refs.debug.innerHTML = this.transport.seconds.toFixed(1)\r\n\t\t}\r\n\r\n\t\tif (this.refs.planner) { this.refs.planner.updateProgress() }\r\n\r\n\r\n\t\tif (this.refs.svgClock) { this.refs.svgClock.setProgress(this.loop.progress) }\r\n\t}\r\n\r\n\trepeat = (time, notes) => {\r\n\t\t// make sound\r\n\t\tfor (let i = 0; i < notes.length; i++) {\r\n\t\t\tthis.state.instrument.triggerAttack(notes[i], time);\r\n\t\t}\r\n\t\t// display current beat on TrackView\r\n\t\tthis.refs.trackView.setActiveColumn(Math.floor(this.loop.progress * this.transport.timeSignature));\r\n\t}\r\n\r\n\tcalcTimeForBpm(seconds, bpm) {\r\n\t\treturn Tone.Time(seconds * bpm / this.baseBpm);\r\n\t}\r\n\r\n\tgetCurrentInstrumentLabel() {\r\n\t\treturn this.instrumentLib.getInstrument().label;\r\n\t}\r\n\r\n\tsetTimeSignature(timeSignature) {\r\n\t\tif (timeSignature !== this.transport.timeSignature) {\r\n\t\t\tthis.transport.timeSignature = timeSignature;\r\n\t\t}\r\n\t}\r\n\r\n\tsetBpm = bpm => {\r\n\r\n\t\tif (isNaN(bpm) || bpm <= 0 || bpm > 1200) {\r\n\t\t\tthrow new Error(\"Invalid BPM value: \" + bpm)\r\n\t\t}\r\n\r\n\t\tif (bpm !== this.transport.bpm.value) {\r\n\t\t\tTone.Transport.bpm.value = bpm;\r\n\t\t\tthis.setState({ bpm: bpm })\r\n\t\t\tdocument.title = bpm.toFixed(0) + ' | ' + this.documentTitle\r\n\t\t}\r\n\t};\r\n\r\n\ttoggle() {\r\n\t\tTone.Transport.state === 'started' ? this.stop() : this.start();\r\n\t};\r\n\r\n\tonPlanStep(bpm) {\r\n\t\tthis.setBpm(bpm);\r\n\t}\r\n\r\n\tonControlChange() {\r\n\t\tconst v = this.getConfig();\r\n\t\tthis.setPlan(v);\r\n\t}\r\n\r\n\tonInstrumentChange() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tinstrumentDropdownOpen: !prevState.instrumentDropdownOpen\r\n\t\t}));\r\n\t}\r\n\r\n\tonInstrumentSelect(instrumentKey) {\r\n\t\tlet mustRecreate = false;\r\n\t\tif (this.instrumentLib.hasInstrument(instrumentKey)) {\r\n\t\t\t// instrument is already in library so use  it\r\n\t\t\tconst samplesUsedCnt = this.state.instrument ? this.state.instrument.samples.length : 0;\r\n\t\t\tconst instrument = this.instrumentLib.getInstrument(instrumentKey);\r\n\r\n\t\t\tlet newTrack = [];\r\n\t\t\t// Update track as new instrument might have less samples than previous\r\n\t\t\tif (samplesUsedCnt > instrument.samples.length) {\r\n\r\n\r\n\t\t\t\tthis.state.track.forEach(element => {\r\n\t\t\t\t\tlet col = []\r\n\t\t\t\t\telement.forEach((subEl, idx) => {\r\n\t\t\t\t\t\tif (subEl < instrument.samples.length) {\r\n\t\t\t\t\t\t\tcol.push(subEl)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnewTrack.push(col)\r\n\t\t\t\t});\r\n\t\t\t\tmustRecreate = true;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnewTrack = this.state.track\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tinstrument: instrument,\r\n\t\t\t\tinstrumentDropdownLabel: instrument.label\r\n\t\t\t}, mustRecreate ? () => this.setTrack(newTrack) : null);\r\n\t\t\t// }, () => this.setTrack(newTrack));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.instrumentLib.loadInstrument(instrumentKey)\r\n\t\t}\r\n\t}\r\n\r\n\tonPresetSelect(preset) {\r\n\t\tthis.setState({ track: preset.track }, function () {\r\n\t\t\tthis.refs.modePanel.setValue(preset)\r\n\r\n\t\t\tthis.onInstrumentSelect(preset.instrumentKey);\r\n\r\n\t\t});\r\n\t}\r\n\r\n\trenderInstrumentsDropDown() {\r\n\t\treturn (<ButtonDropdown\r\n\t\t\tisOpen={this.state.instrumentDropdownOpen}\r\n\t\t\ttoggle={() => this.onInstrumentChange()}\r\n\t\t>\r\n\t\t\t<DropdownToggle\r\n\t\t\t\tcaret\r\n\t\t\t\tsize=\"sm\"\r\n\t\t\t\toutline\r\n\t\t\t\tcolor=\"light\"\r\n\t\t\t>\r\n\t\t\t\t{this.state.instrumentDropdownLabel}\r\n\t\t\t</DropdownToggle>\r\n\t\t\t<DropdownMenu>\r\n\t\t\t\t{InstrumentsArray.map((item) =>\r\n\t\t\t\t\t<DropdownItem key={item.key} onClick={() => this.onInstrumentSelect(item.key)}>\r\n\t\t\t\t\t\t{item.label}\r\n\t\t\t\t\t</DropdownItem>\r\n\t\t\t\t)}\r\n\t\t\t</DropdownMenu>\r\n\t\t</ButtonDropdown>);\r\n\r\n\t}\r\n\r\n\tonTrackChange(newTrack, isLengthChanged = false) {\r\n\t\tif (this.state.track.length !== newTrack.length) {\r\n\t\t\t// length changed so after setting track, recreate Plan\r\n\t\t\tconst config = this.getConfig();\r\n\t\t\tconfig.track = newTrack\r\n\t\t\tthis.setPlan(config);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.setTrack(newTrack)\r\n\t\t}\r\n\r\n\t}\r\n\r\n\thandleKey(key, e) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 's':\r\n\t\t\t\tthis.toggle();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'esc':\r\n\t\t\t\tthis.stop();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'left':\r\n\t\t\t\tthis.refs.planner.stepBackward()\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'right':\r\n\t\t\t\tthis.refs.planner.stepForward()\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'up':\r\n\t\t\t\tif (this.state.bpm < 600) {\r\n\t\t\t\t\tthis.setBpm(this.state.bpm + 10);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'down':\r\n\t\t\t\tif (this.state.bpm > 10) {\r\n\t\t\t\t\tthis.setBpm(this.state.bpm - 10);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\r\n\t\t\t<>\r\n\t\t\t\t<KeyboardEventHandler handleKeys={['s', 'esc', 'left', 'right', 'up', 'down']} onKeyEvent={(key, e) => this.handleKey(key, e)} />\r\n\t\t\t\t<Container>\r\n\r\n\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<SimplePanel title={Tr('Control')}>\r\n\t\t\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t// color=\"primary\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.toggle()}\r\n\t\t\t\t\t\t\t\t\t\t\tcolor={this.state.isPlaying ? 'secondary' : 'light'}\r\n\t\t\t\t\t\t\t\t\t\t\t// outline\r\n\t\t\t\t\t\t\t\t\t\t\tblock\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{Tr(\"Start / Stop\")}\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t\t\t<Container>\r\n\t\t\t\t\t\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs=\"3\">{Tr(\"Instrument\")}</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{this.renderInstrumentsDropDown()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t</Container>\r\n\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t\t\t\t<Row><Col><h2><Badge color=\"dark\">BPM: {Tone.Transport.bpm.value.toFixed(0)}</Badge></h2></Col>\r\n\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t<Row>\r\n\r\n\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t</SimplePanel>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<ModePanel\r\n\t\t\t\t\t\t\t\tref=\"modePanel\"\r\n\t\t\t\t\t\t\t\tonChange={() => this.onControlChange()}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col style={{margin: 'auto'}}>\r\n\t\t\t\t\t\t\t<SvgClock ref=\"svgClock\" instrument={this.state.instrument} track={this.state.track} />\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<TrackView\r\n\t\t\t\t\t\t\t\tref='trackView'\r\n\t\t\t\t\t\t\t\ttrack={this.state.track}\r\n\t\t\t\t\t\t\t\tinstrument={this.state.instrument}\r\n\t\t\t\t\t\t\t\tonChange={(track, isLengthChanged) => this.onTrackChange(track, isLengthChanged)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<Planner\r\n\t\t\t\t\t\t\t\ttransport={this.transport}\r\n\t\t\t\t\t\t\t\tprogress={this.state.progress}\r\n\t\t\t\t\t\t\t\tonChange={() => this.onControlChange()}\r\n\t\t\t\t\t\t\t\tonPlanStep={(bpm) => this.onPlanStep(bpm)}\r\n\t\t\t\t\t\t\t\tonPlanEnd={() => this.stop()}\r\n\t\t\t\t\t\t\t\tref=\"planner\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<PresetsManager\r\n\t\t\t\t\t\t\t\tref=\"presetsManager\"\r\n\t\t\t\t\t\t\t\tgetPreset={() => this.getConfig()}\r\n\t\t\t\t\t\t\t\tonSelect={preset => this.onPresetSelect(preset)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t<Row>\r\n\t\t\t\t\t\r\n\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t</Container >\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tstop() {\r\n\r\n\t\tthis.transport.stop();\r\n\t\tthis.transport.position = 0;\r\n\t\tthis.setState({ isPlaying: false });\r\n\t}\r\n\r\n\tstart() {\r\n\t\tthis.transport.start(\"+.1\");\r\n\t\tthis.loop.start();\r\n\t\tthis.setState({ isPlaying: true });\r\n\t}\r\n}\r\n\r\nexport default SoundMachine;\r\n\r\n\r\nSoundMachine.defaultProps = {\r\n\tinstrument: InitPreset.instrument,\r\n\ttrack: InitPreset.track,\r\n\tonReady: function () { }\r\n};","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport \"./components/SoundMachine\";\r\nimport SoundMachine from \"./components/SoundMachine\";\r\nimport \"rc-slider/assets/index.css\";\r\nimport \"bootstrap/dist/css/bootstrap.css\";\r\nimport { Badge, Container, Row, Col } from \"reactstrap\";\r\nimport SimplePanel from \"./components/SimplePanel\";\r\nimport ReactGA from 'react-ga';\r\nimport Tr from './components/Locale'\r\n\r\nclass App extends Component {\r\n\r\n\tstate = {\r\n\t\tshowMask: true\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t// google analytics\r\n\t\tReactGA.initialize({\r\n\t\t\ttrackingId: 'UA-151010848-1',\r\n\t\t\tdebug: true,\r\n\t\t\tgaOptions: {\r\n\t\t\t\tcookieDomain: 'none'\r\n\t\t\t}\r\n\t\t});\r\n\t\tReactGA.pageview(window.location.pathname + window.location.search);\r\n\t}\r\n\r\n\tremoveLoadMask() {\r\n\t\tthis.setState({ showMask: false })\r\n\t}\r\n\r\n\trender() {\r\n\r\n\r\n\t\treturn (\r\n\r\n\t\t\t<div className=\"App\">\r\n\r\n\t\t\t\t<Container className=\"app-container \">\r\n\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<SoundMachine ref=\"sm\" onReady={() => this.removeLoadMask()} />\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<SimplePanel title={Tr(\"Keyboard controls\")} className=\"about\">\r\n\t\t\t\t\t\t\t\t<div><code>{Tr(\"arrow up/down\")}</code> - {Tr(\"higher/lower BPM\")}</div>\r\n\t\t\t\t\t\t\t\t<div><code>{Tr(\"arrow left/right\")}</code> - {Tr(\"previous/next step according to plan\")}</div>\r\n\t\t\t\t\t\t\t\t<div><code>s</code> - {Tr(\"start/stop\")}</div>\r\n\t\t\t\t\t\t\t\t<div><code>esc</code> - {Tr(\"stop\")}</div>\r\n\t\t\t\t\t\t\t</SimplePanel>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<div className=\"footer\">\r\n\t\t\t\t\t\t\t\t<div>Join discord using <Badge href=\"https://discord.gg/fAwnmVh\" target=\"blank\">this link</Badge> for feedback and improvement suggestions.</div>\r\n\t\t\t\t\t\t\t\t<div>By using this site you agree to the use of cookies to store user defined presets and analytics.</div>\r\n\t\t\t\t\t\t\t\t<div>Created using <Badge href=\"https://reactjs.org/\" target=\"blank\" >React</Badge> and <Badge href=\"https://tonejs.github.io/\" target=\"blank\">Tone.js</Badge>. Source code available <Badge href=\"https://github.com/indiebubbler/metro\">here</Badge>.</div>\r\n\t\t\t\t\t\t\t\t<div>Supported languages are english and polish. If you want to help translating this page into your language please contact me:<Badge href=\"mailto:indiebubbler@gmail.com?subject=Feedback\">indiebubbler@gmail.com</Badge>.</div>\r\n\t\t\t\t\t\t\t\t<div>&#169; IndieBubbler 2019-2020. Version 2.0 beta</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Container>\r\n\t\t\t\t<div ref=\"loadMask\" className={this.state.showMask === true ? 'loadmask ' : 'loadmask fadeOut'} />\r\n\t\t\t</div>\r\n\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default App;","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read http://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(   <App  />  , document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.register();"],"sourceRoot":""}